import{d as ht,p as Ae,o as je,c as Ue,j as M,Y as Ne,ae as be,F as mt,_ as dt,a as ft,G as It}from"./chunks/framework.Cs8hIhTA.js";import{U as vt}from"./chunks/Utils.-nxGnYAP.js";function G(r){const e=r||"";return function(){throw new Error("this method "+e+" is abstract! (it has no implementation in class "+this.constructor.name+")")}}function U(r,e){if(!r)throw new Error(e||"Assertion failed")}function pe(r,e,t){let s;Object.defineProperty(r,e,{get(){return s||(s=t.call(this)),s}})}function gt(r){return r&&Object.assign({},r)}function We(r,e){const t=[];for(;e-- >0;)t.push(r());return t}function He(r,e){return new Array(e+1).join(r)}function ee(r,e){return We(()=>r,e)}function he(r){const e=[];for(let t=0;t<r.length;t++){const s=r[t];r.lastIndexOf(s)!==t&&e.indexOf(s)<0&&e.push(s)}return e}function Xe(r){const e=[];return r.forEach(t=>{e.indexOf(t)<0&&e.push(t)}),e}function H(r){const e=r[0];return e===e.toUpperCase()}function Ze(r){return!H(r)}function Ke(r,e,t){const s=t||" ";return r.length<e?He(s,e-r.length)+r:r}function X(){this.strings=[]}X.prototype.append=function(r){this.strings.push(r)};X.prototype.contents=function(){return this.strings.join("")};const ie=r=>String.fromCodePoint(parseInt(r,16));function Ve(r){if(r.charAt(0)==="\\")switch(r.charAt(1)){case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";case"v":return"\v";case"x":return ie(r.slice(2,4));case"u":return r.charAt(2)==="{"?ie(r.slice(3,-1)):ie(r.slice(2,6));default:return r.charAt(1)}else return r}function $e(r){if(r==null)return String(r);const e=Object.prototype.toString.call(r);try{let t;return r.constructor&&r.constructor.name?t=r.constructor.name:e.indexOf("[object ")===0?t=e.slice(8,-1):t=typeof r,t+": "+JSON.stringify(String(r))}catch{return e}}const yt=Object.freeze(Object.defineProperty({__proto__:null,StringBuffer:X,abstract:G,assert:U,clone:gt,copyWithoutDuplicates:Xe,defineLazyProperty:pe,getDuplicates:he,isLexical:Ze,isSyntactic:H,padLeft:Ke,repeat:ee,repeatFn:We,repeatStr:He,unescapeCodePoint:Ve,unexpectedObjToString:$e},Symbol.toStringTag,{value:"Module"})),xt={Lu:new RegExp("\\p{Lu}","u"),Ll:new RegExp("\\p{Ll}","u"),Lt:new RegExp("\\p{Lt}","u"),Lm:new RegExp("\\p{Lm}","u"),Lo:new RegExp("\\p{Lo}","u"),Nl:new RegExp("\\p{Nl}","u"),Nd:new RegExp("\\p{Nd}","u"),Mn:new RegExp("\\p{Mn}","u"),Mc:new RegExp("\\p{Mc}","u"),Pc:new RegExp("\\p{Pc}","u"),Zs:new RegExp("\\p{Zs}","u"),L:new RegExp("\\p{Letter}","u"),Ltmo:new RegExp("\\p{Lt}|\\p{Lm}|\\p{Lo}","u")};class d{constructor(){if(this.constructor===d)throw new Error("PExpr cannot be instantiated -- it's abstract")}withSource(e){return e&&(this.source=e.trimmed()),this}}const b=Object.create(d.prototype),E=Object.create(d.prototype);class A extends d{constructor(e){super(),this.obj=e}}class O extends d{constructor(e,t){super(),this.from=e,this.to=t,this.matchCodePoint=e.length>1||t.length>1}}class w extends d{constructor(e){super(),this.index=e}}class x extends d{constructor(e){super(),this.terms=e}}class te extends x{constructor(e,t,s){const n=e.rules[t].body;super([s,n]),this.superGrammar=e,this.name=t,this.body=s}}class re extends x{constructor(e,t,s,n){const i=e.rules[t].body;super([...s,i,...n]),this.superGrammar=e,this.ruleName=t,this.expansionPos=s.length}}class S extends d{constructor(e){super(),this.factors=e}}class T extends d{constructor(e){super(),this.expr=e}}class Z extends T{}class V extends T{}class B extends T{}Z.prototype.operator="*";V.prototype.operator="+";B.prototype.operator="?";Z.prototype.minNumMatches=0;V.prototype.minNumMatches=1;B.prototype.minNumMatches=0;Z.prototype.maxNumMatches=Number.POSITIVE_INFINITY;V.prototype.maxNumMatches=Number.POSITIVE_INFINITY;B.prototype.maxNumMatches=1;class R extends d{constructor(e){super(),this.expr=e}}class L extends d{constructor(e){super(),this.expr=e}}class C extends d{constructor(e){super(),this.expr=e}}class I extends d{constructor(e,t=[]){super(),this.ruleName=e,this.args=t}isSyntactic(){return H(this.ruleName)}toMemoKey(){return this._memoKey||Object.defineProperty(this,"_memoKey",{value:this.toString()}),this._memoKey}}class _ extends d{constructor(e){super(),this.category=e,this.pattern=xt[e]}}function v(r,e){let t;return e?(t=new Error(e.getLineAndColumnMessage()+r),t.shortMessage=r,t.interval=e):t=new Error(r),t}function me(){return v("Interval sources don't match")}function St(r,e,t){const s=e?`Grammar ${r} is not declared in namespace '${e}'`:"Undeclared grammar "+r;return v(s,t)}function _t(r,e){return v("Grammar "+r.name+" is already declared in this namespace")}function At(r){return v(`Grammar '${r.name}' does not support incremental parsing`)}function Qe(r,e,t){return v("Rule "+r+" is not declared in grammar "+e,t)}function Nt(r,e,t){return v("Cannot override rule "+r+" because it is not declared in "+e,t)}function bt(r,e,t){return v("Cannot extend rule "+r+" because it is not declared in "+e,t)}function Ee(r,e,t,s){let n="Duplicate declaration for rule '"+r+"' in grammar '"+e+"'";return e!==t&&(n+=" (originally declared in '"+t+"')"),v(n,s)}function ze(r,e,t,s){return v("Wrong number of parameters for rule "+r+" (expected "+e+", got "+t+")",s)}function Et(r,e,t,s){return v("Wrong number of arguments for rule "+r+" (expected "+e+", got "+t+")",s)}function Oe(r,e,t){return v("Duplicate parameter names in rule "+r+": "+e.join(", "),t)}function Ot(r,e){return v("Invalid parameter to rule "+r+": "+e+" has arity "+e.getArity()+", but parameter expressions must have arity 1",e.source)}const wt="NOTE: A _syntactic rule_ is a rule whose name begins with a capital letter. See https://ohmjs.org/d/svl for more details.";function Ft(r,e){return v("Cannot apply syntactic rule "+r+" from here (inside a lexical context)",e.source)}function Gt(r){const{ruleName:e}=r;return v(`applySyntactic is for syntactic rules, but '${e}' is a lexical rule. `+wt,r.source)}function Tt(r){return v("applySyntactic is not required here (in a syntactic context)",r.source)}function we(r,e){return v("Incorrect argument type: expected "+r,e.source)}function Rt(r){return v("'...' can appear at most once in a rule body",r.source)}function Lt(r){const e=r._node;U(e&&e.isNonterminal()&&e.ctorName==="escapeChar_unicodeCodePoint");const t=r.children.slice(1,-1).map(n=>n.source),s=t[0].coverageWith(...t.slice(1));return v(`U+${s.contents} is not a valid Unicode code point`,s)}function Je(r,e){const t=e.length>0?e[e.length-1].args:[];let n="Nullable expression "+r.expr.substituteParams(t)+" is not allowed inside '"+r.operator+"' (possible infinite loop)";if(e.length>0){const i=e.map(a=>new I(a.ruleName,a.args)).join(`
`);n+=`
Application stack (most recent application last):
`+i}return v(n,r.expr.source)}function Ye(r,e,t,s){return v("Rule "+r+" involves an alternation which has inconsistent arity (expected "+e+", got "+t+")",s.source)}function Pt(r){const e=r.map(t=>t.message);return v(["Errors:"].concat(e).join(`
- `),r[0].interval)}function Ct(r,e,t,s){let n=s.slice(0,-1).map(l=>{const p="  "+l[0].name+" > "+l[1];return l.length===3?p+" for '"+l[2]+"'":p}).join(`
`);n+=`
  `+e+" > "+r;let i="";r==="_iter"&&(i=[`
NOTE: as of Ohm v16, there is no default action for iteration nodes — see `,"  https://ohmjs.org/d/dsa for details."].join(`
`));const a=[`Missing semantic action for '${r}' in ${t} '${e}'.${i}`,"Action stack (most recent call last):",n].join(`
`),o=v(a);return o.name="missingSemanticAction",o}function Dt(r){if(r.length===1)throw r[0];if(r.length>1)throw Pt(r)}function Mt(r){let e=0;return r.map(s=>{const n=s.toString();return e=Math.max(e,n.length),n}).map(s=>Ke(s,e))}function Fe(r,e,t){const s=r.length,n=r.slice(0,t),i=r.slice(t+e.length);return(n+e+i).substr(0,s)}function kt(...r){const e=this,{offset:t}=e,{repeatStr:s}=yt,n=new X;n.append("Line "+e.lineNum+", col "+e.colNum+`:
`);const i=Mt([e.prevLine==null?0:e.lineNum-1,e.lineNum,e.nextLine==null?0:e.lineNum+1]),a=(u,c,h)=>{n.append(h+i[u]+" | "+c+`
`)};e.prevLine!=null&&a(0,e.prevLine,"  "),a(1,e.line,"> ");const o=e.line.length;let l=s(" ",o+1);for(let u=0;u<r.length;++u){let c=r[u][0],h=r[u][1];U(c>=0&&c<=h,"range start must be >= 0 and <= end");const m=t-e.colNum+1;c=Math.max(0,c-m),h=Math.min(h-m,o),l=Fe(l,s("~",h-c),c)}const p=2+i[1].length+3;return n.append(s(" ",p)),l=Fe(l,"^",e.colNum-1),n.append(l.replace(/ +$/,"")+`
`),e.nextLine!=null&&a(2,e.nextLine,"  "),n.contents()}let de=[];function et(r){de.push(r)}function qt(r){de.forEach(e=>{e(r)}),de=null}function ge(r,e){let t=1,s=1,n=0,i=0,a=null,o=null,l=-1;for(;n<e;){const c=r.charAt(n++);c===`
`?(t++,s=1,l=i,i=n):c!=="\r"&&s++}let p=r.indexOf(`
`,i);if(p===-1)p=r.length;else{const c=r.indexOf(`
`,p+1);a=c===-1?r.slice(p):r.slice(p,c),a=a.replace(/^\r?\n/,"").replace(/\r$/,"")}l>=0&&(o=r.slice(l,i).replace(/\r?\n$/,""));const u=r.slice(i,p).replace(/\r$/,"");return{offset:e,lineNum:t,colNum:s,line:u,prevLine:o,nextLine:a,toString:kt}}function tt(r,e,...t){return ge(r,e).toString(...t)}const Ge=(()=>{let r=0;return e=>""+e+r++})();class N{constructor(e,t,s){this.sourceString=e,this.startIdx=t,this.endIdx=s}get contents(){return this._contents===void 0&&(this._contents=this.sourceString.slice(this.startIdx,this.endIdx)),this._contents}get length(){return this.endIdx-this.startIdx}coverageWith(...e){return N.coverage(...e,this)}collapsedLeft(){return new N(this.sourceString,this.startIdx,this.startIdx)}collapsedRight(){return new N(this.sourceString,this.endIdx,this.endIdx)}getLineAndColumn(){return ge(this.sourceString,this.startIdx)}getLineAndColumnMessage(){const e=[this.startIdx,this.endIdx];return tt(this.sourceString,this.startIdx,e)}minus(e){if(this.sourceString!==e.sourceString)throw me();return this.startIdx===e.startIdx&&this.endIdx===e.endIdx?[]:this.startIdx<e.startIdx&&e.endIdx<this.endIdx?[new N(this.sourceString,this.startIdx,e.startIdx),new N(this.sourceString,e.endIdx,this.endIdx)]:this.startIdx<e.endIdx&&e.endIdx<this.endIdx?[new N(this.sourceString,e.endIdx,this.endIdx)]:this.startIdx<e.startIdx&&e.startIdx<this.endIdx?[new N(this.sourceString,this.startIdx,e.startIdx)]:[this]}relativeTo(e){if(this.sourceString!==e.sourceString)throw me();return U(this.startIdx>=e.startIdx&&this.endIdx<=e.endIdx,"other interval does not cover this one"),new N(this.sourceString,this.startIdx-e.startIdx,this.endIdx-e.startIdx)}trimmed(){const{contents:e}=this,t=this.startIdx+e.match(/^\s*/)[0].length,s=this.endIdx-e.match(/\s*$/)[0].length;return new N(this.sourceString,t,s)}subInterval(e,t){const s=this.startIdx+e;return new N(this.sourceString,s,s+t)}}N.coverage=function(r,...e){let{startIdx:t,endIdx:s}=r;for(const n of e){if(n.sourceString!==r.sourceString)throw me();t=Math.min(t,n.startIdx),s=Math.max(s,n.endIdx)}return new N(r.sourceString,t,s)};const Bt=65535;class ne{constructor(e){this.source=e,this.pos=0,this.examinedLength=0}atEnd(){const e=this.pos>=this.source.length;return this.examinedLength=Math.max(this.examinedLength,this.pos+1),e}next(){const e=this.source[this.pos++];return this.examinedLength=Math.max(this.examinedLength,this.pos),e}nextCharCode(){const e=this.next();return e&&e.charCodeAt(0)}nextCodePoint(){const e=this.source.slice(this.pos++).codePointAt(0);return e>Bt&&(this.pos+=1),this.examinedLength=Math.max(this.examinedLength,this.pos),e}matchString(e,t){let s;if(t){for(s=0;s<e.length;s++){const n=this.next(),i=e[s];if(n==null||n.toUpperCase()!==i.toUpperCase())return!1}return!0}for(s=0;s<e.length;s++)if(this.next()!==e[s])return!1;return!0}sourceSlice(e,t){return this.source.slice(e,t)}interval(e,t){return new N(this.source,e,t||this.pos)}}class rt{constructor(e,t,s,n,i,a,o){this.matcher=e,this.input=t,this.startExpr=s,this._cst=n,this._cstOffset=i,this._rightmostFailurePosition=a,this._rightmostFailures=o,this.failed()&&(pe(this,"message",function(){const l="Expected "+this.getExpectedText();return tt(this.input,this.getRightmostFailurePosition())+l}),pe(this,"shortMessage",function(){const l="expected "+this.getExpectedText(),p=ge(this.input,this.getRightmostFailurePosition());return"Line "+p.lineNum+", col "+p.colNum+": "+l}))}succeeded(){return!!this._cst}failed(){return!this.succeeded()}getRightmostFailurePosition(){return this._rightmostFailurePosition}getRightmostFailures(){if(!this._rightmostFailures){this.matcher.setInput(this.input);const e=this.matcher._match(this.startExpr,{tracing:!1,positionToRecordFailures:this.getRightmostFailurePosition()});this._rightmostFailures=e.getRightmostFailures()}return this._rightmostFailures}toString(){return this.succeeded()?"[match succeeded]":"[match failed at position "+this.getRightmostFailurePosition()+"]"}getExpectedText(){if(this.succeeded())throw new Error("cannot get expected text of a successful MatchResult");const e=new X;let t=this.getRightmostFailures();t=t.filter(s=>!s.isFluffy());for(let s=0;s<t.length;s++)s>0&&(s===t.length-1?e.append(t.length>2?", or ":" or "):e.append(", ")),e.append(t[s].toString());return e.contents()}getInterval(){const e=this.getRightmostFailurePosition();return new N(this.input,e,e)}}class jt{constructor(){this.applicationMemoKeyStack=[],this.memo={},this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,this.currentLeftRecursion=void 0}isActive(e){return this.applicationMemoKeyStack.indexOf(e.toMemoKey())>=0}enter(e){this.applicationMemoKeyStack.push(e.toMemoKey())}exit(){this.applicationMemoKeyStack.pop()}startLeftRecursion(e,t){t.isLeftRecursion=!0,t.headApplication=e,t.nextLeftRecursion=this.currentLeftRecursion,this.currentLeftRecursion=t;const{applicationMemoKeyStack:s}=this,n=s.indexOf(e.toMemoKey())+1,i=s.slice(n);t.isInvolved=function(a){return i.indexOf(a)>=0},t.updateInvolvedApplicationMemoKeys=function(){for(let a=n;a<s.length;a++){const o=s[a];this.isInvolved(o)||i.push(o)}}}endLeftRecursion(){this.currentLeftRecursion=this.currentLeftRecursion.nextLeftRecursion}shouldUseMemoizedResult(e){if(!e.isLeftRecursion)return!0;const{applicationMemoKeyStack:t}=this;for(let s=0;s<t.length;s++){const n=t[s];if(e.isInvolved(n))return!1}return!0}memoize(e,t){return this.memo[e]=t,this.maxExaminedLength=Math.max(this.maxExaminedLength,t.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,t.rightmostFailureOffset),t}clearObsoleteEntries(e,t){if(e+this.maxExaminedLength<=t)return;const{memo:s}=this;this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,Object.keys(s).forEach(n=>{const i=s[n];e+i.examinedLength>t?delete s[n]:(this.maxExaminedLength=Math.max(this.maxExaminedLength,i.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,i.rightmostFailureOffset))})}}const Ut="✗",Wt="✓",Ht="⋅",Xt="⇒",Zt="␉",Kt="␊",Vt="␍",fe={succeeded:1,isRootNode:2,isImplicitSpaces:4,isMemoized:8,isHeadOfLeftRecursion:16,terminatesLR:32};function $t(r){return ee(" ",r).join("")}function Qt(r,e,t){const s=nt(r.slice(e,e+t));return s.length<t?s+ee(" ",t-s.length).join(""):s}function nt(r){return typeof r=="string"?r.replace(/ /g,Ht).replace(/\t/g,Zt).replace(/\n/g,Kt).replace(/\r/g,Vt):String(r)}class j{constructor(e,t,s,n,i,a,o){this.input=e,this.pos=this.pos1=t,this.pos2=s,this.source=new N(e,t,s),this.expr=n,this.bindings=a,this.children=o||[],this.terminatingLREntry=null,this._flags=i?fe.succeeded:0}get displayString(){return this.expr.toDisplayString()}clone(){return this.cloneWithExpr(this.expr)}cloneWithExpr(e){const t=new j(this.input,this.pos,this.pos2,e,this.succeeded,this.bindings,this.children);return t.isHeadOfLeftRecursion=this.isHeadOfLeftRecursion,t.isImplicitSpaces=this.isImplicitSpaces,t.isMemoized=this.isMemoized,t.isRootNode=this.isRootNode,t.terminatesLR=this.terminatesLR,t.terminatingLREntry=this.terminatingLREntry,t}recordLRTermination(e,t){this.terminatingLREntry=new j(this.input,this.pos,this.pos2,this.expr,!1,[t],[e]),this.terminatingLREntry.terminatesLR=!0}walk(e,t){let s=e;typeof s=="function"&&(s={enter:s});function n(i,a,o){let l=!0;s.enter&&s.enter.call(t,i,a,o)===j.prototype.SKIP&&(l=!1),l&&(i.children.forEach(p=>{n(p,i,o+1)}),s.exit&&s.exit.call(t,i,a,o))}this.isRootNode?this.children.forEach(i=>{n(i,null,0)}):n(this,null,0)}toString(){const e=new X;return this.walk((t,s,n)=>{if(!t)return this.SKIP;if(t.expr.constructor.name!=="Alt"){if(e.append(Qt(t.input,t.pos,10)+$t(n*2+1)),e.append((t.succeeded?Wt:Ut)+" "+t.displayString),t.isHeadOfLeftRecursion&&e.append(" (LR)"),t.succeeded){const a=nt(t.source.contents);e.append(" "+Xt+"  "),e.append(typeof a=="string"?'"'+a+'"':a)}e.append(`
`)}}),e.contents()}}j.prototype.SKIP={};Object.keys(fe).forEach(r=>{const e=fe[r];Object.defineProperty(j.prototype,r,{get(){return(this._flags&e)!==0},set(t){t?this._flags|=e:this._flags&=~e}})});d.prototype.allowsSkippingPrecedingSpace=G("allowsSkippingPrecedingSpace");b.allowsSkippingPrecedingSpace=E.allowsSkippingPrecedingSpace=I.prototype.allowsSkippingPrecedingSpace=A.prototype.allowsSkippingPrecedingSpace=O.prototype.allowsSkippingPrecedingSpace=_.prototype.allowsSkippingPrecedingSpace=function(){return!0};x.prototype.allowsSkippingPrecedingSpace=T.prototype.allowsSkippingPrecedingSpace=C.prototype.allowsSkippingPrecedingSpace=L.prototype.allowsSkippingPrecedingSpace=R.prototype.allowsSkippingPrecedingSpace=w.prototype.allowsSkippingPrecedingSpace=S.prototype.allowsSkippingPrecedingSpace=function(){return!1};let $;et(r=>{$=r});let J;d.prototype.assertAllApplicationsAreValid=function(r,e){J=0,this._assertAllApplicationsAreValid(r,e)};d.prototype._assertAllApplicationsAreValid=G("_assertAllApplicationsAreValid");b._assertAllApplicationsAreValid=E._assertAllApplicationsAreValid=A.prototype._assertAllApplicationsAreValid=O.prototype._assertAllApplicationsAreValid=w.prototype._assertAllApplicationsAreValid=_.prototype._assertAllApplicationsAreValid=function(r,e){};C.prototype._assertAllApplicationsAreValid=function(r,e){J++,this.expr._assertAllApplicationsAreValid(r,e),J--};x.prototype._assertAllApplicationsAreValid=function(r,e){for(let t=0;t<this.terms.length;t++)this.terms[t]._assertAllApplicationsAreValid(r,e)};S.prototype._assertAllApplicationsAreValid=function(r,e){for(let t=0;t<this.factors.length;t++)this.factors[t]._assertAllApplicationsAreValid(r,e)};T.prototype._assertAllApplicationsAreValid=R.prototype._assertAllApplicationsAreValid=L.prototype._assertAllApplicationsAreValid=function(r,e){this.expr._assertAllApplicationsAreValid(r,e)};I.prototype._assertAllApplicationsAreValid=function(r,e,t=!1){const s=e.rules[this.ruleName],n=H(r)&&J===0;if(!s)throw Qe(this.ruleName,e.name,this.source);if(!t&&H(this.ruleName)&&!n)throw Ft(this.ruleName,this);const i=this.args.length,a=s.formals.length;if(i!==a)throw Et(this.ruleName,a,i,this.source);const o=$&&s===$.rules.applySyntactic;if($&&s===$.rules.caseInsensitive&&!(this.args[0]instanceof A))throw we('a Terminal (e.g. "abc")',this.args[0]);if(o){const p=this.args[0];if(!(p instanceof I))throw we("a syntactic rule application",p);if(!H(p.ruleName))throw Gt(p);if(n)throw Tt(this)}this.args.forEach(p=>{if(p._assertAllApplicationsAreValid(r,e,o),p.getArity()!==1)throw Ot(this.ruleName,p)})};d.prototype.assertChoicesHaveUniformArity=G("assertChoicesHaveUniformArity");b.assertChoicesHaveUniformArity=E.assertChoicesHaveUniformArity=A.prototype.assertChoicesHaveUniformArity=O.prototype.assertChoicesHaveUniformArity=w.prototype.assertChoicesHaveUniformArity=C.prototype.assertChoicesHaveUniformArity=_.prototype.assertChoicesHaveUniformArity=function(r){};x.prototype.assertChoicesHaveUniformArity=function(r){if(this.terms.length===0)return;const e=this.terms[0].getArity();for(let t=0;t<this.terms.length;t++){const s=this.terms[t];s.assertChoicesHaveUniformArity();const n=s.getArity();if(e!==n)throw Ye(r,e,n,s)}};te.prototype.assertChoicesHaveUniformArity=function(r){const e=this.terms[0].getArity(),t=this.terms[1].getArity();if(e!==t)throw Ye(r,t,e,this.terms[0])};S.prototype.assertChoicesHaveUniformArity=function(r){for(let e=0;e<this.factors.length;e++)this.factors[e].assertChoicesHaveUniformArity(r)};T.prototype.assertChoicesHaveUniformArity=function(r){this.expr.assertChoicesHaveUniformArity(r)};R.prototype.assertChoicesHaveUniformArity=function(r){};L.prototype.assertChoicesHaveUniformArity=function(r){this.expr.assertChoicesHaveUniformArity(r)};I.prototype.assertChoicesHaveUniformArity=function(r){};d.prototype.assertIteratedExprsAreNotNullable=G("assertIteratedExprsAreNotNullable");b.assertIteratedExprsAreNotNullable=E.assertIteratedExprsAreNotNullable=A.prototype.assertIteratedExprsAreNotNullable=O.prototype.assertIteratedExprsAreNotNullable=w.prototype.assertIteratedExprsAreNotNullable=_.prototype.assertIteratedExprsAreNotNullable=function(r){};x.prototype.assertIteratedExprsAreNotNullable=function(r){for(let e=0;e<this.terms.length;e++)this.terms[e].assertIteratedExprsAreNotNullable(r)};S.prototype.assertIteratedExprsAreNotNullable=function(r){for(let e=0;e<this.factors.length;e++)this.factors[e].assertIteratedExprsAreNotNullable(r)};T.prototype.assertIteratedExprsAreNotNullable=function(r){if(this.expr.assertIteratedExprsAreNotNullable(r),this.expr.isNullable(r))throw Je(this,[])};B.prototype.assertIteratedExprsAreNotNullable=R.prototype.assertIteratedExprsAreNotNullable=L.prototype.assertIteratedExprsAreNotNullable=C.prototype.assertIteratedExprsAreNotNullable=function(r){this.expr.assertIteratedExprsAreNotNullable(r)};I.prototype.assertIteratedExprsAreNotNullable=function(r){this.args.forEach(e=>{e.assertIteratedExprsAreNotNullable(r)})};class ye{constructor(e){this.matchLength=e}get ctorName(){throw new Error("subclass responsibility")}numChildren(){return this.children?this.children.length:0}childAt(e){if(this.children)return this.children[e]}indexOfChild(e){return this.children.indexOf(e)}hasChildren(){return this.numChildren()>0}hasNoChildren(){return!this.hasChildren()}onlyChild(){if(this.numChildren()!==1)throw new Error("cannot get only child of a node of type "+this.ctorName+" (it has "+this.numChildren()+" children)");return this.firstChild()}firstChild(){if(this.hasNoChildren())throw new Error("cannot get first child of a "+this.ctorName+" node, which has no children");return this.childAt(0)}lastChild(){if(this.hasNoChildren())throw new Error("cannot get last child of a "+this.ctorName+" node, which has no children");return this.childAt(this.numChildren()-1)}childBefore(e){const t=this.indexOfChild(e);if(t<0)throw new Error("Node.childBefore() called w/ an argument that is not a child");if(t===0)throw new Error("cannot get child before first child");return this.childAt(t-1)}childAfter(e){const t=this.indexOfChild(e);if(t<0)throw new Error("Node.childAfter() called w/ an argument that is not a child");if(t===this.numChildren()-1)throw new Error("cannot get child after last child");return this.childAt(t+1)}isTerminal(){return!1}isNonterminal(){return!1}isIteration(){return!1}isOptional(){return!1}}class K extends ye{get ctorName(){return"_terminal"}isTerminal(){return!0}get primitiveValue(){throw new Error("The `primitiveValue` property was removed in Ohm v17.")}}class zt extends ye{constructor(e,t,s,n){super(n),this.ruleName=e,this.children=t,this.childOffsets=s}get ctorName(){return this.ruleName}isNonterminal(){return!0}isLexical(){return Ze(this.ctorName)}isSyntactic(){return H(this.ctorName)}}class st extends ye{constructor(e,t,s,n){super(s),this.children=e,this.childOffsets=t,this.optional=n}get ctorName(){return"_iter"}isIteration(){return!0}isOptional(){return this.optional}}d.prototype.eval=G("eval");b.eval=function(r){const{inputStream:e}=r,t=e.pos,s=e.nextCodePoint();return s!==void 0?(r.pushBinding(new K(String.fromCodePoint(s).length),t),!0):(r.processFailure(t,this),!1)};E.eval=function(r){const{inputStream:e}=r,t=e.pos;return e.atEnd()?(r.pushBinding(new K(0),t),!0):(r.processFailure(t,this),!1)};A.prototype.eval=function(r){const{inputStream:e}=r,t=e.pos;return e.matchString(this.obj)?(r.pushBinding(new K(this.obj.length),t),!0):(r.processFailure(t,this),!1)};O.prototype.eval=function(r){const{inputStream:e}=r,t=e.pos,s=this.matchCodePoint?e.nextCodePoint():e.nextCharCode();return s!==void 0&&this.from.codePointAt(0)<=s&&s<=this.to.codePointAt(0)?(r.pushBinding(new K(String.fromCodePoint(s).length),t),!0):(r.processFailure(t,this),!1)};w.prototype.eval=function(r){return r.eval(r.currentApplication().args[this.index])};C.prototype.eval=function(r){r.enterLexifiedContext();const e=r.eval(this.expr);return r.exitLexifiedContext(),e};x.prototype.eval=function(r){for(let e=0;e<this.terms.length;e++)if(r.eval(this.terms[e]))return!0;return!1};S.prototype.eval=function(r){for(let e=0;e<this.factors.length;e++){const t=this.factors[e];if(!r.eval(t))return!1}return!0};T.prototype.eval=function(r){const{inputStream:e}=r,t=e.pos,s=this.getArity(),n=[],i=[];for(;n.length<s;)n.push([]),i.push([]);let a=0,o=t,l;for(;a<this.maxNumMatches&&r.eval(this.expr);){if(e.pos===o)throw Je(this,r._applicationStack);o=e.pos,a++;const h=r._bindings.splice(r._bindings.length-s,s),m=r._bindingOffsets.splice(r._bindingOffsets.length-s,s);for(l=0;l<h.length;l++)n[l].push(h[l]),i[l].push(m[l])}if(a<this.minNumMatches)return!1;let p=r.posToOffset(t),u=0;if(a>0){const h=n[s-1],m=i[s-1],f=m[m.length-1]+h[h.length-1].matchLength;p=i[0][0],u=f-p}const c=this instanceof B;for(l=0;l<n.length;l++)r._bindings.push(new st(n[l],i[l],u,c)),r._bindingOffsets.push(p);return!0};R.prototype.eval=function(r){const{inputStream:e}=r,t=e.pos;r.pushFailuresInfo();const s=r.eval(this.expr);return r.popFailuresInfo(),s?(r.processFailure(t,this),!1):(e.pos=t,!0)};L.prototype.eval=function(r){const{inputStream:e}=r,t=e.pos;return r.eval(this.expr)?(e.pos=t,!0):!1};I.prototype.eval=function(r){const e=r.currentApplication(),t=e?e.args:[],s=this.substituteParams(t),n=r.getCurrentPosInfo();if(n.isActive(s))return s.handleCycle(r);const i=s.toMemoKey(),a=n.memo[i];if(a&&n.shouldUseMemoizedResult(a)){if(r.hasNecessaryInfo(a))return r.useMemoizedResult(r.inputStream.pos,a);delete n.memo[i]}return s.reallyEval(r)};I.prototype.handleCycle=function(r){const e=r.getCurrentPosInfo(),{currentLeftRecursion:t}=e,s=this.toMemoKey();let n=e.memo[s];return t&&t.headApplication.toMemoKey()===s?n.updateInvolvedApplicationMemoKeys():n||(n=e.memoize(s,{matchLength:0,examinedLength:0,value:!1,rightmostFailureOffset:-1}),e.startLeftRecursion(this,n)),r.useMemoizedResult(r.inputStream.pos,n)};I.prototype.reallyEval=function(r){const{inputStream:e}=r,t=e.pos,s=r.getCurrentPosInfo(),n=r.grammar.rules[this.ruleName],{body:i}=n,{description:a}=n;r.enterApplication(s,this),a&&r.pushFailuresInfo();const o=e.examinedLength;e.examinedLength=0;let l=this.evalOnce(i,r);const p=s.currentLeftRecursion,u=this.toMemoKey(),c=p&&p.headApplication.toMemoKey()===u;let h;r.doNotMemoize?r.doNotMemoize=!1:c?(l=this.growSeedResult(i,r,t,p,l),s.endLeftRecursion(),h=p,h.examinedLength=e.examinedLength-t,h.rightmostFailureOffset=r._getRightmostFailureOffset(),s.memoize(u,h)):(!p||!p.isInvolved(u))&&(h=s.memoize(u,{matchLength:e.pos-t,examinedLength:e.examinedLength-t,value:l,failuresAtRightmostPosition:r.cloneRecordedFailures(),rightmostFailureOffset:r._getRightmostFailureOffset()}));const m=!!l;if(a&&(r.popFailuresInfo(),m||r.processFailure(t,this),h&&(h.failuresAtRightmostPosition=r.cloneRecordedFailures())),r.isTracing()&&h){const f=r.getTraceEntry(t,this,m,m?[l]:[]);c&&(U(f.terminatingLREntry!=null||!m),f.isHeadOfLeftRecursion=!0),h.traceEntry=f}return e.examinedLength=Math.max(e.examinedLength,o),r.exitApplication(s,l),m};I.prototype.evalOnce=function(r,e){const{inputStream:t}=e,s=t.pos;if(e.eval(r)){const n=r.getArity(),i=e._bindings.splice(e._bindings.length-n,n),a=e._bindingOffsets.splice(e._bindingOffsets.length-n,n),o=t.pos-s;return new zt(this.ruleName,i,a,o)}else return!1};I.prototype.growSeedResult=function(r,e,t,s,n){if(!n)return!1;const{inputStream:i}=e;for(;;){if(s.matchLength=i.pos-t,s.value=n,s.failuresAtRightmostPosition=e.cloneRecordedFailures(),e.isTracing()){const a=e.trace[e.trace.length-1];s.traceEntry=new j(e.input,t,i.pos,this,!0,[n],[a.clone()])}if(i.pos=t,n=this.evalOnce(r,e),i.pos-t<=s.matchLength)break;e.isTracing()&&e.trace.splice(-2,1)}return e.isTracing()&&s.traceEntry.recordLRTermination(e.trace.pop(),n),i.pos=t+s.matchLength,s.value};_.prototype.eval=function(r){const{inputStream:e}=r,t=e.pos,s=e.next();return s&&this.pattern.test(s)?(r.pushBinding(new K(s.length),t),!0):(r.processFailure(t,this),!1)};d.prototype.getArity=G("getArity");b.getArity=E.getArity=A.prototype.getArity=O.prototype.getArity=w.prototype.getArity=I.prototype.getArity=_.prototype.getArity=function(){return 1};x.prototype.getArity=function(){return this.terms.length===0?0:this.terms[0].getArity()};S.prototype.getArity=function(){let r=0;for(let e=0;e<this.factors.length;e++)r+=this.factors[e].getArity();return r};T.prototype.getArity=function(){return this.expr.getArity()};R.prototype.getArity=function(){return 0};L.prototype.getArity=C.prototype.getArity=function(){return this.expr.getArity()};function k(r,e){const t={};if(r.source&&e){const s=r.source.relativeTo(e);t.sourceInterval=[s.startIdx,s.endIdx]}return t}d.prototype.outputRecipe=G("outputRecipe");b.outputRecipe=function(r,e){return["any",k(this,e)]};E.outputRecipe=function(r,e){return["end",k(this,e)]};A.prototype.outputRecipe=function(r,e){return["terminal",k(this,e),this.obj]};O.prototype.outputRecipe=function(r,e){return["range",k(this,e),this.from,this.to]};w.prototype.outputRecipe=function(r,e){return["param",k(this,e),this.index]};x.prototype.outputRecipe=function(r,e){return["alt",k(this,e)].concat(this.terms.map(t=>t.outputRecipe(r,e)))};te.prototype.outputRecipe=function(r,e){return this.terms[0].outputRecipe(r,e)};re.prototype.outputRecipe=function(r,e){const t=this.terms.slice(0,this.expansionPos),s=this.terms.slice(this.expansionPos+1);return["splice",k(this,e),t.map(n=>n.outputRecipe(r,e)),s.map(n=>n.outputRecipe(r,e))]};S.prototype.outputRecipe=function(r,e){return["seq",k(this,e)].concat(this.factors.map(t=>t.outputRecipe(r,e)))};Z.prototype.outputRecipe=V.prototype.outputRecipe=B.prototype.outputRecipe=R.prototype.outputRecipe=L.prototype.outputRecipe=C.prototype.outputRecipe=function(r,e){return[this.constructor.name.toLowerCase(),k(this,e),this.expr.outputRecipe(r,e)]};I.prototype.outputRecipe=function(r,e){return["app",k(this,e),this.ruleName,this.args.map(t=>t.outputRecipe(r,e))]};_.prototype.outputRecipe=function(r,e){return["unicodeChar",k(this,e),this.category]};d.prototype.introduceParams=G("introduceParams");b.introduceParams=E.introduceParams=A.prototype.introduceParams=O.prototype.introduceParams=w.prototype.introduceParams=_.prototype.introduceParams=function(r){return this};x.prototype.introduceParams=function(r){return this.terms.forEach((e,t,s)=>{s[t]=e.introduceParams(r)}),this};S.prototype.introduceParams=function(r){return this.factors.forEach((e,t,s)=>{s[t]=e.introduceParams(r)}),this};T.prototype.introduceParams=R.prototype.introduceParams=L.prototype.introduceParams=C.prototype.introduceParams=function(r){return this.expr=this.expr.introduceParams(r),this};I.prototype.introduceParams=function(r){const e=r.indexOf(this.ruleName);if(e>=0){if(this.args.length>0)throw new Error("Parameterized rules cannot be passed as arguments to another rule.");return new w(e).withSource(this.source)}else return this.args.forEach((t,s,n)=>{n[s]=t.introduceParams(r)}),this};d.prototype.isNullable=function(r){return this._isNullable(r,Object.create(null))};d.prototype._isNullable=G("_isNullable");b._isNullable=O.prototype._isNullable=w.prototype._isNullable=V.prototype._isNullable=_.prototype._isNullable=function(r,e){return!1};E._isNullable=function(r,e){return!0};A.prototype._isNullable=function(r,e){return typeof this.obj=="string"?this.obj==="":!1};x.prototype._isNullable=function(r,e){return this.terms.length===0||this.terms.some(t=>t._isNullable(r,e))};S.prototype._isNullable=function(r,e){return this.factors.every(t=>t._isNullable(r,e))};Z.prototype._isNullable=B.prototype._isNullable=R.prototype._isNullable=L.prototype._isNullable=function(r,e){return!0};C.prototype._isNullable=function(r,e){return this.expr._isNullable(r,e)};I.prototype._isNullable=function(r,e){const t=this.toMemoKey();if(!Object.prototype.hasOwnProperty.call(e,t)){const{body:s}=r.rules[this.ruleName],n=s.substituteParams(this.args);e[t]=!1,e[t]=n._isNullable(r,e)}return e[t]};d.prototype.substituteParams=G("substituteParams");b.substituteParams=E.substituteParams=A.prototype.substituteParams=O.prototype.substituteParams=_.prototype.substituteParams=function(r){return this};w.prototype.substituteParams=function(r){return r[this.index]};x.prototype.substituteParams=function(r){return new x(this.terms.map(e=>e.substituteParams(r)))};S.prototype.substituteParams=function(r){return new S(this.factors.map(e=>e.substituteParams(r)))};T.prototype.substituteParams=R.prototype.substituteParams=L.prototype.substituteParams=C.prototype.substituteParams=function(r){return new this.constructor(this.expr.substituteParams(r))};I.prototype.substituteParams=function(r){if(this.args.length===0)return this;{const e=this.args.map(t=>t.substituteParams(r));return new I(this.ruleName,e)}};function Te(r){return/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(r)}function xe(r){const e=Object.create(null);r.forEach(t=>{e[t]=(e[t]||0)+1}),Object.keys(e).forEach(t=>{if(e[t]<=1)return;let s=1;r.forEach((n,i)=>{n===t&&(r[i]=n+"_"+s++)})})}d.prototype.toArgumentNameList=G("toArgumentNameList");b.toArgumentNameList=function(r,e){return["any"]};E.toArgumentNameList=function(r,e){return["end"]};A.prototype.toArgumentNameList=function(r,e){return typeof this.obj=="string"&&/^[_a-zA-Z0-9]+$/.test(this.obj)?["_"+this.obj]:["$"+r]};O.prototype.toArgumentNameList=function(r,e){let t=this.from+"_to_"+this.to;return Te(t)||(t="_"+t),Te(t)||(t="$"+r),[t]};x.prototype.toArgumentNameList=function(r,e){const t=this.terms.map(i=>i.toArgumentNameList(r,!0)),s=[],n=t[0].length;for(let i=0;i<n;i++){const a=[];for(let l=0;l<this.terms.length;l++)a.push(t[l][i]);const o=Xe(a);s.push(o.join("_or_"))}return e||xe(s),s};S.prototype.toArgumentNameList=function(r,e){let t=[];return this.factors.forEach(s=>{const n=s.toArgumentNameList(r,!0);t=t.concat(n),r+=n.length}),e||xe(t),t};T.prototype.toArgumentNameList=function(r,e){const t=this.expr.toArgumentNameList(r,e).map(s=>s[s.length-1]==="s"?s+"es":s+"s");return e||xe(t),t};B.prototype.toArgumentNameList=function(r,e){return this.expr.toArgumentNameList(r,e).map(t=>"opt"+t[0].toUpperCase()+t.slice(1))};R.prototype.toArgumentNameList=function(r,e){return[]};L.prototype.toArgumentNameList=C.prototype.toArgumentNameList=function(r,e){return this.expr.toArgumentNameList(r,e)};I.prototype.toArgumentNameList=function(r,e){return[this.ruleName]};_.prototype.toArgumentNameList=function(r,e){return["$"+r]};w.prototype.toArgumentNameList=function(r,e){return["param"+this.index]};d.prototype.toDisplayString=G("toDisplayString");x.prototype.toDisplayString=S.prototype.toDisplayString=function(){return this.source?this.source.trimmed().contents:"["+this.constructor.name+"]"};b.toDisplayString=E.toDisplayString=T.prototype.toDisplayString=R.prototype.toDisplayString=L.prototype.toDisplayString=C.prototype.toDisplayString=A.prototype.toDisplayString=O.prototype.toDisplayString=w.prototype.toDisplayString=function(){return this.toString()};I.prototype.toDisplayString=function(){if(this.args.length>0){const r=this.args.map(e=>e.toDisplayString());return this.ruleName+"<"+r.join(",")+">"}else return this.ruleName};_.prototype.toDisplayString=function(){return"Unicode ["+this.category+"] character"};function Jt(r){return r==="description"||r==="string"||r==="code"}class D{constructor(e,t,s){if(!Jt(s))throw new Error("invalid Failure type: "+s);this.pexpr=e,this.text=t,this.type=s,this.fluffy=!1}getPExpr(){return this.pexpr}getText(){return this.text}getType(){return this.type}isDescription(){return this.type==="description"}isStringTerminal(){return this.type==="string"}isCode(){return this.type==="code"}isFluffy(){return this.fluffy}makeFluffy(){this.fluffy=!0}clearFluffy(){this.fluffy=!1}subsumes(e){return this.getText()===e.getText()&&this.type===e.type&&(!this.isFluffy()||this.isFluffy()&&e.isFluffy())}toString(){return this.type==="string"?JSON.stringify(this.getText()):this.getText()}clone(){const e=new D(this.pexpr,this.text,this.type);return this.isFluffy()&&e.makeFluffy(),e}toKey(){return this.toString()+"#"+this.type}}d.prototype.toFailure=G("toFailure");b.toFailure=function(r){return new D(this,"any object","description")};E.toFailure=function(r){return new D(this,"end of input","description")};A.prototype.toFailure=function(r){return new D(this,this.obj,"string")};O.prototype.toFailure=function(r){return new D(this,JSON.stringify(this.from)+".."+JSON.stringify(this.to),"code")};R.prototype.toFailure=function(r){const e=this.expr===b?"nothing":"not "+this.expr.toFailure(r);return new D(this,e,"description")};L.prototype.toFailure=function(r){return this.expr.toFailure(r)};I.prototype.toFailure=function(r){let{description:e}=r.rules[this.ruleName];return e||(e=(/^[aeiouAEIOU]/.test(this.ruleName)?"an":"a")+" "+this.ruleName),new D(this,e,"description")};_.prototype.toFailure=function(r){return new D(this,"a Unicode ["+this.category+"] character","description")};x.prototype.toFailure=function(r){const t="("+this.terms.map(s=>s.toFailure(r)).join(" or ")+")";return new D(this,t,"description")};S.prototype.toFailure=function(r){const t="("+this.factors.map(s=>s.toFailure(r)).join(" ")+")";return new D(this,t,"description")};T.prototype.toFailure=function(r){const e="("+this.expr.toFailure(r)+this.operator+")";return new D(this,e,"description")};d.prototype.toString=G("toString");b.toString=function(){return"any"};E.toString=function(){return"end"};A.prototype.toString=function(){return JSON.stringify(this.obj)};O.prototype.toString=function(){return JSON.stringify(this.from)+".."+JSON.stringify(this.to)};w.prototype.toString=function(){return"$"+this.index};C.prototype.toString=function(){return"#("+this.expr.toString()+")"};x.prototype.toString=function(){return this.terms.length===1?this.terms[0].toString():"("+this.terms.map(r=>r.toString()).join(" | ")+")"};S.prototype.toString=function(){return this.factors.length===1?this.factors[0].toString():"("+this.factors.map(r=>r.toString()).join(" ")+")"};T.prototype.toString=function(){return this.expr+this.operator};R.prototype.toString=function(){return"~"+this.expr};L.prototype.toString=function(){return"&"+this.expr};I.prototype.toString=function(){if(this.args.length>0){const r=this.args.map(e=>e.toString());return this.ruleName+"<"+r.join(",")+">"}else return this.ruleName};_.prototype.toString=function(){return"\\p{"+this.category+"}"};class Se extends d{constructor(e){super(),this.obj=e}_getString(e){const t=e.currentApplication().args[this.obj.index];return U(t instanceof A,"expected a Terminal expression"),t.obj}allowsSkippingPrecedingSpace(){return!0}eval(e){const{inputStream:t}=e,s=t.pos,n=this._getString(e);return t.matchString(n,!0)?(e.pushBinding(new K(n.length),s),!0):(e.processFailure(s,this),!1)}getArity(){return 1}substituteParams(e){return new Se(this.obj.substituteParams(e))}toDisplayString(){return this.obj.toDisplayString()+" (case-insensitive)"}toFailure(e){return new D(this,this.obj.toFailure(e)+" (case-insensitive)","description")}_isNullable(e,t){return this.obj._isNullable(e,t)}}let it;et(r=>{it=r.rules.applySyntactic.body});const ae=new I("spaces");class Yt{constructor(e,t,s){this.matcher=e,this.startExpr=t,this.grammar=e.grammar,this.input=e.getInput(),this.inputStream=new ne(this.input),this.memoTable=e._memoTable,this.userData=void 0,this.doNotMemoize=!1,this._bindings=[],this._bindingOffsets=[],this._applicationStack=[],this._posStack=[0],this.inLexifiedContextStack=[!1],this.rightmostFailurePosition=-1,this._rightmostFailurePositionStack=[],this._recordedFailuresStack=[],s!==void 0&&(this.positionToRecordFailures=s,this.recordedFailures=Object.create(null))}posToOffset(e){return e-this._posStack[this._posStack.length-1]}enterApplication(e,t){this._posStack.push(this.inputStream.pos),this._applicationStack.push(t),this.inLexifiedContextStack.push(!1),e.enter(t),this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this.rightmostFailurePosition=-1}exitApplication(e,t){const s=this._posStack.pop();this._applicationStack.pop(),this.inLexifiedContextStack.pop(),e.exit(),this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,this._rightmostFailurePositionStack.pop()),t&&this.pushBinding(t,s)}enterLexifiedContext(){this.inLexifiedContextStack.push(!0)}exitLexifiedContext(){this.inLexifiedContextStack.pop()}currentApplication(){return this._applicationStack[this._applicationStack.length-1]}inSyntacticContext(){const e=this.currentApplication();return e?e.isSyntactic()&&!this.inLexifiedContext():this.startExpr.factors[0].isSyntactic()}inLexifiedContext(){return this.inLexifiedContextStack[this.inLexifiedContextStack.length-1]}skipSpaces(){return this.pushFailuresInfo(),this.eval(ae),this.popBinding(),this.popFailuresInfo(),this.inputStream.pos}skipSpacesIfInSyntacticContext(){return this.inSyntacticContext()?this.skipSpaces():this.inputStream.pos}maybeSkipSpacesBefore(e){return e.allowsSkippingPrecedingSpace()&&e!==ae?this.skipSpacesIfInSyntacticContext():this.inputStream.pos}pushBinding(e,t){this._bindings.push(e),this._bindingOffsets.push(this.posToOffset(t))}popBinding(){this._bindings.pop(),this._bindingOffsets.pop()}numBindings(){return this._bindings.length}truncateBindings(e){for(;this._bindings.length>e;)this.popBinding()}getCurrentPosInfo(){return this.getPosInfo(this.inputStream.pos)}getPosInfo(e){let t=this.memoTable[e];return t||(t=this.memoTable[e]=new jt),t}processFailure(e,t){if(this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,e),this.recordedFailures&&e===this.positionToRecordFailures){const s=this.currentApplication();s&&(t=t.substituteParams(s.args)),this.recordFailure(t.toFailure(this.grammar),!1)}}recordFailure(e,t){const s=e.toKey();this.recordedFailures[s]?this.recordedFailures[s].isFluffy()&&!e.isFluffy()&&this.recordedFailures[s].clearFluffy():this.recordedFailures[s]=t?e.clone():e}recordFailures(e,t){Object.keys(e).forEach(s=>{this.recordFailure(e[s],t)})}cloneRecordedFailures(){if(!this.recordedFailures)return;const e=Object.create(null);return Object.keys(this.recordedFailures).forEach(t=>{e[t]=this.recordedFailures[t].clone()}),e}getRightmostFailurePosition(){return this.rightmostFailurePosition}_getRightmostFailureOffset(){return this.rightmostFailurePosition>=0?this.posToOffset(this.rightmostFailurePosition):-1}getMemoizedTraceEntry(e,t){const s=this.memoTable[e];if(s&&t instanceof I){const n=s.memo[t.toMemoKey()];if(n&&n.traceEntry){const i=n.traceEntry.cloneWithExpr(t);return i.isMemoized=!0,i}}return null}getTraceEntry(e,t,s,n){if(t instanceof I){const i=this.currentApplication(),a=i?i.args:[];t=t.substituteParams(a)}return this.getMemoizedTraceEntry(e,t)||new j(this.input,e,this.inputStream.pos,t,s,n,this.trace)}isTracing(){return!!this.trace}hasNecessaryInfo(e){return this.trace&&!e.traceEntry?!1:this.recordedFailures&&this.inputStream.pos+e.rightmostFailureOffset===this.positionToRecordFailures?!!e.failuresAtRightmostPosition:!0}useMemoizedResult(e,t){this.trace&&this.trace.push(t.traceEntry);const s=this.inputStream.pos+t.rightmostFailureOffset;return this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,s),this.recordedFailures&&this.positionToRecordFailures===s&&t.failuresAtRightmostPosition&&this.recordFailures(t.failuresAtRightmostPosition,!0),this.inputStream.examinedLength=Math.max(this.inputStream.examinedLength,t.examinedLength+e),t.value?(this.inputStream.pos+=t.matchLength,this.pushBinding(t.value,e),!0):!1}eval(e){const{inputStream:t}=this,s=this._bindings.length,n=this.userData;let i;this.recordedFailures&&(i=this.recordedFailures,this.recordedFailures=Object.create(null));const a=t.pos,o=this.maybeSkipSpacesBefore(e);let l;this.trace&&(l=this.trace,this.trace=[]);const p=e.eval(this);if(this.trace){const u=this._bindings.slice(s),c=this.getTraceEntry(o,e,p,u);c.isImplicitSpaces=e===ae,c.isRootNode=e===this.startExpr,l.push(c),this.trace=l}return p?this.recordedFailures&&t.pos===this.positionToRecordFailures&&Object.keys(this.recordedFailures).forEach(u=>{this.recordedFailures[u].makeFluffy()}):(t.pos=a,this.truncateBindings(s),this.userData=n),this.recordedFailures&&this.recordFailures(i,!1),e===it&&this.skipSpaces(),p}getMatchResult(){this.grammar._setUpMatchState(this),this.eval(this.startExpr);let e;this.recordedFailures&&(e=Object.keys(this.recordedFailures).map(s=>this.recordedFailures[s]));const t=this._bindings[0];return t&&(t.grammar=this.grammar),new rt(this.matcher,this.input,this.startExpr,t,this._bindingOffsets[0],this.rightmostFailurePosition,e)}getTrace(){this.trace=[];const e=this.getMatchResult(),t=this.trace[this.trace.length-1];return t.result=e,t}pushFailuresInfo(){this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this._recordedFailuresStack.push(this.recordedFailures)}popFailuresInfo(){this.rightmostFailurePosition=this._rightmostFailurePositionStack.pop(),this.recordedFailures=this._recordedFailuresStack.pop()}}class er{constructor(e){this.grammar=e,this._memoTable=[],this._input="",this._isMemoTableStale=!1}_resetMemoTable(){this._memoTable=[],this._isMemoTableStale=!1}getInput(){return this._input}setInput(e){return this._input!==e&&this.replaceInputRange(0,this._input.length,e),this}replaceInputRange(e,t,s){const n=this._input,i=this._memoTable;if(e<0||e>n.length||t<0||t>n.length||e>t)throw new Error("Invalid indices: "+e+" and "+t);this._input=n.slice(0,e)+s+n.slice(t),this._input!==n&&i.length>0&&(this._isMemoTableStale=!0);const a=i.slice(t);i.length=e;for(let o=0;o<s.length;o++)i.push(void 0);for(const o of a)i.push(o);for(let o=0;o<e;o++){const l=i[o];l&&l.clearObsoleteEntries(o,e)}return this}match(e,t={incremental:!0}){return this._match(this._getStartExpr(e),{incremental:t.incremental,tracing:!1})}trace(e,t={incremental:!0}){return this._match(this._getStartExpr(e),{incremental:t.incremental,tracing:!0})}_match(e,t={}){const s={tracing:!1,incremental:!0,positionToRecordFailures:void 0,...t};if(!s.incremental)this._resetMemoTable();else if(this._isMemoTableStale&&!this.grammar.supportsIncrementalParsing)throw At(this.grammar);const n=new Yt(this,e,s.positionToRecordFailures);return s.tracing?n.getTrace():n.getMatchResult()}_getStartExpr(e){const t=e||this.grammar.defaultStartRule;if(!t)throw new Error("Missing start rule argument -- the grammar has no default start rule.");const s=this.grammar.parseApplication(t);return new S([s,E])}}const Q=[],Ie=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);class Re{constructor(e,t,s){this._node=e,this.source=t,this._baseInterval=s,e.isNonterminal()&&U(t===s),this._childWrappers=[]}_forgetMemoizedResultFor(e){delete this._node[this._semantics.attributeKeys[e]],this.children.forEach(t=>{t._forgetMemoizedResultFor(e)})}child(e){if(!(0<=e&&e<this._node.numChildren()))return;let t=this._childWrappers[e];if(!t){const s=this._node.childAt(e),n=this._node.childOffsets[e],i=this._baseInterval.subInterval(n,s.matchLength),a=s.isNonterminal()?i:this._baseInterval;t=this._childWrappers[e]=this._semantics.wrap(s,i,a)}return t}_children(){for(let e=0;e<this._node.numChildren();e++)this.child(e);return this._childWrappers}isIteration(){return this._node.isIteration()}isTerminal(){return this._node.isTerminal()}isNonterminal(){return this._node.isNonterminal()}isSyntactic(){return this.isNonterminal()&&this._node.isSyntactic()}isLexical(){return this.isNonterminal()&&this._node.isLexical()}isOptional(){return this._node.isOptional()}iteration(e){const t=e||[],s=t.map(a=>a._node),n=new st(s,[],-1,!1),i=this._semantics.wrap(n,null,null);return i._childWrappers=t,i}get children(){return this._children()}get ctorName(){return this._node.ctorName}get numChildren(){return this._node.numChildren()}get sourceString(){return this.source.contents}}class P{constructor(e,t){const s=this;if(this.grammar=e,this.checkedActionDicts=!1,this.Wrapper=class extends(t?t.Wrapper:Re){constructor(n,i,a){super(n,i,a),s.checkActionDictsIfHaventAlready(),this._semantics=s}toString(){return"[semantics wrapper for "+s.grammar.name+"]"}},this.super=t,t){if(!(e.equals(this.super.grammar)||e._inheritsFrom(this.super.grammar)))throw new Error("Cannot extend a semantics for grammar '"+this.super.grammar.name+"' for use with grammar '"+e.name+"' (not a sub-grammar)");this.operations=Object.create(this.super.operations),this.attributes=Object.create(this.super.attributes),this.attributeKeys=Object.create(null);for(const n in this.attributes)Object.defineProperty(this.attributeKeys,n,{value:Ge(n)})}else this.operations=Object.create(null),this.attributes=Object.create(null),this.attributeKeys=Object.create(null)}toString(){return"[semantics for "+this.grammar.name+"]"}checkActionDictsIfHaventAlready(){this.checkedActionDicts||(this.checkActionDicts(),this.checkedActionDicts=!0)}checkActionDicts(){let e;for(e in this.operations)this.operations[e].checkActionDict(this.grammar);for(e in this.attributes)this.attributes[e].checkActionDict(this.grammar)}toRecipe(e){function t(n){return n.super!==P.BuiltInSemantics._getSemantics()}let s=`(function(g) {
`;if(t(this)){s+="  var semantics = "+this.super.toRecipe(!0)+"(g";const n=this.super.grammar;let i=this.grammar;for(;i!==n;)s+=".superGrammar",i=i.superGrammar;s+=`);
`,s+="  return g.extendSemantics(semantics)"}else s+="  return g.createSemantics()";return["Operation","Attribute"].forEach(n=>{const i=this[n.toLowerCase()+"s"];Object.keys(i).forEach(a=>{const{actionDict:o,formals:l,builtInDefault:p}=i[a];let u=a;l.length>0&&(u+="("+l.join(", ")+")");let c;t(this)&&this.super[n.toLowerCase()+"s"][a]?c="extend"+n:c="add"+n,s+=`
    .`+c+"("+JSON.stringify(u)+", {";const h=[];Object.keys(o).forEach(m=>{if(o[m]!==p){let f=o[m].toString().trim();f=f.replace(/^.*\(/,"function("),h.push(`
      `+JSON.stringify(m)+": "+f)}}),s+=h.join(",")+`
    })`})}),s+=`;
  })`,e||(s=`(function() {
  var grammar = this.fromRecipe(`+this.grammar.toRecipe()+`);
  var semantics = `+s+`(grammar);
  return semantics;
});
`),s}addOperationOrAttribute(e,t,s){const n=e+"s",i=Le(t,e),{name:a}=i,{formals:o}=i;this.assertNewName(a,e);const l=tr(e,a,c),p={_default:l};Object.keys(s).forEach(h=>{p[h]=s[h]});const u=e==="operation"?new z(a,o,p,l):new ve(a,p,l);u.checkActionDict(this.grammar),this[n][a]=u;function c(...h){const m=this._semantics[n][a];if(arguments.length!==m.formals.length)throw new Error("Invalid number of arguments passed to "+a+" "+e+" (expected "+m.formals.length+", got "+arguments.length+")");const f=Object.create(null);for(const[q,W]of Object.entries(h)){const pt=m.formals[q];f[pt]=W}const g=this.args;this.args=f;const y=m.execute(this._semantics,this);return this.args=g,y}e==="operation"?(this.Wrapper.prototype[a]=c,this.Wrapper.prototype[a].toString=function(){return"["+a+" operation]"}):(Object.defineProperty(this.Wrapper.prototype,a,{get:c,configurable:!0}),Object.defineProperty(this.attributeKeys,a,{value:Ge(a)}))}extendOperationOrAttribute(e,t,s){const n=e+"s";if(Le(t,"attribute"),!(this.super&&t in this.super[n]))throw new Error("Cannot extend "+e+" '"+t+"': did not inherit an "+e+" with that name");if(Ie(this[n],t))throw new Error("Cannot extend "+e+" '"+t+"' again");const i=this[n][t].formals,a=this[n][t].actionDict,o=Object.create(a);Object.keys(s).forEach(l=>{o[l]=s[l]}),this[n][t]=e==="operation"?new z(t,i,o):new ve(t,o),this[n][t].checkActionDict(this.grammar)}assertNewName(e,t){if(Ie(Re.prototype,e))throw new Error("Cannot add "+t+" '"+e+"': that's a reserved name");if(e in this.operations)throw new Error("Cannot add "+t+" '"+e+"': an operation with that name already exists");if(e in this.attributes)throw new Error("Cannot add "+t+" '"+e+"': an attribute with that name already exists")}wrap(e,t,s){const n=s||t;return e instanceof this.Wrapper?e:new this.Wrapper(e,t,n)}}function Le(r,e){if(!P.prototypeGrammar)return U(r.indexOf("(")===-1),{name:r,formals:[]};const t=P.prototypeGrammar.match(r,e==="operation"?"OperationSignature":"AttributeSignature");if(t.failed())throw new Error(t.message);return P.prototypeGrammarSemantics(t).parse()}function tr(r,e,t){return function(...s){const i=(this._semantics.operations[e]||this._semantics.attributes[e]).formals.map(a=>this.args[a]);if(!this.isIteration()&&s.length===1)return t.apply(s[0],i);throw Ct(this.ctorName,e,r,Q)}}P.createSemantics=function(r,e){const t=new P(r,e!==void 0?e:P.BuiltInSemantics._getSemantics()),s=function(i){if(!(i instanceof rt))throw new TypeError("Semantics expected a MatchResult, but got "+$e(i));if(i.failed())throw new TypeError("cannot apply Semantics to "+i.toString());const a=i._cst;if(a.grammar!==r)throw new Error("Cannot use a MatchResult from grammar '"+a.grammar.name+"' with a semantics for '"+r.name+"'");const o=new ne(i.input);return t.wrap(a,o.interval(i._cstOffset,i.input.length))};return s.addOperation=function(n,i){return t.addOperationOrAttribute("operation",n,i),s},s.extendOperation=function(n,i){return t.extendOperationOrAttribute("operation",n,i),s},s.addAttribute=function(n,i){return t.addOperationOrAttribute("attribute",n,i),s},s.extendAttribute=function(n,i){return t.extendOperationOrAttribute("attribute",n,i),s},s._getActionDict=function(n){const i=t.operations[n]||t.attributes[n];if(!i)throw new Error('"'+n+'" is not a valid operation or attribute name in this semantics for "'+r.name+'"');return i.actionDict},s._remove=function(n){let i;return n in t.operations?(i=t.operations[n],delete t.operations[n]):n in t.attributes&&(i=t.attributes[n],delete t.attributes[n]),delete t.Wrapper.prototype[n],i},s.getOperationNames=function(){return Object.keys(t.operations)},s.getAttributeNames=function(){return Object.keys(t.attributes)},s.getGrammar=function(){return t.grammar},s.toRecipe=function(n){return t.toRecipe(n)},s.toString=t.toString.bind(t),s._getSemantics=function(){return t},s};class z{constructor(e,t,s,n){this.name=e,this.formals=t,this.actionDict=s,this.builtInDefault=n}checkActionDict(e){e._checkTopDownActionDict(this.typeName,this.name,this.actionDict)}execute(e,t){try{const{ctorName:s}=t._node;let n=this.actionDict[s];return n?(Q.push([this,s]),n.apply(t,t._children())):t.isNonterminal()&&(n=this.actionDict._nonterminal,n)?(Q.push([this,"_nonterminal",s]),n.apply(t,t._children())):(Q.push([this,"default action",s]),this.actionDict._default.apply(t,t._children()))}finally{Q.pop()}}}z.prototype.typeName="operation";class ve extends z{constructor(e,t,s){super(e,[],t,s)}execute(e,t){const s=t._node,n=e.attributeKeys[this.name];return Ie(s,n)||(s[n]=z.prototype.execute.call(this,e,t)),s[n]}}ve.prototype.typeName="attribute";const Pe=["_iter","_terminal","_nonterminal","_default"];function Ce(r){return Object.keys(r.rules).sort().map(e=>r.rules[e])}const rr=r=>r.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029");let at,ot;class F{constructor(e,t,s,n){if(this.name=e,this.superGrammar=t,this.rules=s,n){if(!(n in s))throw new Error("Invalid start rule: '"+n+"' is not a rule in grammar '"+e+"'");this.defaultStartRule=n}this._matchStateInitializer=void 0,this.supportsIncrementalParsing=!0}matcher(){return new er(this)}isBuiltIn(){return this===F.ProtoBuiltInRules||this===F.BuiltInRules}equals(e){if(this===e)return!0;if(e==null||this.name!==e.name||this.defaultStartRule!==e.defaultStartRule||!(this.superGrammar===e.superGrammar||this.superGrammar.equals(e.superGrammar)))return!1;const t=Ce(this),s=Ce(e);return t.length===s.length&&t.every((n,i)=>n.description===s[i].description&&n.formals.join(",")===s[i].formals.join(",")&&n.body.toString()===s[i].body.toString())}match(e,t){const s=this.matcher();return s.replaceInputRange(0,0,e),s.match(t)}trace(e,t){const s=this.matcher();return s.replaceInputRange(0,0,e),s.trace(t)}createSemantics(){return P.createSemantics(this)}extendSemantics(e){return P.createSemantics(this,e._getSemantics())}_checkTopDownActionDict(e,t,s){const n=[];for(const i in s){const a=s[i];if(!Pe.includes(i)&&!(i in this.rules)){n.push(`'${i}' is not a valid semantic action for '${this.name}'`);continue}if(typeof a!="function"){n.push(`'${i}' must be a function in an action dictionary for '${this.name}'`);continue}const l=a.length,p=this._topDownActionArity(i);if(l!==p){let u;i==="_iter"||i==="_nonterminal"?u=`it should use a rest parameter, e.g. \`${i}(...children) {}\`. NOTE: this is new in Ohm v16 — see https://ohmjs.org/d/ati for details.`:u=`expected ${p}, got ${l}`,n.push(`Semantic action '${i}' has the wrong arity: ${u}`)}}if(n.length>0){const i=n.map(o=>"- "+o),a=new Error([`Found errors in the action dictionary of the '${t}' ${e}:`,...i].join(`
`));throw a.problems=n,a}}_topDownActionArity(e){return Pe.includes(e)?0:this.rules[e].body.getArity()}_inheritsFrom(e){let t=this.superGrammar;for(;t;){if(t.equals(e,!0))return!0;t=t.superGrammar}return!1}toRecipe(e=void 0){const t={};this.source&&(t.source=this.source.contents);let s=null;this.defaultStartRule&&(s=this.defaultStartRule);const n={};Object.keys(this.rules).forEach(o=>{const l=this.rules[o],{body:p}=l,u=!this.superGrammar||!this.superGrammar.rules[o];let c;u?c="define":c=p instanceof te?"extend":"override";const h={};if(l.source&&this.source){const g=l.source.relativeTo(this.source);h.sourceInterval=[g.startIdx,g.endIdx]}const m=u?l.description:null,f=p.outputRecipe(l.formals,this.source);n[o]=[c,h,m,l.formals,f]});let i="null";e?i=e:this.superGrammar&&!this.superGrammar.isBuiltIn()&&(i=this.superGrammar.toRecipe());const a=[...["grammar",t,this.name].map(JSON.stringify),i,...[s,n].map(JSON.stringify)];return rr(`[${a.join(",")}]`)}toOperationActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()}toAttributeActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()}_toOperationOrAttributeActionDictionaryTemplate(){const e=new X;e.append("{");let t=!0;for(const s in this.rules){const{body:n}=this.rules[s];t?t=!1:e.append(","),e.append(`
`),e.append("  "),this.addSemanticActionTemplate(s,n,e)}return e.append(`
}`),e.contents()}addSemanticActionTemplate(e,t,s){s.append(e),s.append(": function(");const n=this._topDownActionArity(e);s.append(ee("_",n).join(", ")),s.append(`) {
`),s.append("  }")}parseApplication(e){let t;if(e.indexOf("<")===-1)t=new I(e);else{const n=at.match(e,"Base_application");t=ot(n,{})}if(!(t.ruleName in this.rules))throw Qe(t.ruleName,this.name);const{formals:s}=this.rules[t.ruleName];if(s.length!==t.args.length){const{source:n}=this.rules[t.ruleName];throw ze(t.ruleName,s.length,t.args.length,n)}return t}_setUpMatchState(e){this._matchStateInitializer&&this._matchStateInitializer(e)}}F.ProtoBuiltInRules=new F("ProtoBuiltInRules",void 0,{any:{body:b,formals:[],description:"any character",primitive:!0},end:{body:E,formals:[],description:"end of input",primitive:!0},caseInsensitive:{body:new Se(new w(0)),formals:["str"],primitive:!0},lower:{body:new _("Ll"),formals:[],description:"a lowercase letter",primitive:!0},upper:{body:new _("Lu"),formals:[],description:"an uppercase letter",primitive:!0},unicodeLtmo:{body:new _("Ltmo"),formals:[],description:"a Unicode character in Lt, Lm, or Lo",primitive:!0},spaces:{body:new Z(new I("space")),formals:[]},space:{body:new O("\0"," "),formals:[],description:"a space"}});F.initApplicationParser=function(r,e){at=r,ot=e};class De{constructor(e){this.name=e}sourceInterval(e,t){return this.source.subInterval(e,t-e)}ensureSuperGrammar(){return this.superGrammar||this.withSuperGrammar(this.name==="BuiltInRules"?F.ProtoBuiltInRules:F.BuiltInRules),this.superGrammar}ensureSuperGrammarRuleForOverriding(e,t){const s=this.ensureSuperGrammar().rules[e];if(!s)throw Nt(e,this.superGrammar.name,t);return s}installOverriddenOrExtendedRule(e,t,s,n){const i=he(t);if(i.length>0)throw Oe(e,i,n);const a=this.ensureSuperGrammar().rules[e],o=a.formals,l=o?o.length:0;if(t.length!==l)throw ze(e,l,t.length,n);return this.install(e,t,s,a.description,n)}install(e,t,s,n,i,a=!1){return this.rules[e]={body:s.introduceParams(t),formals:t,description:n,source:i,primitive:a},this}withSuperGrammar(e){if(this.superGrammar)throw new Error("the super grammar of a GrammarDecl cannot be set more than once");return this.superGrammar=e,this.rules=Object.create(e.rules),e.isBuiltIn()||(this.defaultStartRule=e.defaultStartRule),this}withDefaultStartRule(e){return this.defaultStartRule=e,this}withSource(e){return this.source=new ne(e).interval(0,e.length),this}build(){const e=new F(this.name,this.ensureSuperGrammar(),this.rules,this.defaultStartRule);e._matchStateInitializer=e.superGrammar._matchStateInitializer,e.supportsIncrementalParsing=e.superGrammar.supportsIncrementalParsing;const t=[];let s=!1;return Object.keys(e.rules).forEach(n=>{const{body:i}=e.rules[n];try{i.assertChoicesHaveUniformArity(n)}catch(a){t.push(a)}try{i.assertAllApplicationsAreValid(n,e)}catch(a){t.push(a),s=!0}}),s||Object.keys(e.rules).forEach(n=>{const{body:i}=e.rules[n];try{i.assertIteratedExprsAreNotNullable(e,[])}catch(a){t.push(a)}}),t.length>0&&Dt(t),this.source&&(e.source=this.source),e}define(e,t,s,n,i,a){if(this.ensureSuperGrammar(),this.superGrammar.rules[e])throw Ee(e,this.name,this.superGrammar.name,i);if(this.rules[e])throw Ee(e,this.name,this.name,i);const o=he(t);if(o.length>0)throw Oe(e,o,i);return this.install(e,t,s,n,i,a)}override(e,t,s,n,i){return this.ensureSuperGrammarRuleForOverriding(e,i),this.installOverriddenOrExtendedRule(e,t,s,i),this}extend(e,t,s,n,i){if(!this.ensureSuperGrammar().rules[e])throw bt(e,this.superGrammar.name,i);const o=new te(this.superGrammar,e,s);return o.source=s.source,this.installOverriddenOrExtendedRule(e,t,o,i),this}}class Y{constructor(){this.currentDecl=null,this.currentRuleName=null}newGrammar(e){return new De(e)}grammar(e,t,s,n,i){const a=new De(t);return s&&a.withSuperGrammar(s instanceof F?s:this.fromRecipe(s)),n&&a.withDefaultStartRule(n),e&&e.source&&a.withSource(e.source),this.currentDecl=a,Object.keys(i).forEach(o=>{this.currentRuleName=o;const l=i[o],p=l[0],u=l[1],c=l[2],h=l[3],m=this.fromRecipe(l[4]);let f;a.source&&u&&u.sourceInterval&&(f=a.source.subInterval(u.sourceInterval[0],u.sourceInterval[1]-u.sourceInterval[0])),a[p](o,h,m,c,f)}),this.currentRuleName=this.currentDecl=null,a.build()}terminal(e){return new A(e)}range(e,t){return new O(e,t)}param(e){return new w(e)}alt(...e){let t=[];for(let s of e)s instanceof d||(s=this.fromRecipe(s)),s instanceof x?t=t.concat(s.terms):t.push(s);return t.length===1?t[0]:new x(t)}seq(...e){let t=[];for(let s of e)s instanceof d||(s=this.fromRecipe(s)),s instanceof S?t=t.concat(s.factors):t.push(s);return t.length===1?t[0]:new S(t)}star(e){return e instanceof d||(e=this.fromRecipe(e)),new Z(e)}plus(e){return e instanceof d||(e=this.fromRecipe(e)),new V(e)}opt(e){return e instanceof d||(e=this.fromRecipe(e)),new B(e)}not(e){return e instanceof d||(e=this.fromRecipe(e)),new R(e)}lookahead(e){return e instanceof d||(e=this.fromRecipe(e)),new L(e)}lex(e){return e instanceof d||(e=this.fromRecipe(e)),new C(e)}app(e,t){return t&&t.length>0&&(t=t.map(function(s){return s instanceof d?s:this.fromRecipe(s)},this)),new I(e,t)}splice(e,t){return new re(this.currentDecl.superGrammar,this.currentRuleName,e.map(s=>this.fromRecipe(s)),t.map(s=>this.fromRecipe(s)))}fromRecipe(e){const t=e[0]==="grammar"?e.slice(1):e.slice(2),s=this[e[0]](...t),n=e[1];return n&&n.sourceInterval&&this.currentDecl&&s.withSource(this.currentDecl.sourceInterval(...n.sourceInterval)),s}}function se(r){return typeof r=="function"?r.call(new Y):(typeof r=="string"&&(r=JSON.parse(r)),new Y().fromRecipe(r))}const _e=se(["grammar",{source:`BuiltInRules {

  alnum  (an alpha-numeric character)
    = letter
    | digit

  letter  (a letter)
    = lower
    | upper
    | unicodeLtmo

  digit  (a digit)
    = "0".."9"

  hexDigit  (a hexadecimal digit)
    = digit
    | "a".."f"
    | "A".."F"

  ListOf<elem, sep>
    = NonemptyListOf<elem, sep>
    | EmptyListOf<elem, sep>

  NonemptyListOf<elem, sep>
    = elem (sep elem)*

  EmptyListOf<elem, sep>
    = /* nothing */

  listOf<elem, sep>
    = nonemptyListOf<elem, sep>
    | emptyListOf<elem, sep>

  nonemptyListOf<elem, sep>
    = elem (sep elem)*

  emptyListOf<elem, sep>
    = /* nothing */

  // Allows a syntactic rule application within a lexical context.
  applySyntactic<app> = app
}`},"BuiltInRules",null,null,{alnum:["define",{sourceInterval:[18,78]},"an alpha-numeric character",[],["alt",{sourceInterval:[60,78]},["app",{sourceInterval:[60,66]},"letter",[]],["app",{sourceInterval:[73,78]},"digit",[]]]],letter:["define",{sourceInterval:[82,142]},"a letter",[],["alt",{sourceInterval:[107,142]},["app",{sourceInterval:[107,112]},"lower",[]],["app",{sourceInterval:[119,124]},"upper",[]],["app",{sourceInterval:[131,142]},"unicodeLtmo",[]]]],digit:["define",{sourceInterval:[146,177]},"a digit",[],["range",{sourceInterval:[169,177]},"0","9"]],hexDigit:["define",{sourceInterval:[181,254]},"a hexadecimal digit",[],["alt",{sourceInterval:[219,254]},["app",{sourceInterval:[219,224]},"digit",[]],["range",{sourceInterval:[231,239]},"a","f"],["range",{sourceInterval:[246,254]},"A","F"]]],ListOf:["define",{sourceInterval:[258,336]},null,["elem","sep"],["alt",{sourceInterval:[282,336]},["app",{sourceInterval:[282,307]},"NonemptyListOf",[["param",{sourceInterval:[297,301]},0],["param",{sourceInterval:[303,306]},1]]],["app",{sourceInterval:[314,336]},"EmptyListOf",[["param",{sourceInterval:[326,330]},0],["param",{sourceInterval:[332,335]},1]]]]],NonemptyListOf:["define",{sourceInterval:[340,388]},null,["elem","sep"],["seq",{sourceInterval:[372,388]},["param",{sourceInterval:[372,376]},0],["star",{sourceInterval:[377,388]},["seq",{sourceInterval:[378,386]},["param",{sourceInterval:[378,381]},1],["param",{sourceInterval:[382,386]},0]]]]],EmptyListOf:["define",{sourceInterval:[392,434]},null,["elem","sep"],["seq",{sourceInterval:[438,438]}]],listOf:["define",{sourceInterval:[438,516]},null,["elem","sep"],["alt",{sourceInterval:[462,516]},["app",{sourceInterval:[462,487]},"nonemptyListOf",[["param",{sourceInterval:[477,481]},0],["param",{sourceInterval:[483,486]},1]]],["app",{sourceInterval:[494,516]},"emptyListOf",[["param",{sourceInterval:[506,510]},0],["param",{sourceInterval:[512,515]},1]]]]],nonemptyListOf:["define",{sourceInterval:[520,568]},null,["elem","sep"],["seq",{sourceInterval:[552,568]},["param",{sourceInterval:[552,556]},0],["star",{sourceInterval:[557,568]},["seq",{sourceInterval:[558,566]},["param",{sourceInterval:[558,561]},1],["param",{sourceInterval:[562,566]},0]]]]],emptyListOf:["define",{sourceInterval:[572,682]},null,["elem","sep"],["seq",{sourceInterval:[685,685]}]],applySyntactic:["define",{sourceInterval:[685,710]},null,["app"],["param",{sourceInterval:[707,710]},0]]}]);F.BuiltInRules=_e;qt(F.BuiltInRules);const lt=se(["grammar",{source:`Ohm {

  Grammars
    = Grammar*

  Grammar
    = ident SuperGrammar? "{" Rule* "}"

  SuperGrammar
    = "<:" ident

  Rule
    = ident Formals? ruleDescr? "="  RuleBody  -- define
    | ident Formals?            ":=" OverrideRuleBody  -- override
    | ident Formals?            "+=" RuleBody  -- extend

  RuleBody
    = "|"? NonemptyListOf<TopLevelTerm, "|">

  TopLevelTerm
    = Seq caseName  -- inline
    | Seq

  OverrideRuleBody
    = "|"? NonemptyListOf<OverrideTopLevelTerm, "|">

  OverrideTopLevelTerm
    = "..."  -- superSplice
    | TopLevelTerm

  Formals
    = "<" ListOf<ident, ","> ">"

  Params
    = "<" ListOf<Seq, ","> ">"

  Alt
    = NonemptyListOf<Seq, "|">

  Seq
    = Iter*

  Iter
    = Pred "*"  -- star
    | Pred "+"  -- plus
    | Pred "?"  -- opt
    | Pred

  Pred
    = "~" Lex  -- not
    | "&" Lex  -- lookahead
    | Lex

  Lex
    = "#" Base  -- lex
    | Base

  Base
    = ident Params? ~(ruleDescr? "=" | ":=" | "+=")  -- application
    | oneCharTerminal ".." oneCharTerminal           -- range
    | terminal                                       -- terminal
    | "(" Alt ")"                                    -- paren

  ruleDescr  (a rule description)
    = "(" ruleDescrText ")"

  ruleDescrText
    = (~")" any)*

  caseName
    = "--" (~"\\n" space)* name (~"\\n" space)* ("\\n" | &"}")

  name  (a name)
    = nameFirst nameRest*

  nameFirst
    = "_"
    | letter

  nameRest
    = "_"
    | alnum

  ident  (an identifier)
    = name

  terminal
    = "\\"" terminalChar* "\\""

  oneCharTerminal
    = "\\"" terminalChar "\\""

  terminalChar
    = escapeChar
      | ~"\\\\" ~"\\"" ~"\\n" "\\u{0}".."\\u{10FFFF}"

  escapeChar  (an escape sequence)
    = "\\\\\\\\"                                     -- backslash
    | "\\\\\\""                                     -- doubleQuote
    | "\\\\\\'"                                     -- singleQuote
    | "\\\\b"                                      -- backspace
    | "\\\\n"                                      -- lineFeed
    | "\\\\r"                                      -- carriageReturn
    | "\\\\t"                                      -- tab
    | "\\\\u{" hexDigit hexDigit? hexDigit?
             hexDigit? hexDigit? hexDigit? "}"   -- unicodeCodePoint
    | "\\\\u" hexDigit hexDigit hexDigit hexDigit  -- unicodeEscape
    | "\\\\x" hexDigit hexDigit                    -- hexEscape

  space
   += comment

  comment
    = "//" (~"\\n" any)* &("\\n" | end)  -- singleLine
    | "/*" (~"*/" any)* "*/"  -- multiLine

  tokens = token*

  token = caseName | comment | ident | operator | punctuation | terminal | any

  operator = "<:" | "=" | ":=" | "+=" | "*" | "+" | "?" | "~" | "&"

  punctuation = "<" | ">" | "," | "--"
}`},"Ohm",null,"Grammars",{Grammars:["define",{sourceInterval:[9,32]},null,[],["star",{sourceInterval:[24,32]},["app",{sourceInterval:[24,31]},"Grammar",[]]]],Grammar:["define",{sourceInterval:[36,83]},null,[],["seq",{sourceInterval:[50,83]},["app",{sourceInterval:[50,55]},"ident",[]],["opt",{sourceInterval:[56,69]},["app",{sourceInterval:[56,68]},"SuperGrammar",[]]],["terminal",{sourceInterval:[70,73]},"{"],["star",{sourceInterval:[74,79]},["app",{sourceInterval:[74,78]},"Rule",[]]],["terminal",{sourceInterval:[80,83]},"}"]]],SuperGrammar:["define",{sourceInterval:[87,116]},null,[],["seq",{sourceInterval:[106,116]},["terminal",{sourceInterval:[106,110]},"<:"],["app",{sourceInterval:[111,116]},"ident",[]]]],Rule_define:["define",{sourceInterval:[131,181]},null,[],["seq",{sourceInterval:[131,170]},["app",{sourceInterval:[131,136]},"ident",[]],["opt",{sourceInterval:[137,145]},["app",{sourceInterval:[137,144]},"Formals",[]]],["opt",{sourceInterval:[146,156]},["app",{sourceInterval:[146,155]},"ruleDescr",[]]],["terminal",{sourceInterval:[157,160]},"="],["app",{sourceInterval:[162,170]},"RuleBody",[]]]],Rule_override:["define",{sourceInterval:[188,248]},null,[],["seq",{sourceInterval:[188,235]},["app",{sourceInterval:[188,193]},"ident",[]],["opt",{sourceInterval:[194,202]},["app",{sourceInterval:[194,201]},"Formals",[]]],["terminal",{sourceInterval:[214,218]},":="],["app",{sourceInterval:[219,235]},"OverrideRuleBody",[]]]],Rule_extend:["define",{sourceInterval:[255,305]},null,[],["seq",{sourceInterval:[255,294]},["app",{sourceInterval:[255,260]},"ident",[]],["opt",{sourceInterval:[261,269]},["app",{sourceInterval:[261,268]},"Formals",[]]],["terminal",{sourceInterval:[281,285]},"+="],["app",{sourceInterval:[286,294]},"RuleBody",[]]]],Rule:["define",{sourceInterval:[120,305]},null,[],["alt",{sourceInterval:[131,305]},["app",{sourceInterval:[131,170]},"Rule_define",[]],["app",{sourceInterval:[188,235]},"Rule_override",[]],["app",{sourceInterval:[255,294]},"Rule_extend",[]]]],RuleBody:["define",{sourceInterval:[309,362]},null,[],["seq",{sourceInterval:[324,362]},["opt",{sourceInterval:[324,328]},["terminal",{sourceInterval:[324,327]},"|"]],["app",{sourceInterval:[329,362]},"NonemptyListOf",[["app",{sourceInterval:[344,356]},"TopLevelTerm",[]],["terminal",{sourceInterval:[358,361]},"|"]]]]],TopLevelTerm_inline:["define",{sourceInterval:[385,408]},null,[],["seq",{sourceInterval:[385,397]},["app",{sourceInterval:[385,388]},"Seq",[]],["app",{sourceInterval:[389,397]},"caseName",[]]]],TopLevelTerm:["define",{sourceInterval:[366,418]},null,[],["alt",{sourceInterval:[385,418]},["app",{sourceInterval:[385,397]},"TopLevelTerm_inline",[]],["app",{sourceInterval:[415,418]},"Seq",[]]]],OverrideRuleBody:["define",{sourceInterval:[422,491]},null,[],["seq",{sourceInterval:[445,491]},["opt",{sourceInterval:[445,449]},["terminal",{sourceInterval:[445,448]},"|"]],["app",{sourceInterval:[450,491]},"NonemptyListOf",[["app",{sourceInterval:[465,485]},"OverrideTopLevelTerm",[]],["terminal",{sourceInterval:[487,490]},"|"]]]]],OverrideTopLevelTerm_superSplice:["define",{sourceInterval:[522,543]},null,[],["terminal",{sourceInterval:[522,527]},"..."]],OverrideTopLevelTerm:["define",{sourceInterval:[495,562]},null,[],["alt",{sourceInterval:[522,562]},["app",{sourceInterval:[522,527]},"OverrideTopLevelTerm_superSplice",[]],["app",{sourceInterval:[550,562]},"TopLevelTerm",[]]]],Formals:["define",{sourceInterval:[566,606]},null,[],["seq",{sourceInterval:[580,606]},["terminal",{sourceInterval:[580,583]},"<"],["app",{sourceInterval:[584,602]},"ListOf",[["app",{sourceInterval:[591,596]},"ident",[]],["terminal",{sourceInterval:[598,601]},","]]],["terminal",{sourceInterval:[603,606]},">"]]],Params:["define",{sourceInterval:[610,647]},null,[],["seq",{sourceInterval:[623,647]},["terminal",{sourceInterval:[623,626]},"<"],["app",{sourceInterval:[627,643]},"ListOf",[["app",{sourceInterval:[634,637]},"Seq",[]],["terminal",{sourceInterval:[639,642]},","]]],["terminal",{sourceInterval:[644,647]},">"]]],Alt:["define",{sourceInterval:[651,685]},null,[],["app",{sourceInterval:[661,685]},"NonemptyListOf",[["app",{sourceInterval:[676,679]},"Seq",[]],["terminal",{sourceInterval:[681,684]},"|"]]]],Seq:["define",{sourceInterval:[689,704]},null,[],["star",{sourceInterval:[699,704]},["app",{sourceInterval:[699,703]},"Iter",[]]]],Iter_star:["define",{sourceInterval:[719,736]},null,[],["seq",{sourceInterval:[719,727]},["app",{sourceInterval:[719,723]},"Pred",[]],["terminal",{sourceInterval:[724,727]},"*"]]],Iter_plus:["define",{sourceInterval:[743,760]},null,[],["seq",{sourceInterval:[743,751]},["app",{sourceInterval:[743,747]},"Pred",[]],["terminal",{sourceInterval:[748,751]},"+"]]],Iter_opt:["define",{sourceInterval:[767,783]},null,[],["seq",{sourceInterval:[767,775]},["app",{sourceInterval:[767,771]},"Pred",[]],["terminal",{sourceInterval:[772,775]},"?"]]],Iter:["define",{sourceInterval:[708,794]},null,[],["alt",{sourceInterval:[719,794]},["app",{sourceInterval:[719,727]},"Iter_star",[]],["app",{sourceInterval:[743,751]},"Iter_plus",[]],["app",{sourceInterval:[767,775]},"Iter_opt",[]],["app",{sourceInterval:[790,794]},"Pred",[]]]],Pred_not:["define",{sourceInterval:[809,824]},null,[],["seq",{sourceInterval:[809,816]},["terminal",{sourceInterval:[809,812]},"~"],["app",{sourceInterval:[813,816]},"Lex",[]]]],Pred_lookahead:["define",{sourceInterval:[831,852]},null,[],["seq",{sourceInterval:[831,838]},["terminal",{sourceInterval:[831,834]},"&"],["app",{sourceInterval:[835,838]},"Lex",[]]]],Pred:["define",{sourceInterval:[798,862]},null,[],["alt",{sourceInterval:[809,862]},["app",{sourceInterval:[809,816]},"Pred_not",[]],["app",{sourceInterval:[831,838]},"Pred_lookahead",[]],["app",{sourceInterval:[859,862]},"Lex",[]]]],Lex_lex:["define",{sourceInterval:[876,892]},null,[],["seq",{sourceInterval:[876,884]},["terminal",{sourceInterval:[876,879]},"#"],["app",{sourceInterval:[880,884]},"Base",[]]]],Lex:["define",{sourceInterval:[866,903]},null,[],["alt",{sourceInterval:[876,903]},["app",{sourceInterval:[876,884]},"Lex_lex",[]],["app",{sourceInterval:[899,903]},"Base",[]]]],Base_application:["define",{sourceInterval:[918,979]},null,[],["seq",{sourceInterval:[918,963]},["app",{sourceInterval:[918,923]},"ident",[]],["opt",{sourceInterval:[924,931]},["app",{sourceInterval:[924,930]},"Params",[]]],["not",{sourceInterval:[932,963]},["alt",{sourceInterval:[934,962]},["seq",{sourceInterval:[934,948]},["opt",{sourceInterval:[934,944]},["app",{sourceInterval:[934,943]},"ruleDescr",[]]],["terminal",{sourceInterval:[945,948]},"="]],["terminal",{sourceInterval:[951,955]},":="],["terminal",{sourceInterval:[958,962]},"+="]]]]],Base_range:["define",{sourceInterval:[986,1041]},null,[],["seq",{sourceInterval:[986,1022]},["app",{sourceInterval:[986,1001]},"oneCharTerminal",[]],["terminal",{sourceInterval:[1002,1006]},".."],["app",{sourceInterval:[1007,1022]},"oneCharTerminal",[]]]],Base_terminal:["define",{sourceInterval:[1048,1106]},null,[],["app",{sourceInterval:[1048,1056]},"terminal",[]]],Base_paren:["define",{sourceInterval:[1113,1168]},null,[],["seq",{sourceInterval:[1113,1124]},["terminal",{sourceInterval:[1113,1116]},"("],["app",{sourceInterval:[1117,1120]},"Alt",[]],["terminal",{sourceInterval:[1121,1124]},")"]]],Base:["define",{sourceInterval:[907,1168]},null,[],["alt",{sourceInterval:[918,1168]},["app",{sourceInterval:[918,963]},"Base_application",[]],["app",{sourceInterval:[986,1022]},"Base_range",[]],["app",{sourceInterval:[1048,1056]},"Base_terminal",[]],["app",{sourceInterval:[1113,1124]},"Base_paren",[]]]],ruleDescr:["define",{sourceInterval:[1172,1231]},"a rule description",[],["seq",{sourceInterval:[1210,1231]},["terminal",{sourceInterval:[1210,1213]},"("],["app",{sourceInterval:[1214,1227]},"ruleDescrText",[]],["terminal",{sourceInterval:[1228,1231]},")"]]],ruleDescrText:["define",{sourceInterval:[1235,1266]},null,[],["star",{sourceInterval:[1255,1266]},["seq",{sourceInterval:[1256,1264]},["not",{sourceInterval:[1256,1260]},["terminal",{sourceInterval:[1257,1260]},")"]],["app",{sourceInterval:[1261,1264]},"any",[]]]]],caseName:["define",{sourceInterval:[1270,1338]},null,[],["seq",{sourceInterval:[1285,1338]},["terminal",{sourceInterval:[1285,1289]},"--"],["star",{sourceInterval:[1290,1304]},["seq",{sourceInterval:[1291,1302]},["not",{sourceInterval:[1291,1296]},["terminal",{sourceInterval:[1292,1296]},`
`]],["app",{sourceInterval:[1297,1302]},"space",[]]]],["app",{sourceInterval:[1305,1309]},"name",[]],["star",{sourceInterval:[1310,1324]},["seq",{sourceInterval:[1311,1322]},["not",{sourceInterval:[1311,1316]},["terminal",{sourceInterval:[1312,1316]},`
`]],["app",{sourceInterval:[1317,1322]},"space",[]]]],["alt",{sourceInterval:[1326,1337]},["terminal",{sourceInterval:[1326,1330]},`
`],["lookahead",{sourceInterval:[1333,1337]},["terminal",{sourceInterval:[1334,1337]},"}"]]]]],name:["define",{sourceInterval:[1342,1382]},"a name",[],["seq",{sourceInterval:[1363,1382]},["app",{sourceInterval:[1363,1372]},"nameFirst",[]],["star",{sourceInterval:[1373,1382]},["app",{sourceInterval:[1373,1381]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[1386,1418]},null,[],["alt",{sourceInterval:[1402,1418]},["terminal",{sourceInterval:[1402,1405]},"_"],["app",{sourceInterval:[1412,1418]},"letter",[]]]],nameRest:["define",{sourceInterval:[1422,1452]},null,[],["alt",{sourceInterval:[1437,1452]},["terminal",{sourceInterval:[1437,1440]},"_"],["app",{sourceInterval:[1447,1452]},"alnum",[]]]],ident:["define",{sourceInterval:[1456,1489]},"an identifier",[],["app",{sourceInterval:[1485,1489]},"name",[]]],terminal:["define",{sourceInterval:[1493,1531]},null,[],["seq",{sourceInterval:[1508,1531]},["terminal",{sourceInterval:[1508,1512]},'"'],["star",{sourceInterval:[1513,1526]},["app",{sourceInterval:[1513,1525]},"terminalChar",[]]],["terminal",{sourceInterval:[1527,1531]},'"']]],oneCharTerminal:["define",{sourceInterval:[1535,1579]},null,[],["seq",{sourceInterval:[1557,1579]},["terminal",{sourceInterval:[1557,1561]},'"'],["app",{sourceInterval:[1562,1574]},"terminalChar",[]],["terminal",{sourceInterval:[1575,1579]},'"']]],terminalChar:["define",{sourceInterval:[1583,1660]},null,[],["alt",{sourceInterval:[1602,1660]},["app",{sourceInterval:[1602,1612]},"escapeChar",[]],["seq",{sourceInterval:[1621,1660]},["not",{sourceInterval:[1621,1626]},["terminal",{sourceInterval:[1622,1626]},"\\"]],["not",{sourceInterval:[1627,1632]},["terminal",{sourceInterval:[1628,1632]},'"']],["not",{sourceInterval:[1633,1638]},["terminal",{sourceInterval:[1634,1638]},`
`]],["range",{sourceInterval:[1639,1660]},"\0","􏿿"]]]],escapeChar_backslash:["define",{sourceInterval:[1703,1758]},null,[],["terminal",{sourceInterval:[1703,1709]},"\\\\"]],escapeChar_doubleQuote:["define",{sourceInterval:[1765,1822]},null,[],["terminal",{sourceInterval:[1765,1771]},'\\"']],escapeChar_singleQuote:["define",{sourceInterval:[1829,1886]},null,[],["terminal",{sourceInterval:[1829,1835]},"\\'"]],escapeChar_backspace:["define",{sourceInterval:[1893,1948]},null,[],["terminal",{sourceInterval:[1893,1898]},"\\b"]],escapeChar_lineFeed:["define",{sourceInterval:[1955,2009]},null,[],["terminal",{sourceInterval:[1955,1960]},"\\n"]],escapeChar_carriageReturn:["define",{sourceInterval:[2016,2076]},null,[],["terminal",{sourceInterval:[2016,2021]},"\\r"]],escapeChar_tab:["define",{sourceInterval:[2083,2132]},null,[],["terminal",{sourceInterval:[2083,2088]},"\\t"]],escapeChar_unicodeCodePoint:["define",{sourceInterval:[2139,2243]},null,[],["seq",{sourceInterval:[2139,2221]},["terminal",{sourceInterval:[2139,2145]},"\\u{"],["app",{sourceInterval:[2146,2154]},"hexDigit",[]],["opt",{sourceInterval:[2155,2164]},["app",{sourceInterval:[2155,2163]},"hexDigit",[]]],["opt",{sourceInterval:[2165,2174]},["app",{sourceInterval:[2165,2173]},"hexDigit",[]]],["opt",{sourceInterval:[2188,2197]},["app",{sourceInterval:[2188,2196]},"hexDigit",[]]],["opt",{sourceInterval:[2198,2207]},["app",{sourceInterval:[2198,2206]},"hexDigit",[]]],["opt",{sourceInterval:[2208,2217]},["app",{sourceInterval:[2208,2216]},"hexDigit",[]]],["terminal",{sourceInterval:[2218,2221]},"}"]]],escapeChar_unicodeEscape:["define",{sourceInterval:[2250,2309]},null,[],["seq",{sourceInterval:[2250,2291]},["terminal",{sourceInterval:[2250,2255]},"\\u"],["app",{sourceInterval:[2256,2264]},"hexDigit",[]],["app",{sourceInterval:[2265,2273]},"hexDigit",[]],["app",{sourceInterval:[2274,2282]},"hexDigit",[]],["app",{sourceInterval:[2283,2291]},"hexDigit",[]]]],escapeChar_hexEscape:["define",{sourceInterval:[2316,2371]},null,[],["seq",{sourceInterval:[2316,2339]},["terminal",{sourceInterval:[2316,2321]},"\\x"],["app",{sourceInterval:[2322,2330]},"hexDigit",[]],["app",{sourceInterval:[2331,2339]},"hexDigit",[]]]],escapeChar:["define",{sourceInterval:[1664,2371]},"an escape sequence",[],["alt",{sourceInterval:[1703,2371]},["app",{sourceInterval:[1703,1709]},"escapeChar_backslash",[]],["app",{sourceInterval:[1765,1771]},"escapeChar_doubleQuote",[]],["app",{sourceInterval:[1829,1835]},"escapeChar_singleQuote",[]],["app",{sourceInterval:[1893,1898]},"escapeChar_backspace",[]],["app",{sourceInterval:[1955,1960]},"escapeChar_lineFeed",[]],["app",{sourceInterval:[2016,2021]},"escapeChar_carriageReturn",[]],["app",{sourceInterval:[2083,2088]},"escapeChar_tab",[]],["app",{sourceInterval:[2139,2221]},"escapeChar_unicodeCodePoint",[]],["app",{sourceInterval:[2250,2291]},"escapeChar_unicodeEscape",[]],["app",{sourceInterval:[2316,2339]},"escapeChar_hexEscape",[]]]],space:["extend",{sourceInterval:[2375,2394]},null,[],["app",{sourceInterval:[2387,2394]},"comment",[]]],comment_singleLine:["define",{sourceInterval:[2412,2458]},null,[],["seq",{sourceInterval:[2412,2443]},["terminal",{sourceInterval:[2412,2416]},"//"],["star",{sourceInterval:[2417,2429]},["seq",{sourceInterval:[2418,2427]},["not",{sourceInterval:[2418,2423]},["terminal",{sourceInterval:[2419,2423]},`
`]],["app",{sourceInterval:[2424,2427]},"any",[]]]],["lookahead",{sourceInterval:[2430,2443]},["alt",{sourceInterval:[2432,2442]},["terminal",{sourceInterval:[2432,2436]},`
`],["app",{sourceInterval:[2439,2442]},"end",[]]]]]],comment_multiLine:["define",{sourceInterval:[2465,2501]},null,[],["seq",{sourceInterval:[2465,2487]},["terminal",{sourceInterval:[2465,2469]},"/*"],["star",{sourceInterval:[2470,2482]},["seq",{sourceInterval:[2471,2480]},["not",{sourceInterval:[2471,2476]},["terminal",{sourceInterval:[2472,2476]},"*/"]],["app",{sourceInterval:[2477,2480]},"any",[]]]],["terminal",{sourceInterval:[2483,2487]},"*/"]]],comment:["define",{sourceInterval:[2398,2501]},null,[],["alt",{sourceInterval:[2412,2501]},["app",{sourceInterval:[2412,2443]},"comment_singleLine",[]],["app",{sourceInterval:[2465,2487]},"comment_multiLine",[]]]],tokens:["define",{sourceInterval:[2505,2520]},null,[],["star",{sourceInterval:[2514,2520]},["app",{sourceInterval:[2514,2519]},"token",[]]]],token:["define",{sourceInterval:[2524,2600]},null,[],["alt",{sourceInterval:[2532,2600]},["app",{sourceInterval:[2532,2540]},"caseName",[]],["app",{sourceInterval:[2543,2550]},"comment",[]],["app",{sourceInterval:[2553,2558]},"ident",[]],["app",{sourceInterval:[2561,2569]},"operator",[]],["app",{sourceInterval:[2572,2583]},"punctuation",[]],["app",{sourceInterval:[2586,2594]},"terminal",[]],["app",{sourceInterval:[2597,2600]},"any",[]]]],operator:["define",{sourceInterval:[2604,2669]},null,[],["alt",{sourceInterval:[2615,2669]},["terminal",{sourceInterval:[2615,2619]},"<:"],["terminal",{sourceInterval:[2622,2625]},"="],["terminal",{sourceInterval:[2628,2632]},":="],["terminal",{sourceInterval:[2635,2639]},"+="],["terminal",{sourceInterval:[2642,2645]},"*"],["terminal",{sourceInterval:[2648,2651]},"+"],["terminal",{sourceInterval:[2654,2657]},"?"],["terminal",{sourceInterval:[2660,2663]},"~"],["terminal",{sourceInterval:[2666,2669]},"&"]]],punctuation:["define",{sourceInterval:[2673,2709]},null,[],["alt",{sourceInterval:[2687,2709]},["terminal",{sourceInterval:[2687,2690]},"<"],["terminal",{sourceInterval:[2693,2696]},">"],["terminal",{sourceInterval:[2699,2702]},","],["terminal",{sourceInterval:[2705,2709]},"--"]]]}]),oe=Object.create(d.prototype);function Me(r,e){for(const t in r)if(t===e)return!0;return!1}function nr(r,e,t){const s=new Y;let n,i,a,o=!1;return(t||lt).createSemantics().addOperation("visit",{Grammars(u){return u.children.map(c=>c.visit())},Grammar(u,c,h,m,f){const g=u.visit();n=s.newGrammar(g),c.child(0)&&c.child(0).visit(),m.children.map(q=>q.visit());const y=n.build();if(y.source=this.source.trimmed(),Me(e,g))throw _t(y);return e[g]=y,y},SuperGrammar(u,c){const h=c.visit();if(h==="null")n.withSuperGrammar(null);else{if(!e||!Me(e,h))throw St(h,e,c.source);n.withSuperGrammar(e[h])}},Rule_define(u,c,h,m,f){i=u.visit(),a=c.children.map(W=>W.visit())[0]||[],!n.defaultStartRule&&n.ensureSuperGrammar()!==F.ProtoBuiltInRules&&n.withDefaultStartRule(i);const g=f.visit(),y=h.children.map(W=>W.visit())[0],q=this.source.trimmed();return n.define(i,a,g,y,q)},Rule_override(u,c,h,m){i=u.visit(),a=c.children.map(y=>y.visit())[0]||[];const f=this.source.trimmed();n.ensureSuperGrammarRuleForOverriding(i,f),o=!0;const g=m.visit();return o=!1,n.override(i,a,g,null,f)},Rule_extend(u,c,h,m){i=u.visit(),a=c.children.map(y=>y.visit())[0]||[];const f=m.visit(),g=this.source.trimmed();return n.extend(i,a,f,null,g)},RuleBody(u,c){return s.alt(...c.visit()).withSource(this.source)},OverrideRuleBody(u,c){const h=c.visit(),m=h.indexOf(oe);if(m>=0){const f=h.slice(0,m),g=h.slice(m+1);return g.forEach(y=>{if(y===oe)throw Rt(y)}),new re(n.superGrammar,i,f,g).withSource(this.source)}else return s.alt(...h).withSource(this.source)},Formals(u,c,h){return c.visit()},Params(u,c,h){return c.visit()},Alt(u){return s.alt(...u.visit()).withSource(this.source)},TopLevelTerm_inline(u,c){const h=i+"_"+c.visit(),m=u.visit(),f=this.source.trimmed(),g=!(n.superGrammar&&n.superGrammar.rules[h]);o&&!g?n.override(h,a,m,null,f):n.define(h,a,m,null,f);const y=a.map(q=>s.app(q));return s.app(h,y).withSource(m.source)},OverrideTopLevelTerm_superSplice(u){return oe},Seq(u){return s.seq(...u.children.map(c=>c.visit())).withSource(this.source)},Iter_star(u,c){return s.star(u.visit()).withSource(this.source)},Iter_plus(u,c){return s.plus(u.visit()).withSource(this.source)},Iter_opt(u,c){return s.opt(u.visit()).withSource(this.source)},Pred_not(u,c){return s.not(c.visit()).withSource(this.source)},Pred_lookahead(u,c){return s.lookahead(c.visit()).withSource(this.source)},Lex_lex(u,c){return s.lex(c.visit()).withSource(this.source)},Base_application(u,c){const h=c.children.map(m=>m.visit())[0]||[];return s.app(u.visit(),h).withSource(this.source)},Base_range(u,c,h){return s.range(u.visit(),h.visit()).withSource(this.source)},Base_terminal(u){return s.terminal(u.visit()).withSource(this.source)},Base_paren(u,c,h){return c.visit()},ruleDescr(u,c,h){return c.visit()},ruleDescrText(u){return this.sourceString.trim()},caseName(u,c,h,m,f){return h.visit()},name(u,c){return this.sourceString},nameFirst(u){},nameRest(u){},terminal(u,c,h){return c.children.map(m=>m.visit()).join("")},oneCharTerminal(u,c,h){return c.visit()},escapeChar(u){try{return Ve(this.sourceString)}catch(c){throw c instanceof RangeError&&c.message.startsWith("Invalid code point ")?Lt(u):c}},NonemptyListOf(u,c,h){return[u.visit()].concat(h.children.map(m=>m.visit()))},EmptyListOf(){return[]},_terminal(){return this.sourceString}})(r).visit()}const sr=se(["grammar",{source:`OperationsAndAttributes {

  AttributeSignature =
    name

  OperationSignature =
    name Formals?

  Formals
    = "(" ListOf<name, ","> ")"

  name  (a name)
    = nameFirst nameRest*

  nameFirst
    = "_"
    | letter

  nameRest
    = "_"
    | alnum

}`},"OperationsAndAttributes",null,"AttributeSignature",{AttributeSignature:["define",{sourceInterval:[29,58]},null,[],["app",{sourceInterval:[54,58]},"name",[]]],OperationSignature:["define",{sourceInterval:[62,100]},null,[],["seq",{sourceInterval:[87,100]},["app",{sourceInterval:[87,91]},"name",[]],["opt",{sourceInterval:[92,100]},["app",{sourceInterval:[92,99]},"Formals",[]]]]],Formals:["define",{sourceInterval:[104,143]},null,[],["seq",{sourceInterval:[118,143]},["terminal",{sourceInterval:[118,121]},"("],["app",{sourceInterval:[122,139]},"ListOf",[["app",{sourceInterval:[129,133]},"name",[]],["terminal",{sourceInterval:[135,138]},","]]],["terminal",{sourceInterval:[140,143]},")"]]],name:["define",{sourceInterval:[147,187]},"a name",[],["seq",{sourceInterval:[168,187]},["app",{sourceInterval:[168,177]},"nameFirst",[]],["star",{sourceInterval:[178,187]},["app",{sourceInterval:[178,186]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[191,223]},null,[],["alt",{sourceInterval:[207,223]},["terminal",{sourceInterval:[207,210]},"_"],["app",{sourceInterval:[217,223]},"letter",[]]]],nameRest:["define",{sourceInterval:[227,257]},null,[],["alt",{sourceInterval:[242,257]},["terminal",{sourceInterval:[242,245]},"_"],["app",{sourceInterval:[252,257]},"alnum",[]]]]}]);ir(F.BuiltInRules);ar(sr);function ir(r){const e={empty(){return this.iteration()},nonEmpty(t,s,n){return this.iteration([t].concat(n.children))}};P.BuiltInSemantics=P.createSemantics(r,null).addOperation("asIteration",{emptyListOf:e.empty,nonemptyListOf:e.nonEmpty,EmptyListOf:e.empty,NonemptyListOf:e.nonEmpty})}function ar(r){P.prototypeGrammarSemantics=r.createSemantics().addOperation("parse",{AttributeSignature(e){return{name:e.parse(),formals:[]}},OperationSignature(e,t){return{name:e.parse(),formals:t.children.map(s=>s.parse())[0]||[]}},Formals(e,t,s){return t.asIteration().children.map(n=>n.parse())},name(e,t){return this.sourceString}}),P.prototypeGrammar=r}function or(r){let e=0;const t=[0],s=()=>t[t.length-1],n={},i=/( *).*(?:$|\r?\n|\r)/g;let a;for(;(a=i.exec(r))!=null;){const[o,l]=a;if(o.length===0)break;const p=l.length,u=s(),c=e+p;if(p>u)t.push(p),n[c]=1;else if(p<u){const h=t.length;for(;s()!==p;)t.pop();n[c]=-1*(h-t.length)}e+=o.length}return t.length>1&&(n[e]=1-t.length),n}const ut="an indented block",ct="a dedent",ke=1114112;class lr extends ne{constructor(e){super(e.input),this.state=e}_indentationAt(e){return this.state.userData[e]||0}atEnd(){return super.atEnd()&&this._indentationAt(this.pos)===0}next(){if(this._indentationAt(this.pos)!==0){this.examinedLength=Math.max(this.examinedLength,this.pos);return}return super.next()}nextCharCode(){return this._indentationAt(this.pos)!==0?(this.examinedLength=Math.max(this.examinedLength,this.pos),ke):super.nextCharCode()}nextCodePoint(){return this._indentationAt(this.pos)!==0?(this.examinedLength=Math.max(this.examinedLength,this.pos),ke):super.nextCodePoint()}}class qe extends d{constructor(e=!0){super(),this.isIndent=e}allowsSkippingPrecedingSpace(){return!0}eval(e){const{inputStream:t}=e,s=e.userData;e.doNotMemoize=!0;const n=t.pos,i=this.isIndent?1:-1;return(s[n]||0)*i>0?(e.userData=Object.create(s),e.userData[n]-=i,e.pushBinding(new K(0),n),!0):(e.processFailure(n,this),!1)}getArity(){return 1}_assertAllApplicationsAreValid(e,t){}_isNullable(e,t){return!1}assertChoicesHaveUniformArity(e){}assertIteratedExprsAreNotNullable(e){}introduceParams(e){return this}substituteParams(e){return this}toString(){return this.isIndent?"indent":"dedent"}toDisplayString(){return this.toString()}toFailure(e){const t=this.isIndent?ut:ct;return new D(this,t,"description")}}const ur=new I("indent"),cr=new I("dedent"),pr=new re(_e,"any",[ur,cr],[]),hr=new Y().newGrammar("IndentationSensitive").withSuperGrammar(_e).define("indent",[],new qe(!0),ut,void 0,!0).define("dedent",[],new qe(!1),ct,void 0,!0).extend("any",[],pr,"any character",void 0).build();Object.assign(hr,{_matchStateInitializer(r){r.userData=or(r.input),r.inputStream=new lr(r)},supportsIncrementalParsing:!1});F.initApplicationParser(lt,nr);const Be=se(["grammar",{source:`MAIN {\r
\r
  Program = (Gcode | Macro)*\r
\r
  Gcode = (CRC | InterpolationMotion | StockRemovalCycle | GroovingCycle | ThreadingCycle | G32 | G90 | G94 | FUN_DIVS)+\r
\r
  StockRemovalCycle = G71 | G72 | G73\r
  G70 = N? "G70" P Q F?\r
  G71 = N? ("G71" U R)   N? ("G71" P Q X Z F?) CycleBody\r
  G72 = N? ("G72" W R)   N? ("G72" P Q X Z F?) CycleBody\r
  G73 = N? ("G73" U W R) N? ("G73" P Q X Z F?) CycleBody\r
\r
  //------------------------------------------------------------------\r
\r
  // CycleBody = N InterpolationMotion  (InterpolationMotion)+ N InterpolationMotion\r
  CycleBody = InterpolationMotion+\r
\r
  GroovingCycle = G74 | G75\r
  G74 = N? ("G74" R) N? ("G74" P Q X Z F?)\r
  G75 = N? ("G75" R) N? ("G75" P Q X Z F?)\r
\r
  ThreadingCycle = G92 | G76\r
  G92 = N? ("G92" P Q R) N? ("G92" P Q X Z F?)\r
  G76 = N? ("G76" P Q R) N? ("G76" P Q X Z F?)\r
\r
  //------------------------------------------------------------------\r
  \r
  G32 = "G32"? ((X Z)|(U W)) F? --XZF\r
      | "G32"? (X | Z | U | W) F? --XF\r
\r
  G90 = N? ("G90" P Q R) N?  ("G90" P Q X Z F?)\r
  G94 = N? ("G94" P Q R) N?  ("G94" P Q X Z F?)\r
\r
  InterpolationMotion = (G3 | G2) -- arc\r
                      | (G1 | G0) -- line\r
  \r
  CRC = G40 | G41 | G42\r
  G40 = N? "G40" InterpolationMotion_line?\r
  G41 = N? "G41" InterpolationMotion_line?\r
  G42 = N? "G42" InterpolationMotion_line?\r
\r
  //------------------------------------------------------------------\r
\r
  G0 = N? "G0"? SingleOrDoubleAsix\r
  G1 = N? "G1"? SingleOrDoubleAsix (comma Chamfer)? F?\r
  G2 = N? "G2"? DoubleAsix (ArcOfCenterOffsets | ArcOfRadius) F?\r
  G3 = N? "G3"? DoubleAsix (ArcOfCenterOffsets | ArcOfRadius) F?\r
\r
  //------------------------------------------------------------------\r
\r
  ArcOfCenterOffsets = I K\r
  ArcOfRadius = R\r
  SingleOrDoubleAsix = DoubleAsix | SingleAsix\r
  DoubleAsix = (X Z) | (U W) | (Z X) | (W U)\r
  SingleAsix  = X | Z | U | W\r
  Chamfer = C | A | R\r
\r
  FUN_DIVS = N? (T | S | M)\r
  // FUN_DIVS = O | T | S | M | N\r
\r
\r
  space += comment\r
  comment =  "(" (~(")"|"(") any)* ")"\r
\r
  //------------------------------------------------------------------\r
\r
  X = "X" float        -- num\r
    | "X" PriExp       -- exp\r
    // | "X" (PriExp_paren | PriExp_var) -- exp\r
  Z = "Z" float        -- num\r
    | "Z" PriExp       -- exp\r
  U = "U" float        -- num\r
    | "U" PriExp_paren -- exp\r
  W = "W" float        -- num\r
    | "W" PriExp_paren -- exp\r
\r
  F = "F" float        -- num\r
    | "F" PriExp_paren -- exp\r
  A = "A" float        -- num\r
    | "A" PriExp_paren -- exp\r
  C = "C" float        -- num\r
    | "C" PriExp_paren -- exp\r
  R = "R" float        -- num\r
    | "R" PriExp_paren -- exp\r
  I = "I" float        -- num\r
    | "I" PriExp_paren -- exp\r
  K = "K" float        -- num\r
    | "K" PriExp_paren -- exp\r
\r
  //------------------------------------------------------------------\r
\r
  O = "O" int\r
  T = "T" int\r
  S = "S" int\r
  M = "M" int\r
  N = "N" int\r
  P = "P" int\r
  Q = "Q" int\r
\r
\r
  comma = ","\r
\r
\r
  //------------------------------------------------------------------\r
  //------------------------------------------------------------------\r
\r
\r
  Macro = N? (Statement | VarDecl | Exp)+\r
  Statement = GOTO | IF_GOTO | IF_THEN | WHILE_DO\r
\r
\r
  //------------------------------------------------------------------\r
\r
  GOTO = "GOTO" int+\r
  //\r
  IF = IF_GOTO | IF_THEN\r
  IF_GOTO = "IF" ComExp GOTO\r
  IF_THEN = "IF" ComExp "THEN" VarDecl\r
  //\r
  WHILE = WHILE_DO\r
  WHILE_DO      = "WHILE" ComExp "DO" ("1"|"2"|"3") (IF|GOTO|WHILE|VarDecl)* "END" ("1"|"2"|"3") \r
  //WHILE_DO_GOTO = "WHILE" ComExp "DO" GOTO ("1"|"2"|"3") (IF|GOTO|WHILE|VarDecl)* "END" ("1"|"2"|"3") \r
\r
  //------------------------------------------------------------------\r
  //------------------------------------------------------------------\r
\r
  Exp = AddExp | LogExp | ComExp\r
\r
  //-------------------------------------------------------------------\r
\r
  AddExp\r
  = AddExp "+" MulExp  -- plus\r
  | AddExp "-" MulExp  -- minus\r
  | MulExp\r
  //\r
  MulExp\r
  = MulExp "*" ExpExp  -- times\r
  | MulExp "/" ExpExp  -- divide\r
  | ExpExp\r
  //\r
  Funtion = funtion_identifier "[" AddExp "]"\r
  //\r
  ExpExp = PriExp funtion_identifier ExpExp  -- fun\r
  			 | PriExp\r
  //\r
  PriExp = "[" Exp "]"  -- paren\r
      // | "+" PriExp   -- pos\r
         | "-" PriExp   -- neg\r
         | Funtion\r
         | PriExp\r
         | identifier         -- var\r
         | num\r
\r
  //-------------------------------------------------------------------\r
\r
  LogExp = "[" Exp operator_logic Exp "]" ~(LogExp|ComExp)\r
  //\r
  ComExp = "[" Exp operator_compare Exp "]"  ~(LogExp|ComExp)\r
  \r
  //-------------------------------------------------------------------\r
  funtion_identifier = "SIN" | "COS" | "TAN" | "ASIN" | "ACOS" | "ATAN"\r
         |  "SQRT" | "ABS" | "ROUND" | "EXP" | "LN" | "FIX" | "FUP"\r
         | "B2D" | "D2B"\r
\r
  operator = ("AND" | "OR" | "NOT") -- logic\r
      | ("EQ" | "NE" | "GT" | "GE" | "LT" | "LE") -- compare\r
  //-------------------------------------------------------------------\r
\r
  VarDecl = identifier "=" AddExp\r
  identifier = "#" digit+\r
\r
  //-------------------------------------------------------------------\r
\r
  num = float | int\r
  //\r
  float =  all_float  | tail_float | head_float | int\r
  all_float = digit+ "." digit+\r
  tail_float = digit+ "."\r
  head_float = "." digit+\r
  //\r
  int = digit+\r
\r
}`},"MAIN",null,"Program",{Program:["define",{sourceInterval:[12,38]},null,[],["star",{sourceInterval:[22,38]},["alt",{sourceInterval:[23,36]},["app",{sourceInterval:[23,28]},"Gcode",[]],["app",{sourceInterval:[31,36]},"Macro",[]]]]],Gcode:["define",{sourceInterval:[44,162]},null,[],["plus",{sourceInterval:[52,162]},["alt",{sourceInterval:[53,160]},["app",{sourceInterval:[53,56]},"CRC",[]],["app",{sourceInterval:[59,78]},"InterpolationMotion",[]],["app",{sourceInterval:[81,98]},"StockRemovalCycle",[]],["app",{sourceInterval:[101,114]},"GroovingCycle",[]],["app",{sourceInterval:[117,131]},"ThreadingCycle",[]],["app",{sourceInterval:[134,137]},"G32",[]],["app",{sourceInterval:[140,143]},"G90",[]],["app",{sourceInterval:[146,149]},"G94",[]],["app",{sourceInterval:[152,160]},"FUN_DIVS",[]]]]],StockRemovalCycle:["define",{sourceInterval:[168,203]},null,[],["alt",{sourceInterval:[188,203]},["app",{sourceInterval:[188,191]},"G71",[]],["app",{sourceInterval:[194,197]},"G72",[]],["app",{sourceInterval:[200,203]},"G73",[]]]],G70:["define",{sourceInterval:[207,228]},null,[],["seq",{sourceInterval:[213,228]},["opt",{sourceInterval:[213,215]},["app",{sourceInterval:[213,214]},"N",[]]],["terminal",{sourceInterval:[216,221]},"G70"],["app",{sourceInterval:[222,223]},"P",[]],["app",{sourceInterval:[224,225]},"Q",[]],["opt",{sourceInterval:[226,228]},["app",{sourceInterval:[226,227]},"F",[]]]]],G71:["define",{sourceInterval:[232,286]},null,[],["seq",{sourceInterval:[238,286]},["opt",{sourceInterval:[238,240]},["app",{sourceInterval:[238,239]},"N",[]]],["terminal",{sourceInterval:[242,247]},"G71"],["app",{sourceInterval:[248,249]},"U",[]],["app",{sourceInterval:[250,251]},"R",[]],["opt",{sourceInterval:[255,257]},["app",{sourceInterval:[255,256]},"N",[]]],["terminal",{sourceInterval:[259,264]},"G71"],["app",{sourceInterval:[265,266]},"P",[]],["app",{sourceInterval:[267,268]},"Q",[]],["app",{sourceInterval:[269,270]},"X",[]],["app",{sourceInterval:[271,272]},"Z",[]],["opt",{sourceInterval:[273,275]},["app",{sourceInterval:[273,274]},"F",[]]],["app",{sourceInterval:[277,286]},"CycleBody",[]]]],G72:["define",{sourceInterval:[290,344]},null,[],["seq",{sourceInterval:[296,344]},["opt",{sourceInterval:[296,298]},["app",{sourceInterval:[296,297]},"N",[]]],["terminal",{sourceInterval:[300,305]},"G72"],["app",{sourceInterval:[306,307]},"W",[]],["app",{sourceInterval:[308,309]},"R",[]],["opt",{sourceInterval:[313,315]},["app",{sourceInterval:[313,314]},"N",[]]],["terminal",{sourceInterval:[317,322]},"G72"],["app",{sourceInterval:[323,324]},"P",[]],["app",{sourceInterval:[325,326]},"Q",[]],["app",{sourceInterval:[327,328]},"X",[]],["app",{sourceInterval:[329,330]},"Z",[]],["opt",{sourceInterval:[331,333]},["app",{sourceInterval:[331,332]},"F",[]]],["app",{sourceInterval:[335,344]},"CycleBody",[]]]],G73:["define",{sourceInterval:[348,402]},null,[],["seq",{sourceInterval:[354,402]},["opt",{sourceInterval:[354,356]},["app",{sourceInterval:[354,355]},"N",[]]],["terminal",{sourceInterval:[358,363]},"G73"],["app",{sourceInterval:[364,365]},"U",[]],["app",{sourceInterval:[366,367]},"W",[]],["app",{sourceInterval:[368,369]},"R",[]],["opt",{sourceInterval:[371,373]},["app",{sourceInterval:[371,372]},"N",[]]],["terminal",{sourceInterval:[375,380]},"G73"],["app",{sourceInterval:[381,382]},"P",[]],["app",{sourceInterval:[383,384]},"Q",[]],["app",{sourceInterval:[385,386]},"X",[]],["app",{sourceInterval:[387,388]},"Z",[]],["opt",{sourceInterval:[389,391]},["app",{sourceInterval:[389,390]},"F",[]]],["app",{sourceInterval:[393,402]},"CycleBody",[]]]],CycleBody:["define",{sourceInterval:[568,600]},null,[],["plus",{sourceInterval:[580,600]},["app",{sourceInterval:[580,599]},"InterpolationMotion",[]]]],GroovingCycle:["define",{sourceInterval:[606,631]},null,[],["alt",{sourceInterval:[622,631]},["app",{sourceInterval:[622,625]},"G74",[]],["app",{sourceInterval:[628,631]},"G75",[]]]],G74:["define",{sourceInterval:[635,675]},null,[],["seq",{sourceInterval:[641,675]},["opt",{sourceInterval:[641,643]},["app",{sourceInterval:[641,642]},"N",[]]],["terminal",{sourceInterval:[645,650]},"G74"],["app",{sourceInterval:[651,652]},"R",[]],["opt",{sourceInterval:[654,656]},["app",{sourceInterval:[654,655]},"N",[]]],["terminal",{sourceInterval:[658,663]},"G74"],["app",{sourceInterval:[664,665]},"P",[]],["app",{sourceInterval:[666,667]},"Q",[]],["app",{sourceInterval:[668,669]},"X",[]],["app",{sourceInterval:[670,671]},"Z",[]],["opt",{sourceInterval:[672,674]},["app",{sourceInterval:[672,673]},"F",[]]]]],G75:["define",{sourceInterval:[679,719]},null,[],["seq",{sourceInterval:[685,719]},["opt",{sourceInterval:[685,687]},["app",{sourceInterval:[685,686]},"N",[]]],["terminal",{sourceInterval:[689,694]},"G75"],["app",{sourceInterval:[695,696]},"R",[]],["opt",{sourceInterval:[698,700]},["app",{sourceInterval:[698,699]},"N",[]]],["terminal",{sourceInterval:[702,707]},"G75"],["app",{sourceInterval:[708,709]},"P",[]],["app",{sourceInterval:[710,711]},"Q",[]],["app",{sourceInterval:[712,713]},"X",[]],["app",{sourceInterval:[714,715]},"Z",[]],["opt",{sourceInterval:[716,718]},["app",{sourceInterval:[716,717]},"F",[]]]]],ThreadingCycle:["define",{sourceInterval:[725,751]},null,[],["alt",{sourceInterval:[742,751]},["app",{sourceInterval:[742,745]},"G92",[]],["app",{sourceInterval:[748,751]},"G76",[]]]],G92:["define",{sourceInterval:[755,799]},null,[],["seq",{sourceInterval:[761,799]},["opt",{sourceInterval:[761,763]},["app",{sourceInterval:[761,762]},"N",[]]],["terminal",{sourceInterval:[765,770]},"G92"],["app",{sourceInterval:[771,772]},"P",[]],["app",{sourceInterval:[773,774]},"Q",[]],["app",{sourceInterval:[775,776]},"R",[]],["opt",{sourceInterval:[778,780]},["app",{sourceInterval:[778,779]},"N",[]]],["terminal",{sourceInterval:[782,787]},"G92"],["app",{sourceInterval:[788,789]},"P",[]],["app",{sourceInterval:[790,791]},"Q",[]],["app",{sourceInterval:[792,793]},"X",[]],["app",{sourceInterval:[794,795]},"Z",[]],["opt",{sourceInterval:[796,798]},["app",{sourceInterval:[796,797]},"F",[]]]]],G76:["define",{sourceInterval:[803,847]},null,[],["seq",{sourceInterval:[809,847]},["opt",{sourceInterval:[809,811]},["app",{sourceInterval:[809,810]},"N",[]]],["terminal",{sourceInterval:[813,818]},"G76"],["app",{sourceInterval:[819,820]},"P",[]],["app",{sourceInterval:[821,822]},"Q",[]],["app",{sourceInterval:[823,824]},"R",[]],["opt",{sourceInterval:[826,828]},["app",{sourceInterval:[826,827]},"N",[]]],["terminal",{sourceInterval:[830,835]},"G76"],["app",{sourceInterval:[836,837]},"P",[]],["app",{sourceInterval:[838,839]},"Q",[]],["app",{sourceInterval:[840,841]},"X",[]],["app",{sourceInterval:[842,843]},"Z",[]],["opt",{sourceInterval:[844,846]},["app",{sourceInterval:[844,845]},"F",[]]]]],G32_XZF:["define",{sourceInterval:[935,964]},null,[],["seq",{sourceInterval:[935,958]},["opt",{sourceInterval:[935,941]},["terminal",{sourceInterval:[935,940]},"G32"]],["alt",{sourceInterval:[943,954]},["seq",{sourceInterval:[943,948]},["app",{sourceInterval:[944,945]},"X",[]],["app",{sourceInterval:[946,947]},"Z",[]]],["seq",{sourceInterval:[949,954]},["app",{sourceInterval:[950,951]},"U",[]],["app",{sourceInterval:[952,953]},"W",[]]]],["opt",{sourceInterval:[956,958]},["app",{sourceInterval:[956,957]},"F",[]]]]],G32_XF:["define",{sourceInterval:[974,1004]},null,[],["seq",{sourceInterval:[974,999]},["opt",{sourceInterval:[974,980]},["terminal",{sourceInterval:[974,979]},"G32"]],["alt",{sourceInterval:[982,995]},["app",{sourceInterval:[982,983]},"X",[]],["app",{sourceInterval:[986,987]},"Z",[]],["app",{sourceInterval:[990,991]},"U",[]],["app",{sourceInterval:[994,995]},"W",[]]],["opt",{sourceInterval:[997,999]},["app",{sourceInterval:[997,998]},"F",[]]]]],G32:["define",{sourceInterval:[929,1004]},null,[],["alt",{sourceInterval:[935,1004]},["app",{sourceInterval:[935,958]},"G32_XZF",[]],["app",{sourceInterval:[974,999]},"G32_XF",[]]]],G90:["define",{sourceInterval:[1010,1055]},null,[],["seq",{sourceInterval:[1016,1055]},["opt",{sourceInterval:[1016,1018]},["app",{sourceInterval:[1016,1017]},"N",[]]],["terminal",{sourceInterval:[1020,1025]},"G90"],["app",{sourceInterval:[1026,1027]},"P",[]],["app",{sourceInterval:[1028,1029]},"Q",[]],["app",{sourceInterval:[1030,1031]},"R",[]],["opt",{sourceInterval:[1033,1035]},["app",{sourceInterval:[1033,1034]},"N",[]]],["terminal",{sourceInterval:[1038,1043]},"G90"],["app",{sourceInterval:[1044,1045]},"P",[]],["app",{sourceInterval:[1046,1047]},"Q",[]],["app",{sourceInterval:[1048,1049]},"X",[]],["app",{sourceInterval:[1050,1051]},"Z",[]],["opt",{sourceInterval:[1052,1054]},["app",{sourceInterval:[1052,1053]},"F",[]]]]],G94:["define",{sourceInterval:[1059,1104]},null,[],["seq",{sourceInterval:[1065,1104]},["opt",{sourceInterval:[1065,1067]},["app",{sourceInterval:[1065,1066]},"N",[]]],["terminal",{sourceInterval:[1069,1074]},"G94"],["app",{sourceInterval:[1075,1076]},"P",[]],["app",{sourceInterval:[1077,1078]},"Q",[]],["app",{sourceInterval:[1079,1080]},"R",[]],["opt",{sourceInterval:[1082,1084]},["app",{sourceInterval:[1082,1083]},"N",[]]],["terminal",{sourceInterval:[1087,1092]},"G94"],["app",{sourceInterval:[1093,1094]},"P",[]],["app",{sourceInterval:[1095,1096]},"Q",[]],["app",{sourceInterval:[1097,1098]},"X",[]],["app",{sourceInterval:[1099,1100]},"Z",[]],["opt",{sourceInterval:[1101,1103]},["app",{sourceInterval:[1101,1102]},"F",[]]]]],InterpolationMotion_arc:["define",{sourceInterval:[1132,1148]},null,[],["alt",{sourceInterval:[1132,1141]},["app",{sourceInterval:[1133,1135]},"G3",[]],["app",{sourceInterval:[1138,1140]},"G2",[]]]],InterpolationMotion_line:["define",{sourceInterval:[1174,1191]},null,[],["alt",{sourceInterval:[1174,1183]},["app",{sourceInterval:[1175,1177]},"G1",[]],["app",{sourceInterval:[1180,1182]},"G0",[]]]],InterpolationMotion:["define",{sourceInterval:[1110,1191]},null,[],["alt",{sourceInterval:[1132,1191]},["app",{sourceInterval:[1132,1141]},"InterpolationMotion_arc",[]],["app",{sourceInterval:[1174,1183]},"InterpolationMotion_line",[]]]],CRC:["define",{sourceInterval:[1199,1220]},null,[],["alt",{sourceInterval:[1205,1220]},["app",{sourceInterval:[1205,1208]},"G40",[]],["app",{sourceInterval:[1211,1214]},"G41",[]],["app",{sourceInterval:[1217,1220]},"G42",[]]]],G40:["define",{sourceInterval:[1224,1264]},null,[],["seq",{sourceInterval:[1230,1264]},["opt",{sourceInterval:[1230,1232]},["app",{sourceInterval:[1230,1231]},"N",[]]],["terminal",{sourceInterval:[1233,1238]},"G40"],["opt",{sourceInterval:[1239,1264]},["app",{sourceInterval:[1239,1263]},"InterpolationMotion_line",[]]]]],G41:["define",{sourceInterval:[1268,1308]},null,[],["seq",{sourceInterval:[1274,1308]},["opt",{sourceInterval:[1274,1276]},["app",{sourceInterval:[1274,1275]},"N",[]]],["terminal",{sourceInterval:[1277,1282]},"G41"],["opt",{sourceInterval:[1283,1308]},["app",{sourceInterval:[1283,1307]},"InterpolationMotion_line",[]]]]],G42:["define",{sourceInterval:[1312,1352]},null,[],["seq",{sourceInterval:[1318,1352]},["opt",{sourceInterval:[1318,1320]},["app",{sourceInterval:[1318,1319]},"N",[]]],["terminal",{sourceInterval:[1321,1326]},"G42"],["opt",{sourceInterval:[1327,1352]},["app",{sourceInterval:[1327,1351]},"InterpolationMotion_line",[]]]]],G0:["define",{sourceInterval:[1432,1464]},null,[],["seq",{sourceInterval:[1437,1464]},["opt",{sourceInterval:[1437,1439]},["app",{sourceInterval:[1437,1438]},"N",[]]],["opt",{sourceInterval:[1440,1445]},["terminal",{sourceInterval:[1440,1444]},"G0"]],["app",{sourceInterval:[1446,1464]},"SingleOrDoubleAsix",[]]]],G1:["define",{sourceInterval:[1468,1520]},null,[],["seq",{sourceInterval:[1473,1520]},["opt",{sourceInterval:[1473,1475]},["app",{sourceInterval:[1473,1474]},"N",[]]],["opt",{sourceInterval:[1476,1481]},["terminal",{sourceInterval:[1476,1480]},"G1"]],["app",{sourceInterval:[1482,1500]},"SingleOrDoubleAsix",[]],["opt",{sourceInterval:[1501,1517]},["seq",{sourceInterval:[1502,1515]},["app",{sourceInterval:[1502,1507]},"comma",[]],["app",{sourceInterval:[1508,1515]},"Chamfer",[]]]],["opt",{sourceInterval:[1518,1520]},["app",{sourceInterval:[1518,1519]},"F",[]]]]],G2:["define",{sourceInterval:[1524,1586]},null,[],["seq",{sourceInterval:[1529,1586]},["opt",{sourceInterval:[1529,1531]},["app",{sourceInterval:[1529,1530]},"N",[]]],["opt",{sourceInterval:[1532,1537]},["terminal",{sourceInterval:[1532,1536]},"G2"]],["app",{sourceInterval:[1538,1548]},"DoubleAsix",[]],["alt",{sourceInterval:[1550,1582]},["app",{sourceInterval:[1550,1568]},"ArcOfCenterOffsets",[]],["app",{sourceInterval:[1571,1582]},"ArcOfRadius",[]]],["opt",{sourceInterval:[1584,1586]},["app",{sourceInterval:[1584,1585]},"F",[]]]]],G3:["define",{sourceInterval:[1590,1652]},null,[],["seq",{sourceInterval:[1595,1652]},["opt",{sourceInterval:[1595,1597]},["app",{sourceInterval:[1595,1596]},"N",[]]],["opt",{sourceInterval:[1598,1603]},["terminal",{sourceInterval:[1598,1602]},"G3"]],["app",{sourceInterval:[1604,1614]},"DoubleAsix",[]],["alt",{sourceInterval:[1616,1648]},["app",{sourceInterval:[1616,1634]},"ArcOfCenterOffsets",[]],["app",{sourceInterval:[1637,1648]},"ArcOfRadius",[]]],["opt",{sourceInterval:[1650,1652]},["app",{sourceInterval:[1650,1651]},"F",[]]]]],ArcOfCenterOffsets:["define",{sourceInterval:[1732,1756]},null,[],["seq",{sourceInterval:[1753,1756]},["app",{sourceInterval:[1753,1754]},"I",[]],["app",{sourceInterval:[1755,1756]},"K",[]]]],ArcOfRadius:["define",{sourceInterval:[1760,1775]},null,[],["app",{sourceInterval:[1774,1775]},"R",[]]],SingleOrDoubleAsix:["define",{sourceInterval:[1779,1823]},null,[],["alt",{sourceInterval:[1800,1823]},["app",{sourceInterval:[1800,1810]},"DoubleAsix",[]],["app",{sourceInterval:[1813,1823]},"SingleAsix",[]]]],DoubleAsix:["define",{sourceInterval:[1827,1869]},null,[],["alt",{sourceInterval:[1840,1869]},["seq",{sourceInterval:[1840,1845]},["app",{sourceInterval:[1841,1842]},"X",[]],["app",{sourceInterval:[1843,1844]},"Z",[]]],["seq",{sourceInterval:[1848,1853]},["app",{sourceInterval:[1849,1850]},"U",[]],["app",{sourceInterval:[1851,1852]},"W",[]]],["seq",{sourceInterval:[1856,1861]},["app",{sourceInterval:[1857,1858]},"Z",[]],["app",{sourceInterval:[1859,1860]},"X",[]]],["seq",{sourceInterval:[1864,1869]},["app",{sourceInterval:[1865,1866]},"W",[]],["app",{sourceInterval:[1867,1868]},"U",[]]]]],SingleAsix:["define",{sourceInterval:[1873,1900]},null,[],["alt",{sourceInterval:[1887,1900]},["app",{sourceInterval:[1887,1888]},"X",[]],["app",{sourceInterval:[1891,1892]},"Z",[]],["app",{sourceInterval:[1895,1896]},"U",[]],["app",{sourceInterval:[1899,1900]},"W",[]]]],Chamfer:["define",{sourceInterval:[1904,1923]},null,[],["alt",{sourceInterval:[1914,1923]},["app",{sourceInterval:[1914,1915]},"C",[]],["app",{sourceInterval:[1918,1919]},"A",[]],["app",{sourceInterval:[1922,1923]},"R",[]]]],FUN_DIVS:["define",{sourceInterval:[1929,1954]},null,[],["seq",{sourceInterval:[1940,1954]},["opt",{sourceInterval:[1940,1942]},["app",{sourceInterval:[1940,1941]},"N",[]]],["alt",{sourceInterval:[1944,1953]},["app",{sourceInterval:[1944,1945]},"T",[]],["app",{sourceInterval:[1948,1949]},"S",[]],["app",{sourceInterval:[1952,1953]},"M",[]]]]],space:["extend",{sourceInterval:[1997,2013]},null,[],["app",{sourceInterval:[2006,2013]},"comment",[]]],comment:["define",{sourceInterval:[2017,2053]},null,[],["seq",{sourceInterval:[2028,2053]},["terminal",{sourceInterval:[2028,2031]},"("],["star",{sourceInterval:[2032,2049]},["seq",{sourceInterval:[2033,2047]},["not",{sourceInterval:[2033,2043]},["alt",{sourceInterval:[2035,2042]},["terminal",{sourceInterval:[2035,2038]},")"],["terminal",{sourceInterval:[2039,2042]},"("]]],["app",{sourceInterval:[2044,2047]},"any",[]]]],["terminal",{sourceInterval:[2050,2053]},")"]]],X_num:["define",{sourceInterval:[2137,2160]},null,[],["seq",{sourceInterval:[2137,2146]},["terminal",{sourceInterval:[2137,2140]},"X"],["app",{sourceInterval:[2141,2146]},"float",[]]]],X_exp:["define",{sourceInterval:[2168,2191]},null,[],["seq",{sourceInterval:[2168,2178]},["terminal",{sourceInterval:[2168,2171]},"X"],["app",{sourceInterval:[2172,2178]},"PriExp",[]]]],X:["define",{sourceInterval:[2133,2191]},null,[],["alt",{sourceInterval:[2137,2191]},["app",{sourceInterval:[2137,2146]},"X_num",[]],["app",{sourceInterval:[2168,2178]},"X_exp",[]]]],Z_num:["define",{sourceInterval:[2248,2271]},null,[],["seq",{sourceInterval:[2248,2257]},["terminal",{sourceInterval:[2248,2251]},"Z"],["app",{sourceInterval:[2252,2257]},"float",[]]]],Z_exp:["define",{sourceInterval:[2279,2302]},null,[],["seq",{sourceInterval:[2279,2289]},["terminal",{sourceInterval:[2279,2282]},"Z"],["app",{sourceInterval:[2283,2289]},"PriExp",[]]]],Z:["define",{sourceInterval:[2244,2302]},null,[],["alt",{sourceInterval:[2248,2302]},["app",{sourceInterval:[2248,2257]},"Z_num",[]],["app",{sourceInterval:[2279,2289]},"Z_exp",[]]]],U_num:["define",{sourceInterval:[2310,2333]},null,[],["seq",{sourceInterval:[2310,2319]},["terminal",{sourceInterval:[2310,2313]},"U"],["app",{sourceInterval:[2314,2319]},"float",[]]]],U_exp:["define",{sourceInterval:[2341,2364]},null,[],["seq",{sourceInterval:[2341,2357]},["terminal",{sourceInterval:[2341,2344]},"U"],["app",{sourceInterval:[2345,2357]},"PriExp_paren",[]]]],U:["define",{sourceInterval:[2306,2364]},null,[],["alt",{sourceInterval:[2310,2364]},["app",{sourceInterval:[2310,2319]},"U_num",[]],["app",{sourceInterval:[2341,2357]},"U_exp",[]]]],W_num:["define",{sourceInterval:[2372,2395]},null,[],["seq",{sourceInterval:[2372,2381]},["terminal",{sourceInterval:[2372,2375]},"W"],["app",{sourceInterval:[2376,2381]},"float",[]]]],W_exp:["define",{sourceInterval:[2403,2426]},null,[],["seq",{sourceInterval:[2403,2419]},["terminal",{sourceInterval:[2403,2406]},"W"],["app",{sourceInterval:[2407,2419]},"PriExp_paren",[]]]],W:["define",{sourceInterval:[2368,2426]},null,[],["alt",{sourceInterval:[2372,2426]},["app",{sourceInterval:[2372,2381]},"W_num",[]],["app",{sourceInterval:[2403,2419]},"W_exp",[]]]],F_num:["define",{sourceInterval:[2436,2459]},null,[],["seq",{sourceInterval:[2436,2445]},["terminal",{sourceInterval:[2436,2439]},"F"],["app",{sourceInterval:[2440,2445]},"float",[]]]],F_exp:["define",{sourceInterval:[2467,2490]},null,[],["seq",{sourceInterval:[2467,2483]},["terminal",{sourceInterval:[2467,2470]},"F"],["app",{sourceInterval:[2471,2483]},"PriExp_paren",[]]]],F:["define",{sourceInterval:[2432,2490]},null,[],["alt",{sourceInterval:[2436,2490]},["app",{sourceInterval:[2436,2445]},"F_num",[]],["app",{sourceInterval:[2467,2483]},"F_exp",[]]]],A_num:["define",{sourceInterval:[2498,2521]},null,[],["seq",{sourceInterval:[2498,2507]},["terminal",{sourceInterval:[2498,2501]},"A"],["app",{sourceInterval:[2502,2507]},"float",[]]]],A_exp:["define",{sourceInterval:[2529,2552]},null,[],["seq",{sourceInterval:[2529,2545]},["terminal",{sourceInterval:[2529,2532]},"A"],["app",{sourceInterval:[2533,2545]},"PriExp_paren",[]]]],A:["define",{sourceInterval:[2494,2552]},null,[],["alt",{sourceInterval:[2498,2552]},["app",{sourceInterval:[2498,2507]},"A_num",[]],["app",{sourceInterval:[2529,2545]},"A_exp",[]]]],C_num:["define",{sourceInterval:[2560,2583]},null,[],["seq",{sourceInterval:[2560,2569]},["terminal",{sourceInterval:[2560,2563]},"C"],["app",{sourceInterval:[2564,2569]},"float",[]]]],C_exp:["define",{sourceInterval:[2591,2614]},null,[],["seq",{sourceInterval:[2591,2607]},["terminal",{sourceInterval:[2591,2594]},"C"],["app",{sourceInterval:[2595,2607]},"PriExp_paren",[]]]],C:["define",{sourceInterval:[2556,2614]},null,[],["alt",{sourceInterval:[2560,2614]},["app",{sourceInterval:[2560,2569]},"C_num",[]],["app",{sourceInterval:[2591,2607]},"C_exp",[]]]],R_num:["define",{sourceInterval:[2622,2645]},null,[],["seq",{sourceInterval:[2622,2631]},["terminal",{sourceInterval:[2622,2625]},"R"],["app",{sourceInterval:[2626,2631]},"float",[]]]],R_exp:["define",{sourceInterval:[2653,2676]},null,[],["seq",{sourceInterval:[2653,2669]},["terminal",{sourceInterval:[2653,2656]},"R"],["app",{sourceInterval:[2657,2669]},"PriExp_paren",[]]]],R:["define",{sourceInterval:[2618,2676]},null,[],["alt",{sourceInterval:[2622,2676]},["app",{sourceInterval:[2622,2631]},"R_num",[]],["app",{sourceInterval:[2653,2669]},"R_exp",[]]]],I_num:["define",{sourceInterval:[2684,2707]},null,[],["seq",{sourceInterval:[2684,2693]},["terminal",{sourceInterval:[2684,2687]},"I"],["app",{sourceInterval:[2688,2693]},"float",[]]]],I_exp:["define",{sourceInterval:[2715,2738]},null,[],["seq",{sourceInterval:[2715,2731]},["terminal",{sourceInterval:[2715,2718]},"I"],["app",{sourceInterval:[2719,2731]},"PriExp_paren",[]]]],I:["define",{sourceInterval:[2680,2738]},null,[],["alt",{sourceInterval:[2684,2738]},["app",{sourceInterval:[2684,2693]},"I_num",[]],["app",{sourceInterval:[2715,2731]},"I_exp",[]]]],K_num:["define",{sourceInterval:[2746,2769]},null,[],["seq",{sourceInterval:[2746,2755]},["terminal",{sourceInterval:[2746,2749]},"K"],["app",{sourceInterval:[2750,2755]},"float",[]]]],K_exp:["define",{sourceInterval:[2777,2800]},null,[],["seq",{sourceInterval:[2777,2793]},["terminal",{sourceInterval:[2777,2780]},"K"],["app",{sourceInterval:[2781,2793]},"PriExp_paren",[]]]],K:["define",{sourceInterval:[2742,2800]},null,[],["alt",{sourceInterval:[2746,2800]},["app",{sourceInterval:[2746,2755]},"K_num",[]],["app",{sourceInterval:[2777,2793]},"K_exp",[]]]],O:["define",{sourceInterval:[2880,2891]},null,[],["seq",{sourceInterval:[2884,2891]},["terminal",{sourceInterval:[2884,2887]},"O"],["app",{sourceInterval:[2888,2891]},"int",[]]]],T:["define",{sourceInterval:[2895,2906]},null,[],["seq",{sourceInterval:[2899,2906]},["terminal",{sourceInterval:[2899,2902]},"T"],["app",{sourceInterval:[2903,2906]},"int",[]]]],S:["define",{sourceInterval:[2910,2921]},null,[],["seq",{sourceInterval:[2914,2921]},["terminal",{sourceInterval:[2914,2917]},"S"],["app",{sourceInterval:[2918,2921]},"int",[]]]],M:["define",{sourceInterval:[2925,2936]},null,[],["seq",{sourceInterval:[2929,2936]},["terminal",{sourceInterval:[2929,2932]},"M"],["app",{sourceInterval:[2933,2936]},"int",[]]]],N:["define",{sourceInterval:[2940,2951]},null,[],["seq",{sourceInterval:[2944,2951]},["terminal",{sourceInterval:[2944,2947]},"N"],["app",{sourceInterval:[2948,2951]},"int",[]]]],P:["define",{sourceInterval:[2955,2966]},null,[],["seq",{sourceInterval:[2959,2966]},["terminal",{sourceInterval:[2959,2962]},"P"],["app",{sourceInterval:[2963,2966]},"int",[]]]],Q:["define",{sourceInterval:[2970,2981]},null,[],["seq",{sourceInterval:[2974,2981]},["terminal",{sourceInterval:[2974,2977]},"Q"],["app",{sourceInterval:[2978,2981]},"int",[]]]],comma:["define",{sourceInterval:[2989,3e3]},null,[],["terminal",{sourceInterval:[2997,3e3]},","]],Macro:["define",{sourceInterval:[3156,3195]},null,[],["seq",{sourceInterval:[3164,3195]},["opt",{sourceInterval:[3164,3166]},["app",{sourceInterval:[3164,3165]},"N",[]]],["plus",{sourceInterval:[3167,3195]},["alt",{sourceInterval:[3168,3193]},["app",{sourceInterval:[3168,3177]},"Statement",[]],["app",{sourceInterval:[3180,3187]},"VarDecl",[]],["app",{sourceInterval:[3190,3193]},"Exp",[]]]]]],Statement:["define",{sourceInterval:[3199,3246]},null,[],["alt",{sourceInterval:[3211,3246]},["app",{sourceInterval:[3211,3215]},"GOTO",[]],["app",{sourceInterval:[3218,3225]},"IF_GOTO",[]],["app",{sourceInterval:[3228,3235]},"IF_THEN",[]],["app",{sourceInterval:[3238,3246]},"WHILE_DO",[]]]],GOTO:["define",{sourceInterval:[3328,3346]},null,[],["seq",{sourceInterval:[3335,3346]},["terminal",{sourceInterval:[3335,3341]},"GOTO"],["plus",{sourceInterval:[3342,3346]},["app",{sourceInterval:[3342,3345]},"int",[]]]]],IF:["define",{sourceInterval:[3356,3378]},null,[],["alt",{sourceInterval:[3361,3378]},["app",{sourceInterval:[3361,3368]},"IF_GOTO",[]],["app",{sourceInterval:[3371,3378]},"IF_THEN",[]]]],IF_GOTO:["define",{sourceInterval:[3382,3408]},null,[],["seq",{sourceInterval:[3392,3408]},["terminal",{sourceInterval:[3392,3396]},"IF"],["app",{sourceInterval:[3397,3403]},"ComExp",[]],["app",{sourceInterval:[3404,3408]},"GOTO",[]]]],IF_THEN:["define",{sourceInterval:[3412,3448]},null,[],["seq",{sourceInterval:[3422,3448]},["terminal",{sourceInterval:[3422,3426]},"IF"],["app",{sourceInterval:[3427,3433]},"ComExp",[]],["terminal",{sourceInterval:[3434,3440]},"THEN"],["app",{sourceInterval:[3441,3448]},"VarDecl",[]]]],WHILE:["define",{sourceInterval:[3458,3474]},null,[],["app",{sourceInterval:[3466,3474]},"WHILE_DO",[]]],WHILE_DO:["define",{sourceInterval:[3478,3572]},null,[],["seq",{sourceInterval:[3494,3572]},["terminal",{sourceInterval:[3494,3501]},"WHILE"],["app",{sourceInterval:[3502,3508]},"ComExp",[]],["terminal",{sourceInterval:[3509,3513]},"DO"],["alt",{sourceInterval:[3515,3526]},["terminal",{sourceInterval:[3515,3518]},"1"],["terminal",{sourceInterval:[3519,3522]},"2"],["terminal",{sourceInterval:[3523,3526]},"3"]],["star",{sourceInterval:[3528,3552]},["alt",{sourceInterval:[3529,3550]},["app",{sourceInterval:[3529,3531]},"IF",[]],["app",{sourceInterval:[3532,3536]},"GOTO",[]],["app",{sourceInterval:[3537,3542]},"WHILE",[]],["app",{sourceInterval:[3543,3550]},"VarDecl",[]]]],["terminal",{sourceInterval:[3553,3558]},"END"],["alt",{sourceInterval:[3560,3571]},["terminal",{sourceInterval:[3560,3563]},"1"],["terminal",{sourceInterval:[3564,3567]},"2"],["terminal",{sourceInterval:[3568,3571]},"3"]]]],Exp:["define",{sourceInterval:[3831,3861]},null,[],["alt",{sourceInterval:[3837,3861]},["app",{sourceInterval:[3837,3843]},"AddExp",[]],["app",{sourceInterval:[3846,3852]},"LogExp",[]],["app",{sourceInterval:[3855,3861]},"ComExp",[]]]],AddExp_plus:["define",{sourceInterval:[3954,3980]},null,[],["seq",{sourceInterval:[3954,3971]},["app",{sourceInterval:[3954,3960]},"AddExp",[]],["terminal",{sourceInterval:[3961,3964]},"+"],["app",{sourceInterval:[3965,3971]},"MulExp",[]]]],AddExp_minus:["define",{sourceInterval:[3986,4013]},null,[],["seq",{sourceInterval:[3986,4003]},["app",{sourceInterval:[3986,3992]},"AddExp",[]],["terminal",{sourceInterval:[3993,3996]},"-"],["app",{sourceInterval:[3997,4003]},"MulExp",[]]]],AddExp:["define",{sourceInterval:[3942,4025]},null,[],["alt",{sourceInterval:[3954,4025]},["app",{sourceInterval:[3954,3971]},"AddExp_plus",[]],["app",{sourceInterval:[3986,4003]},"AddExp_minus",[]],["app",{sourceInterval:[4019,4025]},"MulExp",[]]]],MulExp_times:["define",{sourceInterval:[4047,4074]},null,[],["seq",{sourceInterval:[4047,4064]},["app",{sourceInterval:[4047,4053]},"MulExp",[]],["terminal",{sourceInterval:[4054,4057]},"*"],["app",{sourceInterval:[4058,4064]},"ExpExp",[]]]],MulExp_divide:["define",{sourceInterval:[4080,4108]},null,[],["seq",{sourceInterval:[4080,4097]},["app",{sourceInterval:[4080,4086]},"MulExp",[]],["terminal",{sourceInterval:[4087,4090]},"/"],["app",{sourceInterval:[4091,4097]},"ExpExp",[]]]],MulExp:["define",{sourceInterval:[4035,4120]},null,[],["alt",{sourceInterval:[4047,4120]},["app",{sourceInterval:[4047,4064]},"MulExp_times",[]],["app",{sourceInterval:[4080,4097]},"MulExp_divide",[]],["app",{sourceInterval:[4114,4120]},"ExpExp",[]]]],Funtion:["define",{sourceInterval:[4130,4173]},null,[],["seq",{sourceInterval:[4140,4173]},["app",{sourceInterval:[4140,4158]},"funtion_identifier",[]],["terminal",{sourceInterval:[4159,4162]},"["],["app",{sourceInterval:[4163,4169]},"AddExp",[]],["terminal",{sourceInterval:[4170,4173]},"]"]]],ExpExp_fun:["define",{sourceInterval:[4192,4232]},null,[],["seq",{sourceInterval:[4192,4224]},["app",{sourceInterval:[4192,4198]},"PriExp",[]],["app",{sourceInterval:[4199,4217]},"funtion_identifier",[]],["app",{sourceInterval:[4218,4224]},"ExpExp",[]]]],ExpExp:["define",{sourceInterval:[4183,4248]},null,[],["alt",{sourceInterval:[4192,4248]},["app",{sourceInterval:[4192,4224]},"ExpExp_fun",[]],["app",{sourceInterval:[4242,4248]},"PriExp",[]]]],PriExp_paren:["define",{sourceInterval:[4267,4288]},null,[],["seq",{sourceInterval:[4267,4278]},["terminal",{sourceInterval:[4267,4270]},"["],["app",{sourceInterval:[4271,4274]},"Exp",[]],["terminal",{sourceInterval:[4275,4278]},"]"]]],PriExp_neg:["define",{sourceInterval:[4333,4352]},null,[],["seq",{sourceInterval:[4333,4343]},["terminal",{sourceInterval:[4333,4336]},"-"],["app",{sourceInterval:[4337,4343]},"PriExp",[]]]],PriExp_var:["define",{sourceInterval:[4404,4429]},null,[],["app",{sourceInterval:[4404,4414]},"identifier",[]]],PriExp:["define",{sourceInterval:[4258,4445]},null,[],["alt",{sourceInterval:[4267,4445]},["app",{sourceInterval:[4267,4278]},"PriExp_paren",[]],["app",{sourceInterval:[4333,4343]},"PriExp_neg",[]],["app",{sourceInterval:[4365,4372]},"Funtion",[]],["app",{sourceInterval:[4385,4391]},"PriExp",[]],["app",{sourceInterval:[4404,4414]},"PriExp_var",[]],["app",{sourceInterval:[4442,4445]},"num",[]]]],LogExp:["define",{sourceInterval:[4526,4582]},null,[],["seq",{sourceInterval:[4535,4582]},["terminal",{sourceInterval:[4535,4538]},"["],["app",{sourceInterval:[4539,4542]},"Exp",[]],["app",{sourceInterval:[4543,4557]},"operator_logic",[]],["app",{sourceInterval:[4558,4561]},"Exp",[]],["terminal",{sourceInterval:[4562,4565]},"]"],["not",{sourceInterval:[4566,4582]},["alt",{sourceInterval:[4568,4581]},["app",{sourceInterval:[4568,4574]},"LogExp",[]],["app",{sourceInterval:[4575,4581]},"ComExp",[]]]]]],ComExp:["define",{sourceInterval:[4592,4651]},null,[],["seq",{sourceInterval:[4601,4651]},["terminal",{sourceInterval:[4601,4604]},"["],["app",{sourceInterval:[4605,4608]},"Exp",[]],["app",{sourceInterval:[4609,4625]},"operator_compare",[]],["app",{sourceInterval:[4626,4629]},"Exp",[]],["terminal",{sourceInterval:[4630,4633]},"]"],["not",{sourceInterval:[4635,4651]},["alt",{sourceInterval:[4637,4650]},["app",{sourceInterval:[4637,4643]},"LogExp",[]],["app",{sourceInterval:[4644,4650]},"ComExp",[]]]]]],funtion_identifier:["define",{sourceInterval:[4732,4896]},null,[],["alt",{sourceInterval:[4753,4896]},["terminal",{sourceInterval:[4753,4758]},"SIN"],["terminal",{sourceInterval:[4761,4766]},"COS"],["terminal",{sourceInterval:[4769,4774]},"TAN"],["terminal",{sourceInterval:[4777,4783]},"ASIN"],["terminal",{sourceInterval:[4786,4792]},"ACOS"],["terminal",{sourceInterval:[4795,4801]},"ATAN"],["terminal",{sourceInterval:[4815,4821]},"SQRT"],["terminal",{sourceInterval:[4824,4829]},"ABS"],["terminal",{sourceInterval:[4832,4839]},"ROUND"],["terminal",{sourceInterval:[4842,4847]},"EXP"],["terminal",{sourceInterval:[4850,4854]},"LN"],["terminal",{sourceInterval:[4857,4862]},"FIX"],["terminal",{sourceInterval:[4865,4870]},"FUP"],["terminal",{sourceInterval:[4883,4888]},"B2D"],["terminal",{sourceInterval:[4891,4896]},"D2B"]]],operator_logic:["define",{sourceInterval:[4913,4944]},null,[],["alt",{sourceInterval:[4913,4935]},["terminal",{sourceInterval:[4914,4919]},"AND"],["terminal",{sourceInterval:[4922,4926]},"OR"],["terminal",{sourceInterval:[4929,4934]},"NOT"]]],operator_compare:["define",{sourceInterval:[4954,5006]},null,[],["alt",{sourceInterval:[4954,4995]},["terminal",{sourceInterval:[4955,4959]},"EQ"],["terminal",{sourceInterval:[4962,4966]},"NE"],["terminal",{sourceInterval:[4969,4973]},"GT"],["terminal",{sourceInterval:[4976,4980]},"GE"],["terminal",{sourceInterval:[4983,4987]},"LT"],["terminal",{sourceInterval:[4990,4994]},"LE"]]],operator:["define",{sourceInterval:[4902,5006]},null,[],["alt",{sourceInterval:[4913,5006]},["app",{sourceInterval:[4913,4935]},"operator_logic",[]],["app",{sourceInterval:[4954,4995]},"operator_compare",[]]]],VarDecl:["define",{sourceInterval:[5085,5116]},null,[],["seq",{sourceInterval:[5095,5116]},["app",{sourceInterval:[5095,5105]},"identifier",[]],["terminal",{sourceInterval:[5106,5109]},"="],["app",{sourceInterval:[5110,5116]},"AddExp",[]]]],identifier:["define",{sourceInterval:[5120,5143]},null,[],["seq",{sourceInterval:[5133,5143]},["terminal",{sourceInterval:[5133,5136]},"#"],["plus",{sourceInterval:[5137,5143]},["app",{sourceInterval:[5137,5142]},"digit",[]]]]],num:["define",{sourceInterval:[5224,5241]},null,[],["alt",{sourceInterval:[5230,5241]},["app",{sourceInterval:[5230,5235]},"float",[]],["app",{sourceInterval:[5238,5241]},"int",[]]]],float:["define",{sourceInterval:[5251,5302]},null,[],["alt",{sourceInterval:[5260,5302]},["app",{sourceInterval:[5260,5269]},"all_float",[]],["app",{sourceInterval:[5273,5283]},"tail_float",[]],["app",{sourceInterval:[5286,5296]},"head_float",[]],["app",{sourceInterval:[5299,5302]},"int",[]]]],all_float:["define",{sourceInterval:[5306,5335]},null,[],["seq",{sourceInterval:[5318,5335]},["plus",{sourceInterval:[5318,5324]},["app",{sourceInterval:[5318,5323]},"digit",[]]],["terminal",{sourceInterval:[5325,5328]},"."],["plus",{sourceInterval:[5329,5335]},["app",{sourceInterval:[5329,5334]},"digit",[]]]]],tail_float:["define",{sourceInterval:[5339,5362]},null,[],["seq",{sourceInterval:[5352,5362]},["plus",{sourceInterval:[5352,5358]},["app",{sourceInterval:[5352,5357]},"digit",[]]],["terminal",{sourceInterval:[5359,5362]},"."]]],head_float:["define",{sourceInterval:[5366,5389]},null,[],["seq",{sourceInterval:[5379,5389]},["terminal",{sourceInterval:[5379,5382]},"."],["plus",{sourceInterval:[5383,5389]},["app",{sourceInterval:[5383,5388]},"digit",[]]]]],int:["define",{sourceInterval:[5399,5411]},null,[],["plus",{sourceInterval:[5405,5411]},["app",{sourceInterval:[5405,5410]},"digit",[]]]]}]);function mr(r){return{type:"Program",body:r}}function dr(r){return{type:"Float",value:r}}function fr(r){return{type:"Int",value:r}}function Ir(r){return{type:"Identifier",name:r}}function vr(r,e){return{type:"VarDecl",id:r,init:e}}function gr(r,e,t){return{type:"Logic",operator:r,left:e,right:t}}function yr(r,e,t){return{type:"Compare",operator:r,left:e,right:t}}function xr(r,e){return{type:"Funtion",value:e,name:r}}function Sr(r,e){return{type:"WhileDo",body:e,condition:r}}function _r(r,e){return{type:"IfGoto",goto:e,condition:r}}function Ar(r,e){return{type:"IfThen",condition:r,var_decl:e}}function Nr(r){return{type:"Goto",label:r}}function br(r,e){return{type:"Divide",left:r,right:e}}function Er(r,e){return{type:"Multiply",left:r,right:e}}function Or(r,e){return{type:"Subtract",left:r,right:e}}function wr(r,e){return{type:"Add",left:r,right:e}}const Fr=(r,e={})=>{const t=Be.match(r);if(!t.succeeded())throw new Error(`Match failed: ${t.message}`);const s=Be.createSemantics();return s.addOperation("toAST",{_terminal(){return this.sourceString},_iter(...n){return n.map(i=>i.toAST())},Program(n){return mr(n.children.map(i=>i.toAST()).flat(2))},Gcode(n){let i=n.toAST().flat();for(let a=0;a<i.length;a++){const l=i[a].body.at(0)||"";if(l.startsWith("N")){const p={type:"Label",name:l.slice(1)};i.splice(a,0,p),a++}}return i},FUN_DIVS(n,i){return{type:"Gcode",body:[n.sourceString,i.toAST()].flat()}},G0(n,i,a){return{type:"Gcode",body:[n.sourceString,i.sourceString,a.toAST()].flat()}},G1(n,i,a,o,l,p){return{type:"Gcode",body:[n.sourceString,i.sourceString,a.toAST(),o.toAST(),l.toAST(),p.toAST()].flat()}},G2(n,i,a,o,l){return{type:"Gcode",body:[n.sourceString,i.sourceString,a.toAST(),o.toAST(),l.toAST()].flat()}},G3(n,i,a,o,l){return{type:"Gcode",body:[n.sourceString,i.sourceString,a.toAST(),o.toAST(),l.toAST()].flat()}},G40(n,i,a){return{type:"Gcode",body:[n.sourceString,i.sourceString,a.toAST()[0].body.slice(1)].flat()}},G41(n,i,a){return{type:"Gcode",body:[n.sourceString,i.sourceString,a.toAST()[0].body.slice(1)].flat()}},G42(n,i,a){return{type:"Gcode",body:[n.sourceString,i.sourceString,a.toAST()[0].body.slice(1)].flat()}},G71(n,i,a,o,l,p,u,c,h,m,f,g){e.G_COMP="G71";const y={type:"Gcode",body:[n.sourceString,i.sourceString,a.toAST(),o.toAST()].flat()},q={type:"Gcode",body:[l.sourceString,p.sourceString,u.toAST(),c.toAST(),h.toAST(),m.toAST(),f.toAST()].flat()},W=g.toAST();return[n.toAST(),y,l.toAST(),q,W].flat()},InterpolationMotion_line(n){const i=n.toAST(),a=i.body.at(1);return a===""&&(i.body[1]=e.G_BASE,i.gRelative=!0),e.G_BASE=a,i},InterpolationMotion_arc(n){const i=n.toAST(),a=i.body.at(1);return a===""&&(i.body[1]=e.G_BASE,i.gRelative=!0),e.G_BASE=a,i},SingleOrDoubleAsix(n){return n.toAST()},DoubleAsix(n,i){return[n.toAST(),i.toAST()].flat()},SingleAsix(n){return n.toAST()},ArcOfCenterOffsets(n,i){return[n.toAST(),i.toAST()].flat()},ArcOfRadius(n){return n.toAST()},X_exp(n,i){return[n.sourceString,i.toAST()]},X_num(n,i){return[n.sourceString,parseFloat(i.sourceString)].join("")},Z_exp(n,i){return[n.sourceString,i.toAST()]},Z_num(n,i){return[n.sourceString,parseFloat(i.sourceString)].join("")},U_exp(n,i){return[n.sourceString,i.toAST()]},U_num(n,i){return[n.sourceString,parseFloat(i.sourceString)].join("")},W_exp(n,i){return[n.sourceString,i.toAST()]},W_num(n,i){return[n.sourceString,parseFloat(i.sourceString)].join("")},F_exp(n,i){return[n.sourceString,i.toAST()]},F_num(n,i){return[n.sourceString,parseFloat(i.sourceString)].join("")},A_exp(n,i){return[n.sourceString,i.toAST()]},A_num(n,i){return[n.sourceString,parseFloat(i.sourceString)].join("")},C_exp(n,i){return[n.sourceString,i.toAST()]},C_num(n,i){return[n.sourceString,parseFloat(i.sourceString)].join("")},R_exp(n,i){return[n.sourceString,i.toAST()]},R_num(n,i){return[n.sourceString,parseFloat(i.sourceString)].join("")},I_exp(n,i){return[n.sourceString,i.toAST()]},I_num(n,i){return[n.sourceString,parseFloat(i.sourceString)].join("")},K_exp(n,i){return[n.sourceString,i.toAST()]},K_num(n,i){return[n.sourceString,parseFloat(i.sourceString)].join("")},O(n,i){return[n.sourceString,parseInt(i.sourceString,10)].join("")},T(n,i){return[n.sourceString,parseInt(i.sourceString,10)].join("")},M(n,i){return[n.sourceString,parseInt(i.sourceString,10)].join("")},S(n,i){return[n.sourceString,parseInt(i.sourceString,10)].join("")},N(n,i){const a=[n.sourceString,parseInt(i.sourceString,10)],o=a[1];if(o<e.N)throw`N 指令值不是增长的。
 Machine: ${JSON.stringify({N:e.N},null,2)} 
 current: ${JSON.stringify({N:o},null,2)}`;return a.join("")},P(n,i){return[n.sourceString,parseInt(i.sourceString,10)].join("")},Q(n,i){return[n.sourceString,parseInt(i.sourceString,10)].join("")},Macro(n,i){return[n.toAST(),i.toAST()].flat()},AddExp_plus(n,i,a){return wr(n.toAST(),a.toAST())},AddExp_minus(n,i,a){return Or(n.toAST(),a.toAST())},MulExp_times(n,i,a){return Er(n.toAST(),a.toAST())},MulExp_divide(n,i,a){return br(n.toAST(),a.toAST())},MulExp(n){return n.toAST()},ExpExp(n){return n.toAST()},PriExp(n){return n.toAST()},PriExp_neg(n,i){return{type:"Multiply",left:{type:"Float",value:-1},right:i.toAST()}},PriExp_paren(n,i,a){return i.toAST()},PriExp_var(n){return n.toAST()},GOTO(n,i){return Nr(i.sourceString)},IF_THEN(n,i,a,o){return Ar(i.toAST(),o.toAST())},IF_GOTO(n,i,a){return _r(i.toAST(),a.toAST())},WHILE_DO(n,i,a,o,l,p,u){return Sr(i.toAST(),l.children.map(c=>c.toAST()))},Funtion(n,i,a,o){return xr(n.sourceString,a.toAST())},ComExp(n,i,a,o,l){return yr(a.sourceString,i.toAST(),o.toAST())},LogExp(n,i,a,o,l){return gr(a.sourceString,i.toAST(),o.toAST())},VarDecl(n,i,a){return vr(n.sourceString,a.toAST())},identifier(n,i){return Ir(this.sourceString)},N(n,i){return{type:"Label",name:i.sourceString}},float(n){return dr(parseFloat(n.sourceString))},int(n){return fr(parseInt(n.sourceString,10))}}),s(t)},le=r=>r*(Math.PI/180),ue=r=>r*(180/Math.PI),ce={"+":(r,e)=>r+e,"-":(r,e)=>r-e,"*":(r,e)=>r*e,"/":(r,e)=>r/e,EQ:(r,e)=>r===e,NE:(r,e)=>r!==e,GT:(r,e)=>r>e,GE:(r,e)=>r>=e,LT:(r,e)=>r<e,LE:(r,e)=>r<=e,AND:(r,e)=>JSON.parse(r)&&JSON.parse(e),OR:(r,e)=>JSON.parse(r)||JSON.parse(e),NOT:r=>!JSON.parse(r),SIN:r=>Math.sin(le(r)),COS:r=>Math.cos(le(r)),TAN:r=>Math.tan(le(r)),ASIN:r=>ue(Math.asin(r)),ACOS:r=>ue(Math.acos(r)),ATAN:r=>ue(Math.atan(r)),SQRT:r=>Math.sqrt(r),ABS:r=>Math.abs(r),ROUND:r=>Math.round(r),EXP:r=>Math.exp(r),LN:r=>Math.log(r),FIX:r=>Math.floor(r),FUP:r=>Math.ceil(r),B2D:r=>parseInt(r*1,2).toString(),D2B:r=>(r*1).toString(2)},Gr=ht({__name:"GcodeMacro",setup(r){const e=Ae(`
G0 X42 Z5
G42 G1 Z2
#1 = 38
N10
#2 = 20 - #1 / 2
IF [#1 LE 0.5 ] THEN #1 =0.5
G0 X#1
G1 Z0
G3 X40. Z-#2 R20
G1 U2.
G0 Z5
#1 = #1 - 3
IF [#1 GT 0.5] GOTO 10
G0 X0
G1 Z0
G3 X40 Z-20 R20
G1 Z-40
G0 U2
G40 G0 X100
G0 Z100
`),t=Ae("");function s(o){return Fr(o).toAST()}function n(o,l={megs:[]}){switch(o.type){case"Program":o.body.forEach(u=>n(u,l));break;case"Gcode":let p="";o.body.forEach(u=>{vt.isObject(u)?p+=n(u,l):p+=` ${u}`}),l.megs.push(p.trim());break;case"VarDecl":return l[o.id]=n(o.init,l),l[o.id];case"Add":return n(o.left,l)+n(o.right,l);case"Subtract":return n(o.left,l)-n(o.right,l);case"Multiply":return n(o.left,l)*n(o.right,l);case"Divide":return n(o.left,l)/n(o.right,l);case"Identifier":if(l[o.name]!==void 0)return l[o.name];throw new Error(`Undefined variable: ${o.name}`);case"Float":return o.value;case"Int":return o.value;case"Funtion":return ce[o.name](n(o.value,l));case"Compare":return l._lastCompareResult=ce[o.operator](n(o.left,l),n(o.right,l)),l._lastCompareResult;case"Logic":return l._lastLogicResult=ce[o.operator](n(o.left,l),n(o.right,l)),l._lastLogicResult;case"IfThen":if(n(o.condition,l))return n(o.var_decl,l);case"IfGoto":if(n(o.condition,l))throw{type:"IfGoto",goto:o.goto};break;case"WhileDo":for(;n(o.condition,l);)try{for(let u of o.body)n(u,l)}catch(u){if(u.type==="IfGoto")throw u}break;case"Goto":throw{type:"Goto",label:o.label};case"Label":return o.name;default:throw console.error(o),new Error(`Unknown node type: ${o.type}`)}return l}function i(o,l={megs:[]}){const p={};for(let u=0;u<o.body.length;u++){const c=o.body[u];c.type==="Label"&&(p[c.name]=u)}for(let u=0;u<o.body.length;u++)try{n(o.body[u],l)}catch(c){if(c.type==="IfGoto"||c.type==="Goto"){let h;switch(c.type){case"IfGoto":h=c.goto.label;break;case"Goto":h=c.label;break;default:throw c}if(p[h]!==void 0)u=p[h];else throw new Error(`Undefined label: ${h}`)}}return l}function a(){var o=t.value;navigator.clipboard.writeText(o).then(function(){alert("Text copied to clipboard")}).catch(function(l){alert("Failed to copy text: ",l)})}return(o,l)=>(je(),Ue(mt,null,[l[3]||(l[3]=M("details",null,[M("summary",null,"TODO LIST"),M("dl",null,[M("dd")])],-1)),M("div",null,[Ne(M("textarea",{"onUpdate:modelValue":l[0]||(l[0]=p=>e.value=p)},null,512),[[be,e.value]]),Ne(M("textarea",{"onUpdate:modelValue":l[1]||(l[1]=p=>t.value=p)},null,512),[[be,t.value]])]),M("input",{type:"button",onClick:l[2]||(l[2]=p=>t.value=i(s(e.value)).megs.join(`
`)),value:"执行"}),M("input",{type:"button",onClick:a,value:"复制"})],64))}}),Tr=dt(Gr,[["__scopeId","data-v-3f4ffce2"]]),Cr=JSON.parse('{"title":"GcodeMacro","description":"","frontmatter":{},"headers":[],"relativePath":"pages/lathe/GcodeMacro.md","filePath":"pages/lathe/GcodeMacro.md"}'),Rr={name:"pages/lathe/GcodeMacro.md"},Dr=Object.assign(Rr,{setup(r){return(e,t)=>(je(),Ue("div",{"data-pagefind-body":!0},[t[0]||(t[0]=M("h1",{id:"gcodemacro",tabindex:"-1"},[ft("GcodeMacro "),M("a",{class:"header-anchor",href:"#gcodemacro","aria-label":'Permalink to "GcodeMacro"'},"​")],-1)),t[1]||(t[1]=M("p",null,"This is a GcodeMacro component.",-1)),It(Tr)]))}});export{Cr as __pageData,Dr as default};
