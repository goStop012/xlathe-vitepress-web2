var Kt=Object.defineProperty;var Jt=(s,t,r)=>t in s?Kt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var v=(s,t,r)=>Jt(s,typeof t!="symbol"?t+"":t,r);const kt=Math.PI,Mt=2*kt;var Rt=(s=>(s[s.NonDirection=0]="NonDirection",s[s.Clockwise=-1]="Clockwise",s[s.CounterClockwise=1]="CounterClockwise",s))(Rt||{}),Qt=(s=>(s[s.Minor=-1]="Minor",s[s.Major=1]="Major",s))(Qt||{});function x(s){return s*(Math.PI/180)}function nt(s){return s*(180/Math.PI)}function pt(s){return(s%Mt+Mt)%Mt}class ct{constructor(t,r){v(this,"x");v(this,"z");this.x=t,this.z=r}static fromArray(t){if(t.length!==2)throw new Error(`${this.constructor.name} Array must contain exactly two elements: [x, z]`);return new ct(t[0],t[1])}static fromObject(t){if(typeof t.x!="number"||typeof t.z!="number")throw new Error(`${this.constructor.name} Object must have numeric properties x and z`);return new ct(t.x,t.z)}toPoint(){return new w(this.z,this.x/2)}toString(){return`X${this.x} Z${this.z}`}}class w{constructor(t,r){v(this,"x");v(this,"y");this.x=t,this.y=r}static fromArray(t){if(t.length!==2)throw new Error(`${this.constructor.name} Array must contain exactly two elements: [x, y]`);return new w(t[0],t[1])}static fromArrayXZ(t){if(t.length!==2)throw new Error(`${this.constructor.name} Array must contain exactly two elements: [x, z]`);return new w(t[1],t[0]/2)}static fromObject(t){if(typeof t.x!="number"||typeof t.y!="number")throw new Error(`${this.constructor.name} Object must have numeric properties x and y`);return new w(t.x,t.y)}static fromObjectXZ(t){if(typeof t.x!="number"||typeof t.z!="number")throw new Error(`${this.constructor.name} Object must have numeric properties x and z`);return new w(t.z,t.x/2)}isZero(){return this.x===0&&this.y===0}toVector(t){return t instanceof w?new X(t.x-this.x,t.y-this.y):new X(this.x,this.y)}mirror(t){const r=t.normalize().perpendicular();return this.toVector().reflect(r).toPoint()}toObjectXZ(){return{x:this.y*2,z:this.x}}toObject(){return{x:this.x,y:this.y}}toArray(){return[this.x,this.y]}toPointXZ(){return ct.fromObject(this.toObjectXZ())}add(t){return new w(this.x+t.x,this.y+t.y)}subtract(t){return new w(this.x-t.x,this.y-t.y)}multiply(t){return new w(this.x*t,this.y*t)}divide(t){if(t===0)throw new Error(`${this.constructor.name} - Division by zero`);return new w(this.x/t,this.y/t)}clone(){return new w(this.x,this.y)}equals(t){return this.x===t.x&&this.y===t.y}distanceTo(t){return this.toVector(t).length()}}class X extends w{constructor(t,r){super(t,r)}static fromPoints(t,r){return new X(r.x-t.x,r.y-t.y)}toPoint(){return new w(this.x,this.y)}length(){return Math.sqrt(this.x**2+this.y**2)}normalize(){const t=this.length();if(t===0)throw new Error(`${this.constructor.name} - Cannot normalize a zero vector`);return new X(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}angleTo(t){const r=this.dot(t),e=this.length()*t.length();if(e===0)throw new Error(`${this.constructor.name} - Cannot calculate angle with zero-length vector`);const n=r/e,i=this.angleDirection(t);return Math.acos(Math.min(Math.max(n,-1),1))*(i<0?-1:1)}rotate(t){const r=Math.cos(t),e=Math.sin(t),n=this.x*r-this.y*e,i=this.x*e+this.y*r;return new X(n,i)}projectOnto(t){const r=this.dot(t)/t.length()**2;return t.multiply(r)}lerp(t,r){const e=this.x+r*(t.x-this.x),n=this.y+r*(t.y-this.y);return new X(e,n)}distanceTo(t){return Math.sqrt((this.x-t.x)**2+(this.y-t.y)**2)}isZero(){return this.x===0&&this.y===0}perpendicular(){return new X(-this.y,this.x)}reflect(t){const r=this.dot(t);return this.subtract(t.multiply(2*r))}angleDirection(t){const r=this.cross(t);return r>0?1:r<0?-1:0}bisector(t){return this.add(t).normalize()}clampLength(t){return this.length()>t?this.normalize().multiply(t):this}negate(){return new X(-this.x,-this.y)}isParallelTo(t){return this.cross(t)===0}translate(t){return this.add(t)}increaseLength(t){const r=this.length();if(r===0)throw new Error(`${this.constructor.name} - Cannot increase length of a zero vector`);const e=(r+t)/r;return this.multiply(e)}decreaseLength(t){const r=this.length();if(t>=r)return new X(0,0);const e=(r-t)/r;return this.multiply(e)}angleRad(){return Math.atan2(this.y,this.x)}angle(){return nt(Math.atan2(this.y,this.x))}arrowDirection(){return this.angleRad()===Math.PI/2?"↑":this.angleRad()===3*Math.PI/2?"↓":this.angleRad()===0?"→":this.angleRad()===Math.PI?"←":this.x>0&&this.y<0?"↘":this.x<0&&this.y<0?"↙":this.x>0&&this.y>0?"↗":this.x<0&&this.y>0?"↖":"null"}clone(){return new X(this.x,this.y)}equals(t){return super.equals(t)}add(t){return super.add(t).toVector()}subtract(t){return super.subtract(t).toVector()}multiply(t){return super.multiply(t).toVector()}divide(t){return super.divide(t).toVector()}}class A{constructor(t,r){v(this,"start");v(this,"end");v(this,"length");v(this,"angle");v(this,"angleRad");v(this,"vector");v(this,"delta");v(this,"arrowDirection");this.start=t,this.end=r,this.vector=this.toVector(),this.delta=X.fromPoints(r,t),this.length=this.vector.length(),this.angle=this.vector.angle(),this.angleRad=this.vector.angleRad(),this.arrowDirection=this.vector.arrowDirection()}static fromArray(t){if(t.length!==2)throw new Error(`${this.constructor.name} 数组必须包含两个点坐标`);const[r,e]=t;return new A(w.fromArray(r),w.fromArray(e))}static fromArrayXZ(t){if(t.length!==2)throw new Error(`${this.constructor.name} 数组必须包含两个点坐标`);const[r,e]=t;return new A(w.fromArrayXZ(r),w.fromArrayXZ(e))}static fromNumber(t,r,e,n){return A.fromArray([[t,r],[e,n]])}static fromNumberXZ(t,r,e,n){return A.fromArray([[r,t/2],[n,e/2]])}static createLineFromAngle(t,r,e){if([...t.toArray(),...r.toArray(),e].filter(isFinite).length<4||!isFinite(e))throw new Error(`${this.constructor.name} 有效参数不够，无法进行计算。`);const a=Math.tan(x(e));return isFinite(t.x)?isFinite(t.y)?isFinite(r.x)?isFinite(r.y)||(r.y=t.y+(r.x-t.x)*a):r.x=t.x+(r.y-t.y)/a:t.y=r.y-(r.x-t.x)*a:t.x=r.x-(r.y-t.y)/a,new A(t,r)}static createLineFromLengthAndAngle(t,r,e){const n=x(e),i=new X(Math.cos(n),Math.sin(n)),a=t.add(i.multiply(r*(e>0&&e<180?-1:1)));return new A(t,a)}static createHorizontallLine(t,r){return new A(t,new w(t.x,r))}static createVerticalLine(t,r){return new A(t,new w(r,t.y))}static createHorizontallLineXZ(t,r){return new A(t.toPoint(),new ct(r,t.z).toPoint())}static createVerticalLineXZ(t,r){return new A(t.toPoint(),new ct(t.x,r).toPoint())}reverse(){return new A(this.end,this.start)}static createFillet(t,r,e,n){const i=new A(t,r),a=new A(r,e);if(i.length<n||a.length<n)throw new Error(`${this.constructor.name} 长度不够，无法进行倒角。`);const l=i.toVector().normalize(),u=a.toVector().normalize(),h=l.multiply(n).negate(),o=u.multiply(n).negate(),c=r.add(h),f=r.subtract(o);return[new A(t,c),new A(c,f),new A(f,e)]}toObject(){return{start:this.start.toObject(),end:this.end.toObject()}}toObjectXZ(){return{start:this.start.toObjectXZ(),end:this.end.toObjectXZ()}}toArray(){return[this.start.toArray(),this.end.toArray()]}middle(){const t=this.toVector();return this.start.add(t.multiply(.5))}extendOrShrinkFromEnd(t){const r=this.toVector().normalize(),e=this.end.add(r.multiply(t));return new A(this.start,e)}extendOrShrinkFromStart(t){const r=this.toVector().normalize(),e=this.start.subtract(r.multiply(t));return new A(e,this.end)}slope(){const t=this.toVector();return t.x===0?null:t.y/t.x}translate(t){return new A(this.start.add(t),this.end.add(t))}toVector(){return X.fromPoints(this.start,this.end)}angleTo(t){return this.toVector().angleTo(t.toVector())}isParallelTo(t){return this.toVector().isParallelTo(t.toVector())}projectOnto(t){return this.toVector().projectOnto(t.toVector())}lineLineIntersection(t,r=!0){let e=null;const n=this.start,i=this.end,a=t.start,l=t.end,u=i.subtract(n).toVector(),h=l.subtract(a).toVector(),o=a.subtract(n).toVector(),c=u.cross(h);if(c===0)return null;const f=o.cross(h)/c,g=o.cross(u)/c;return(r||f>=0&&f<=1&&g>=0&&g<=1)&&(e=n.add(u.clone().multiply(f))),e}lineArcIntersection(t){const r=[],e=this,n=e.start,i=e.end,a=t.center,l=t.radius,u=i.x-n.x,h=i.y-n.y,o=n.x-a.x,c=n.y-a.y,f=u*u+h*h,g=2*(o*u+c*h),P=o*o+c*c-l*l,y=g*g-4*f*P;if(y<0)return r;const S=Math.sqrt(y),I=(-g+S)/(2*f),V=(-g-S)/(2*f);if(I>=0&&I<=1){const p=new w(n.x+I*u,n.y+I*h);t.isPointOnArc(p)&&r.push(p)}if(V>=0&&V<=1){const p=new w(n.x+V*u,n.y+V*h);t.isPointOnArc(p)&&r.push(p)}return r}toPointsXZ(){return Object.keys(this).forEach(t=>{this[t].constructor===w&&(this[t]=this[t].toPointXZ())}),this}}class G{constructor(t,r,e,n,i,a){v(this,"start");v(this,"end");v(this,"center");v(this,"radius");v(this,"diameter");v(this,"startAngle");v(this,"endAngle");v(this,"startAngleRad");v(this,"endAngleRad");v(this,"angle");v(this,"length");v(this,"direction");v(this,"type");this.start=t,this.end=r,this.center=e,this.radius=n,this.diameter=this.radius*2,this.startAngle=nt(i),this.endAngle=nt(a),this.startAngleRad=i,this.endAngleRad=a,this.angle=this.endAngle-this.startAngle,this.length=this.radius*Math.abs(this.endAngleRad-this.startAngleRad),this.direction=this.angle<0?-1:1,this.type=this.length>=this.radius*kt?1:-1}static createArcFromTwoPointAndRadius(t,r,e){const n=this.calculateCircleCenters(t,r,e),i=[];return n.forEach(a=>{let l=a.toVector(t).angleRad(),u=a.toVector(r).angleRad();[l,u]=G.normalizeArcAngle(l,u);const h=new G(t,r,a,e,l,u);i.push(h,h.complementary().reverseDirection())}),i}reverse(){return G.createArcFromThreePoints(this.end,this.midpoint(),this.start)}mirror(t,r=this){const e=r.center.mirror(t),n=r.start.mirror(t),i=r.end.mirror(t),a=r.direction,l=a===1?1:0;let u=e.toVector(n).angleRad()+Math.PI*2*l,h=e.toVector(i).angleRad();const o=h-u;Math.abs(o)>=Math.PI&&a===-1&&(u+=Math.PI*2,h+=Math.PI*2);const c=r.radius;return new G(n,i,e,c,u,h)}complementary(t=this){const r=Math.PI*2,{endAngleRad:e,startAngleRad:n}=t,i=e-n,a=Math.sign(i),l=(r-Math.abs(i))*a,u=e==0?r:e,h=u+l;let o=[u,h];return o.every(c=>c<0)&&(o=o.map(c=>c+r)),o.every(c=>c>=r)&&(o=o.map(c=>c%r)),new G(t.start,t.end,t.center,t.radius,o[0],o[1])}reverseDirection(t=this){const r=Math.PI*2,{endAngleRad:e,startAngleRad:n}=t,i=e-n,l=Math.sign(i)*-1;let o=[e,n];return o.some(c=>c<0||c>r)&&(o=o.map(c=>c+r*l)),o.some(c=>c>=2*r)&&(o=o.map(c=>c%r).map(c=>c===0?r:c)),new G(t.start,t.end,t.center,t.radius,o[0],o[1])}static normalizeArcAngle(t,r){const e=Math.PI*2;let n=[t,r];return n=n.map(i=>i<0?i+e:i),n}midpoint(){const t=(x(this.startAngle)+x(this.endAngle))/2,r=this.center.x+this.radius*Math.cos(t),e=this.center.y+this.radius*Math.sin(t);return new w(r,e)}extendOrShrinkFromStart(t){const r=this.endAngle-this.startAngle<0?1:-1;return this.startAngle+=r*nt(t/this.radius),this.length=this.radius*Math.abs(x(this.endAngle)-x(this.startAngle)),this.start=this.calculatePointOnCircle(x(this.startAngle)),this}extendOrShrinkFromEnd(t){const r=this.endAngle-this.startAngle<0?-1:1;return this.endAngle+=r*nt(t/this.radius),this.length=this.radius*Math.abs(x(this.endAngle)-x(this.startAngle)),this.end=this.calculatePointOnCircle(x(this.endAngle)),this}calculatePointOnCircle(t){const r=this.center.x+this.radius*Math.cos(t),e=this.center.y+this.radius*Math.sin(t);return new w(r,e)}static calculateRadiusFromThreePoints(t,r,e){const n=t.distanceTo(r),i=r.distanceTo(e),a=e.distanceTo(t),l=(n+i+a)/2,u=Math.sqrt(l*(l-n)*(l-i)*(l-a));if(u===0)throw new Error(`${this.constructor.name} 三点共线，无法形成圆。`);return n*i*a/(4*u)}static calculateCircleCenters(t,r,e){if(e<=0)throw new Error(`${this.constructor.name} 无效的半径，必须大于零。`);const n=new A(t,r),i=n.length;if(i>2*e)throw new Error(`${this.constructor.name} 无法构造圆：两点间的距离大于直径。`);const a=n.middle(),l=i/2,u=Math.sqrt(e**2-l**2),h=n.toVector().normalize(),c=new X(-h.y,h.x).multiply(u),f=a.add(c),g=a.subtract(c);return[f,g]}static createArcFromThreePoints(t,r,e){const n=this.calculateRadiusFromThreePoints(t,r,e),i=this.createArcFromTwoPointAndRadius(t,e,n),a=-1,l=t.toVector(r).angleDirection(r.toVector(e));return G.find(i,a,l)}static createFillet(t,r,e,n){const i=new A(r,t).toVector().normalize(),a=new A(r,e).toVector().normalize(),l=i.angleTo(a),u=Math.sign(l),h=l/2,o=n/Math.tan(h),c=r.add(i.multiply(o).multiply(u)),f=r.add(a.multiply(o).multiply(u)),g=this.createArcFromTwoPointAndRadius(c,f,n),P=-1,y=t.toVector(r).angleDirection(r.toVector(e));return G.find(g,P,y)}static find(t,r,e){return t.find(n=>n.type===r&&n.direction===e)}isPointOnArc(t){const r=this.center.toVector(t).angleRad(),e=pt(this.startAngle),n=pt(this.endAngle),i=pt(r);return i>=e&&i<=n}static normalizeToMasterCAMAngleDeg(t,r,e=-1,n=-1){let i=r-t;return t<0&&(t+=360),e===-1&&n===-1&&(r<180?r=i+t:r=-360+r),e===1&&r<0&&(r+=360),i=r-t,e=i<0?-1:1,{angle:i,direction:e,startAngle:t,endAngle:r}}toPointsXZ(){return Object.keys(this).forEach(t=>{this[t].constructor===w&&(this[t]=this[t].toPointXZ())}),this}toGcode(){const t=this.start.toPointXZ().toString(),r=this.end.toPointXZ().toString(),e=this.getGcodeDirection(),n=this.type===-1?1:-1,i=this.radius;return{g23r:`G1 ${t}
G${e} ${r} R${Math.abs(i)*n}`,g23ik:`G1 ${t}
G${e} ${r} I${this.center.toVector(this.start).multiply(-1).y} K${this.center.toVector(this.start).multiply(-1).x}`,g1:this.angle===90?"":null}}toSvg(){const t=this.start.toArray().join(" "),r=this.end.toArray().join(" "),e=this.direction==-1?0:1,n=this.type===-1?0:1,i=this.radius;return`path="M ${t} A ${i} ${i} 0 ${n} ${e} ${r}"`}toCanavs(){const t=this.center.toArray().join(", "),r=this.direction==-1?1:0,e=this.radius,n=x(this.startAngle),i=x(this.endAngle);return`ctx.arc(${[t,e,n,i,r].join(", ")});`}toThree(){const t=this.center.toArray().join(", "),r=this.direction==-1?1:0,e=this.radius,n=x(this.startAngle),i=x(this.endAngle);return`new THREE.ArcCurve(${[t,e,n,i,r].join(", ")});`}getGcodeDirection(){return this.direction===-1?2:3}}class vr{constructor(t){v(this,"sideA");v(this,"sideB");v(this,"sideC");v(this,"angleA");v(this,"angleB");v(this,"angleC",90);const{sideA:r,sideB:e,sideC:n,angleA:i,angleB:a}=t;if(this.validateInput({sideA:r,sideB:e,sideC:n,angleA:i,angleB:a}),r&&e)this.sideA=r,this.sideB=e,this.sideC=Math.sqrt(r**2+e**2),this.angleA=nt(Math.asin(e/this.sideC)),this.angleB=90-this.angleA;else if(r&&n)this.sideA=r,this.sideC=n,this.sideB=Math.sqrt(n**2-r**2),this.angleB=nt(Math.asin(r/n)),this.angleA=90-this.angleB;else if(e&&n)this.sideB=e,this.sideC=n,this.sideA=Math.sqrt(n**2-e**2),this.angleA=nt(Math.asin(e/n)),this.angleB=90-this.angleA;else if(i&&r)this.angleA=i,this.sideA=r,this.angleB=90-i,this.sideC=r/Math.cos(x(i)),this.sideB=this.sideC*Math.sin(x(i));else if(i&&e)this.angleA=i,this.sideB=e,this.angleB=90-i,this.sideC=e/Math.sin(x(i)),this.sideA=this.sideC*Math.cos(x(i));else if(i&&n)this.angleA=i,this.sideC=n,this.angleB=90-i,this.sideB=n*Math.sin(x(i)),this.sideA=n*Math.cos(x(i));else if(a&&r)this.angleB=a,this.sideA=r,this.angleA=90-a,this.sideC=r/Math.sin(x(a)),this.sideB=this.sideC*Math.cos(x(a));else if(a&&e)this.angleB=a,this.sideB=e,this.angleA=90-a,this.sideC=e/Math.cos(x(a)),this.sideA=this.sideC*Math.sin(x(a));else if(a&&n)this.angleB=a,this.sideC=n,this.angleA=90-a,this.sideA=n*Math.sin(x(a)),this.sideB=n*Math.cos(x(a));else throw new Error(`${this.constructor.name} Invalid input combination.`);this.validatePythagoras(),this.validateAngles()}validateInput(t){if(Object.values(t).filter(e=>e!==void 0).length<2)throw new Error(`${this.constructor.name} At least two values must be provided.`)}validateAngles(){if(this.angleA&&this.angleB&&Math.abs(this.angleA+this.angleB-90)>1e-4)throw new Error(`${this.constructor.name} The sum of angleA and angleB must be 90 degrees.`)}validatePythagoras(){if(this.sideA&&this.sideB&&this.sideC&&Math.abs(this.sideA**2+this.sideB**2-this.sideC**2)>1e-4)throw new Error(`${this.constructor.name} The lengths do not satisfy the Pythagorean theorem.`)}toPoint(){if(this.sideA&&this.sideB)return w.fromObjectXZ({x:this.sideA*2,z:this.sideB})}}var T=Uint8Array,U=Uint16Array,zt=Int32Array,wt=new T([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yt=new T([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Tt=new T([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Nt=function(s,t){for(var r=new U(31),e=0;e<31;++e)r[e]=t+=1<<s[e-1];for(var n=new zt(r[30]),e=1;e<30;++e)for(var i=r[e];i<r[e+1];++i)n[i]=i-r[e]<<5|e;return{b:r,r:n}},qt=Nt(wt,2),jt=qt.b,St=qt.r;jt[28]=258,St[258]=28;var Wt=Nt(yt,0),Lt=Wt.b,It=Wt.r,Vt=new U(32768);for(var M=0;M<32768;++M){var et=(M&43690)>>1|(M&21845)<<1;et=(et&52428)>>2|(et&13107)<<2,et=(et&61680)>>4|(et&3855)<<4,Vt[M]=((et&65280)>>8|(et&255)<<8)>>1}var Q=function(s,t,r){for(var e=s.length,n=0,i=new U(t);n<e;++n)s[n]&&++i[s[n]-1];var a=new U(t);for(n=1;n<t;++n)a[n]=a[n-1]+i[n-1]<<1;var l;if(r){l=new U(1<<t);var u=15-t;for(n=0;n<e;++n)if(s[n])for(var h=n<<4|s[n],o=t-s[n],c=a[s[n]-1]++<<o,f=c|(1<<o)-1;c<=f;++c)l[Vt[c]>>u]=h}else for(l=new U(e),n=0;n<e;++n)s[n]&&(l[n]=Vt[a[s[n]-1]++]>>15-s[n]);return l},st=new T(288);for(var M=0;M<144;++M)st[M]=8;for(var M=144;M<256;++M)st[M]=9;for(var M=256;M<280;++M)st[M]=7;for(var M=280;M<288;++M)st[M]=8;var gt=new T(32);for(var M=0;M<32;++M)gt[M]=5;var _t=Q(st,9,0),tr=Q(st,9,1),rr=Q(gt,5,0),er=Q(gt,5,1),Pt=function(s){for(var t=s[0],r=1;r<s.length;++r)s[r]>t&&(t=s[r]);return t},K=function(s,t,r){var e=t/8|0;return(s[e]|s[e+1]<<8)>>(t&7)&r},bt=function(s,t){var r=t/8|0;return(s[r]|s[r+1]<<8|s[r+2]<<16)>>(t&7)},Bt=function(s){return(s+7)/8|0},At=function(s,t,r){return(t==null||t<0)&&(t=0),(r==null||r>s.length)&&(r=s.length),new T(s.subarray(t,r))},nr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Y=function(s,t,r){var e=new Error(t||nr[s]);if(e.code=s,Error.captureStackTrace&&Error.captureStackTrace(e,Y),!r)throw e;return e},sr=function(s,t,r,e){var n=s.length,i=0;if(!n||t.f&&!t.l)return r||new T(0);var a=!r,l=a||t.i!=2,u=t.i;a&&(r=new T(n*3));var h=function(lt){var ut=r.length;if(lt>ut){var ot=new T(Math.max(ut*2,lt));ot.set(r),r=ot}},o=t.f||0,c=t.p||0,f=t.b||0,g=t.l,P=t.d,y=t.m,S=t.n,I=n*8;do{if(!g){o=K(s,c,1);var V=K(s,c+1,3);if(c+=3,V)if(V==1)g=tr,P=er,y=9,S=5;else if(V==2){var Z=K(s,c,31)+257,E=K(s,c+10,15)+4,m=Z+K(s,c+5,31)+1;c+=14;for(var d=new T(m),O=new T(19),R=0;R<E;++R)O[Tt[R]]=K(s,c+R*3,7);c+=E*3;for(var F=Pt(O),rt=(1<<F)-1,q=Q(O,F,1),R=0;R<m;){var k=q[K(s,c,rt)];c+=k&15;var p=k>>4;if(p<16)d[R++]=p;else{var z=0,b=0;for(p==16?(b=3+K(s,c,3),c+=2,z=d[R-1]):p==17?(b=3+K(s,c,7),c+=3):p==18&&(b=11+K(s,c,127),c+=7);b--;)d[R++]=z}}var N=d.subarray(0,Z),B=d.subarray(Z);y=Pt(N),S=Pt(B),g=Q(N,y,1),P=Q(B,S,1)}else Y(1);else{var p=Bt(c)+4,D=s[p-4]|s[p-3]<<8,$=p+D;if($>n){u&&Y(0);break}l&&h(f+D),r.set(s.subarray(p,$),f),t.b=f+=D,t.p=c=$*8,t.f=o;continue}if(c>I){u&&Y(0);break}}l&&h(f+131072);for(var ht=(1<<y)-1,H=(1<<S)-1,L=c;;L=c){var z=g[bt(s,c)&ht],j=z>>4;if(c+=z&15,c>I){u&&Y(0);break}if(z||Y(2),j<256)r[f++]=j;else if(j==256){L=c,g=null;break}else{var W=j-254;if(j>264){var R=j-257,C=wt[R];W=K(s,c,(1<<C)-1)+jt[R],c+=C}var J=P[bt(s,c)&H],it=J>>4;J||Y(3),c+=J&15;var B=Lt[it];if(it>3){var C=yt[it];B+=bt(s,c)&(1<<C)-1,c+=C}if(c>I){u&&Y(0);break}l&&h(f+131072);var at=f+W;if(f<B){var vt=i-B,mt=Math.min(B,at);for(vt+f<0&&Y(3);f<mt;++f)r[f]=e[vt+f]}for(;f<at;++f)r[f]=r[f-B]}}t.l=g,t.p=L,t.b=f,t.f=o,g&&(o=1,t.m=y,t.d=P,t.n=S)}while(!o);return f!=r.length&&a?At(r,0,f):r.subarray(0,f)},_=function(s,t,r){r<<=t&7;var e=t/8|0;s[e]|=r,s[e+1]|=r>>8},ft=function(s,t,r){r<<=t&7;var e=t/8|0;s[e]|=r,s[e+1]|=r>>8,s[e+2]|=r>>16},Ct=function(s,t){for(var r=[],e=0;e<s.length;++e)s[e]&&r.push({s:e,f:s[e]});var n=r.length,i=r.slice();if(!n)return{t:Ut,l:0};if(n==1){var a=new T(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function($,Z){return $.f-Z.f}),r.push({s:-1,f:25001});var l=r[0],u=r[1],h=0,o=1,c=2;for(r[0]={s:-1,f:l.f+u.f,l,r:u};o!=n-1;)l=r[r[h].f<r[c].f?h++:c++],u=r[h!=o&&r[h].f<r[c].f?h++:c++],r[o++]={s:-1,f:l.f+u.f,l,r:u};for(var f=i[0].s,e=1;e<n;++e)i[e].s>f&&(f=i[e].s);var g=new U(f+1),P=Et(r[o-1],g,0);if(P>t){var e=0,y=0,S=P-t,I=1<<S;for(i.sort(function(Z,E){return g[E.s]-g[Z.s]||Z.f-E.f});e<n;++e){var V=i[e].s;if(g[V]>t)y+=I-(1<<P-g[V]),g[V]=t;else break}for(y>>=S;y>0;){var p=i[e].s;g[p]<t?y-=1<<t-g[p]++-1:++e}for(;e>=0&&y;--e){var D=i[e].s;g[D]==t&&(--g[D],++y)}P=t}return{t:new T(g),l:P}},Et=function(s,t,r){return s.s==-1?Math.max(Et(s.l,t,r+1),Et(s.r,t,r+1)):t[s.s]=r},$t=function(s){for(var t=s.length;t&&!s[--t];);for(var r=new U(++t),e=0,n=s[0],i=1,a=function(u){r[e++]=u},l=1;l<=t;++l)if(s[l]==n&&l!=t)++i;else{if(!n&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(n),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(n);i=1,n=s[l]}return{c:r.subarray(0,e),n:t}},dt=function(s,t){for(var r=0,e=0;e<t.length;++e)r+=s[e]*t[e];return r},Gt=function(s,t,r){var e=r.length,n=Bt(t+2);s[n]=e&255,s[n+1]=e>>8,s[n+2]=s[n]^255,s[n+3]=s[n+1]^255;for(var i=0;i<e;++i)s[n+i+4]=r[i];return(n+4+e)*8},Ft=function(s,t,r,e,n,i,a,l,u,h,o){_(t,o++,r),++n[256];for(var c=Ct(n,15),f=c.t,g=c.l,P=Ct(i,15),y=P.t,S=P.l,I=$t(f),V=I.c,p=I.n,D=$t(y),$=D.c,Z=D.n,E=new U(19),m=0;m<V.length;++m)++E[V[m]&31];for(var m=0;m<$.length;++m)++E[$[m]&31];for(var d=Ct(E,7),O=d.t,R=d.l,F=19;F>4&&!O[Tt[F-1]];--F);var rt=h+5<<3,q=dt(n,st)+dt(i,gt)+a,k=dt(n,f)+dt(i,y)+a+14+3*F+dt(E,O)+2*E[16]+3*E[17]+7*E[18];if(u>=0&&rt<=q&&rt<=k)return Gt(t,o,s.subarray(u,u+h));var z,b,N,B;if(_(t,o,1+(k<q)),o+=2,k<q){z=Q(f,g,0),b=f,N=Q(y,S,0),B=y;var ht=Q(O,R,0);_(t,o,p-257),_(t,o+5,Z-1),_(t,o+10,F-4),o+=14;for(var m=0;m<F;++m)_(t,o+3*m,O[Tt[m]]);o+=3*F;for(var H=[V,$],L=0;L<2;++L)for(var j=H[L],m=0;m<j.length;++m){var W=j[m]&31;_(t,o,ht[W]),o+=O[W],W>15&&(_(t,o,j[m]>>5&127),o+=j[m]>>12)}}else z=_t,b=st,N=rr,B=gt;for(var m=0;m<l;++m){var C=e[m];if(C>255){var W=C>>18&31;ft(t,o,z[W+257]),o+=b[W+257],W>7&&(_(t,o,C>>23&31),o+=wt[W]);var J=C&31;ft(t,o,N[J]),o+=B[J],J>3&&(ft(t,o,C>>5&8191),o+=yt[J])}else ft(t,o,z[C]),o+=b[C]}return ft(t,o,z[256]),o+b[256]},ir=new zt([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ut=new T(0),ar=function(s,t,r,e,n,i){var a=i.z||s.length,l=new T(e+a+5*(1+Math.ceil(a/7e3))+n),u=l.subarray(e,l.length-n),h=i.l,o=(i.r||0)&7;if(t){o&&(u[0]=i.r>>3);for(var c=ir[t-1],f=c>>13,g=c&8191,P=(1<<r)-1,y=i.p||new U(32768),S=i.h||new U(P+1),I=Math.ceil(r/3),V=2*I,p=function(xt){return(s[xt]^s[xt+1]<<I^s[xt+2]<<V)&P},D=new zt(25e3),$=new U(288),Z=new U(32),E=0,m=0,d=i.i||0,O=0,R=i.w||0,F=0;d+2<a;++d){var rt=p(d),q=d&32767,k=S[rt];if(y[q]=k,S[rt]=q,R<=d){var z=a-d;if((E>7e3||O>24576)&&(z>423||!h)){o=Ft(s,u,0,D,$,Z,m,O,F,d-F,o),O=E=m=0,F=d;for(var b=0;b<286;++b)$[b]=0;for(var b=0;b<30;++b)Z[b]=0}var N=2,B=0,ht=g,H=q-k&32767;if(z>2&&rt==p(d-H))for(var L=Math.min(f,z)-1,j=Math.min(32767,d),W=Math.min(258,z);H<=j&&--ht&&q!=k;){if(s[d+N]==s[d+N-H]){for(var C=0;C<W&&s[d+C]==s[d+C-H];++C);if(C>N){if(N=C,B=H,C>L)break;for(var J=Math.min(H,C-2),it=0,b=0;b<J;++b){var at=d-H+b&32767,vt=y[at],mt=at-vt&32767;mt>it&&(it=mt,k=at)}}}q=k,k=y[q],H+=q-k&32767}if(B){D[O++]=268435456|St[N]<<18|It[B];var lt=St[N]&31,ut=It[B]&31;m+=wt[lt]+yt[ut],++$[257+lt],++Z[ut],R=d+N,++E}else D[O++]=s[d],++$[s[d]]}}for(d=Math.max(d,R);d<a;++d)D[O++]=s[d],++$[s[d]];o=Ft(s,u,h,D,$,Z,m,O,F,d-F,o),h||(i.r=o&7|u[o/8|0]<<3,o-=7,i.h=S,i.p=y,i.i=d,i.w=R)}else{for(var d=i.w||0;d<a+h;d+=65535){var ot=d+65535;ot>=a&&(u[o/8|0]=h,ot=a),o=Gt(u,o+1,s.subarray(d,ot))}i.i=a}return At(l,0,e+Bt(o)+n)},Ht=function(){var s=1,t=0;return{p:function(r){for(var e=s,n=t,i=r.length|0,a=0;a!=i;){for(var l=Math.min(a+2655,i);a<l;++a)n+=e+=r[a];e=(e&65535)+15*(e>>16),n=(n&65535)+15*(n>>16)}s=e,t=n},d:function(){return s%=65521,t%=65521,(s&255)<<24|(s&65280)<<8|(t&255)<<8|t>>8}}},or=function(s,t,r,e,n){if(!n&&(n={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),a=new T(i.length+s.length);a.set(i),a.set(s,i.length),s=a,n.w=i.length}return ar(s,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(s.length)))*1.5):20:12+t.mem,r,e,n)},Yt=function(s,t,r){for(;r;++t)s[t]=r,r>>>=8},cr=function(s,t){var r=t.level,e=r==0?0:r<6?1:r==9?3:2;if(s[0]=120,s[1]=e<<6|(t.dictionary&&32),s[1]|=31-(s[0]<<8|s[1])%31,t.dictionary){var n=Ht();n.p(t.dictionary),Yt(s,2,n.d())}},hr=function(s,t){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&Y(6,"invalid zlib data"),(s[1]>>5&1)==+!t&&Y(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function lr(s,t){t||(t={});var r=Ht();r.p(s);var e=or(s,t,t.dictionary?6:2,4);return cr(e,t),Yt(e,e.length-4,r.d()),e}function ur(s,t){return sr(s.subarray(hr(s,t),-4),{i:2},t,t)}var Dt=typeof TextEncoder<"u"&&new TextEncoder,Ot=typeof TextDecoder<"u"&&new TextDecoder,fr=0;try{Ot.decode(Ut,{stream:!0}),fr=1}catch{}var dr=function(s){for(var t="",r=0;;){var e=s[r++],n=(e>127)+(e>223)+(e>239);if(r+n>s.length)return{s:t,r:At(s,r-1)};n?n==3?(e=((e&15)<<18|(s[r++]&63)<<12|(s[r++]&63)<<6|s[r++]&63)-65536,t+=String.fromCharCode(55296|e>>10,56320|e&1023)):n&1?t+=String.fromCharCode((e&31)<<6|s[r++]&63):t+=String.fromCharCode((e&15)<<12|(s[r++]&63)<<6|s[r++]&63):t+=String.fromCharCode(e)}};function Zt(s,t){if(t){for(var r=new T(s.length),e=0;e<s.length;++e)r[e]=s.charCodeAt(e);return r}if(Dt)return Dt.encode(s);for(var n=s.length,i=new T(s.length+(s.length>>1)),a=0,l=function(o){i[a++]=o},e=0;e<n;++e){if(a+5>i.length){var u=new T(a+8+(n-e<<1));u.set(i),i=u}var h=s.charCodeAt(e);h<128||t?l(h):h<2048?(l(192|h>>6),l(128|h&63)):h>55295&&h<57344?(h=65536+(h&1047552)|s.charCodeAt(++e)&1023,l(240|h>>18),l(128|h>>12&63),l(128|h>>6&63),l(128|h&63)):(l(224|h>>12),l(128|h>>6&63),l(128|h&63))}return At(i,0,a)}function Xt(s,t){if(t){for(var r="",e=0;e<s.length;e+=16384)r+=String.fromCharCode.apply(null,s.subarray(e,e+16384));return r}else{if(Ot)return Ot.decode(s);var n=dr(s),i=n.s,r=n.r;return r.length&&Y(8),i}}class tt{static isType(t,r){return Object.prototype.toString.call(t)===`[object ${r}]`}static isNumber(t){return this.isType(t,"Number")&&!Number.isNaN(t)}static isString(t){return this.isType(t,"String")}static isBoolean(t){return this.isType(t,"Boolean")}static isArray(t){return this.isType(t,"Array")}static isObject(t){return this.isType(t,"Object")}static isRegExp(t){return this.isType(t,"RegExp")}static isUndefined(t){return this.isType(t,"Undefined")}static isNull(t){return this.isType(t,"Null")}static degreesToRadians(t){return t*Math.PI/180}static radiansToDegrees(t){return t*(180/Math.PI)}static parseBinary(t){return parseInt(t,2)}static toBinaryString(t){return t.toString(2)}static roundNumber(t,r=5){if(this.isNumber(t)){const e=Math.pow(10,r);return Math.round(t*e)/e}return t}static formatStringOrBoolean(t){return typeof t=="string"||typeof t=="boolean"?t.toString().toUpperCase():t}static deepCopy(t,r=new WeakMap){if(t===null||typeof t!="object")return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const e=[];r.set(t,e);for(let n=0;n<t.length;n++)e[n]=this.deepCopy(t[n],r);return e}if(this.isObject(t)||t instanceof Date||t instanceof RegExp){const e={};r.set(t,e);for(const n in t)t.hasOwnProperty(n)&&(e[n]=this.deepCopy(t[n],r));return e}throw new Error("Unable to copy object! Its type isn't supported.")}static transposeMatrix(t){if(t.length!==0)return t[0].map((r,e)=>t.map(n=>n[e]))}static shiftFirst(t,r){const e=t.slice();r=r%t.length;for(let n=0;n<r;n++){const i=e.pop();e.unshift(i)}return e}static processNumbeer(t,r=!1,e=n=>n){if(this.isNumber(t))return e(t);if(this.isString(t)&&t.trim()!==""&&this.isNumber(Number(t)))return e(Number(t)).toString();if(this.isArray(t))return t.map(n=>this.processNumbeer(n,r,e));if(this.isObject(t)&&t!==null){const n={};for(const i in t)t.hasOwnProperty(i)&&(n[i]=this.processNumbeer(t[i],r,e));return n}return t}static intersection(...t){return t.reduce((r,e)=>r.filter(n=>e.includes(n)))}static union(...t){return[...new Set(t.flat())]}static difference(...t){const[r,...e]=t;return r.filter(n=>!e.some(i=>i.includes(n)))}static utoa(t){const r=Zt(t),e=lr(r,{level:9}),n=Xt(e,!0);return btoa(n)}static atou(t){const r=atob(t);if(r.startsWith("xÚ")){const e=Zt(r,!0),n=ur(e);return Xt(n)}return decodeURIComponent(escape(r))}static arcMirror(t,r){const e=t.center.mirror(r),n=t.start.mirror(r),i=t.end.mirror(r),a=t.radius,l=t.direction===Rt.CounterClockwise?1:0;let u=e.toVector(n).angleRad()+Math.PI*2*l,h=e.toVector(i).angleRad();return Math.abs(h-u)>=Math.PI&&t.direction===Rt.Clockwise&&(u+=Math.PI*2,h+=Math.PI*2),new G(n,i,e,a,u,h)}static complementary(t){const r=t.startAngleRad,e=t.endAngleRad,n=tt.complementary__(r,e).map(i=>tt.degreesToRadians(i));return new G(t.start,t.end,t.center,t.radius,n[0],n[1])}static complementary__(t,r){const e=Math.PI*2,n=r-t,i=Math.sign(n),a=(e-Math.abs(n))*i,l=r==0?e:r,u=l+a;let h=[l,u];return h.every(o=>o<0)&&(h=h.map(o=>o+e)),h.every(o=>o>=e)&&(h=h.map(o=>o%e)),h.map(o=>tt.radiansToDegrees(o))}static reverseDirection(t){const r=t.startAngleRad,e=t.endAngleRad,n=tt.reverseDirection__(r,e).map(i=>tt.degreesToRadians(i));return new G(t.start,t.end,t.center,t.radius,n[0],n[1])}static reverseDirection__(t,r){const e=Math.PI*2,n=r-t,a=Math.sign(n)*-1;let h=[r,t];return h.some(o=>o<0||o>e)&&(h=h.map(o=>o+e*a)),h.some(o=>o>=2*e)&&(h=h.map(o=>o%e).map(o=>o===0?e:o)),h.map(o=>tt.radiansToDegrees(o))}static getArcAngle(t,r,e){console.log("起始圆弧方向：",r.start.toVector().angleDirection(r.end.toVector())==1?"逆时针":"顺时针");const n=(o,c,f)=>{const g=o.x+c*Math.cos(f),P=o.y+c*Math.sin(f);return new w(g,P)};let i=new A(t,r.start).angleRad,a=new A(t,r.end).angleRad;const l=n(t,e,i),u=n(t,e,a);return new A(t,r.start).toVector().angleTo(new A(t,r.end).toVector())<0&&(i+=Math.PI),new G(l,u,t,e,i,a)}static isApproximatelyZero(t){return Math.abs(t)<Number.EPSILON}static normalizeArcAngle(t,r,e){const n=Math.PI*2;let i=[t,r].map(a=>tt.degreesToRadians(a));return i=i.map(a=>a<0?a+n:a),i.map(a=>tt.radiansToDegrees(a))}}export{G as A,A as L,w as P,vr as R,tt as U,Rt as a,Qt as b,ct as c};
